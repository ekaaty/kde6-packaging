From 2c7d8188c9ef15866498f7ac74f1033d36b91020 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 19:52:37 +0100
Subject: [PATCH 01/36] Use versionless QML imports

---
 src/app/AboutPage.qml                         | 12 +++++-----
 src/app/ActionsCard.qml                       | 20 ++++++++---------
 src/app/AlternativeJourneyPage.qml            | 12 +++++-----
 src/app/BarcodeContainer.qml                  | 16 +++++++-------
 src/app/BarcodeScanModeButton.qml             | 10 ++++-----
 src/app/BarcodeScanModeController.qml         |  4 ++--
 src/app/BarcodeScannerPage.qml                | 14 ++++++------
 src/app/BoardingPass.qml                      | 12 +++++-----
 src/app/BoatDelegate.qml                      | 10 ++++-----
 src/app/BoatEditor.qml                        | 16 +++++++-------
 src/app/BoatPage.qml                          | 14 ++++++------
 src/app/BookingCard.qml                       | 12 +++++-----
 src/app/BookingEditorCard.qml                 | 14 ++++++------
 src/app/BusDelegate.qml                       | 12 +++++-----
 src/app/BusEditor.qml                         | 16 +++++++-------
 src/app/BusPage.qml                           | 14 ++++++------
 src/app/CalendarImportPage.qml                | 12 +++++-----
 src/app/CalendarSelectionSheet.qml            |  8 +++----
 src/app/CarRentalDelegate.qml                 | 10 ++++-----
 src/app/CarRentalPage.qml                     | 14 ++++++------
 src/app/CardPageTitle.qml                     | 10 ++++-----
 src/app/ContactCard.qml                       | 14 ++++++------
 src/app/ContactEditorCard.qml                 | 14 ++++++------
 src/app/CountryComboBox.qml                   |  6 ++---
 src/app/CountryComboBoxDelegate.qml           | 10 ++++-----
 src/app/DepartureQueryPage.qml                | 14 ++++++------
 src/app/DetailsPage.qml                       | 14 ++++++------
 src/app/DevelopmentModePage.qml               | 12 +++++-----
 src/app/DocumentsCard.qml                     | 16 +++++++-------
 src/app/EditorPage.qml                        | 14 ++++++------
 src/app/EventDelegate.qml                     | 10 ++++-----
 src/app/EventEditor.qml                       | 16 +++++++-------
 src/app/EventPage.qml                         | 14 ++++++------
 src/app/EventTicket.qml                       | 14 ++++++------
 src/app/FavoriteLocationPage.qml              | 16 +++++++-------
 src/app/FlightDelegate.qml                    | 10 ++++-----
 src/app/FlightEditor.qml                      | 14 ++++++------
 src/app/FlightPage.qml                        | 14 ++++++------
 src/app/FormDateTimeEditDelegate.qml          | 16 +++++++-------
 src/app/FormPlaceDelegate.qml                 | 12 +++++-----
 src/app/FormPlaceEditorDelegate.qml           | 22 +++++++++----------
 src/app/FormPlatformDelegate.qml              | 12 +++++-----
 src/app/FormPriceDelegate.qml                 | 16 +++++++-------
 src/app/FormPriceEditDelegate.qml             | 16 +++++++-------
 src/app/GenericPass.qml                       | 12 +++++-----
 src/app/GenericPkPassPage.qml                 | 10 ++++-----
 src/app/HealthCertificateBarcode.qml          | 14 ++++++------
 src/app/HealthCertificatePage.qml             | 12 +++++-----
 src/app/HealthCertificateRecovery.qml         | 14 ++++++------
 src/app/HealthCertificateTest.qml             | 16 +++++++-------
 src/app/HealthCertificateVaccination.qml      | 16 +++++++-------
 src/app/HotelDelegate.qml                     | 10 ++++-----
 src/app/HotelEditor.qml                       | 16 +++++++-------
 src/app/HotelPage.qml                         | 14 ++++++------
 src/app/IndoorMapAmenityDelegate.qml          | 12 +++++-----
 src/app/IndoorMapAmenitySheet.qml             | 10 ++++-----
 src/app/IndoorMapElevatorSheet.qml            | 10 ++++-----
 src/app/IndoorMapGateSheet.qml                | 10 ++++-----
 src/app/IndoorMapInfoSheet.qml                | 14 ++++++------
 ...IndoorMapInfoSheetOpeningHoursDelegate.qml | 10 ++++-----
 src/app/IndoorMapPage.qml                     | 22 +++++++++----------
 src/app/IndoorMapPlatformSheet.qml            | 14 ++++++------
 src/app/IntermediateStopSelector.qml          | 14 ++++++------
 src/app/JourneyDelegateHeader.qml             | 12 +++++-----
 src/app/JourneyPathPage.qml                   | 12 +++++-----
 src/app/JourneyQueryPage.qml                  | 16 +++++++-------
 src/app/JourneyRequestPage.qml                | 16 +++++++-------
 src/app/JourneySectionDelegate.qml            | 14 ++++++------
 src/app/JourneySectionPage.qml                | 12 +++++-----
 src/app/JourneySectionStopDelegate.qml        | 12 +++++-----
 .../JourneySectionStopDelegateLineSegment.qml | 12 +++++-----
 src/app/JourneySummaryDelegate.qml            | 14 ++++++------
 src/app/LiveStatusPage.qml                    | 18 +++++++--------
 src/app/LocationInfoDelegate.qml              | 16 +++++++-------
 src/app/LocationPicker.qml                    | 14 ++++++------
 src/app/MapView.qml                           |  6 ++---
 src/app/MatrixRoomSelectionSheet.qml          | 14 ++++++------
 src/app/NavigationBar.qml                     |  6 ++---
 src/app/OnlineImportPage.qml                  | 12 +++++-----
 src/app/PassPage.qml                          | 14 ++++++------
 src/app/PkPassBarcode.qml                     | 10 ++++-----
 src/app/PkPassPage.qml                        |  6 ++---
 src/app/ProgramMembershipCard.qml             | 12 +++++-----
 src/app/ProgramMembershipEditor.qml           | 14 ++++++------
 src/app/ProgramMembershipEditorCard.qml       | 16 +++++++-------
 src/app/ProgramMembershipPage.qml             | 14 ++++++------
 src/app/PublicTransportBackendPage.qml        | 14 ++++++------
 src/app/ReservationDocumentsCard.qml          | 12 +++++-----
 src/app/RestaurantDelegate.qml                | 10 ++++-----
 src/app/RestaurantEditor.qml                  | 14 ++++++------
 src/app/RestaurantPage.qml                    | 14 ++++++------
 src/app/SettingsPage.qml                      | 18 +++++++--------
 src/app/StatisticsDelegate.qml                | 12 +++++-----
 src/app/StatisticsPage.qml                    | 14 ++++++------
 src/app/StopPickerPage.qml                    | 16 +++++++-------
 src/app/TicketEditor.qml                      | 16 +++++++-------
 src/app/TicketPage.qml                        | 14 ++++++------
 src/app/TicketTokenDelegate.qml               | 16 +++++++-------
 src/app/TimelineDelegate.qml                  | 12 +++++-----
 src/app/TimelineDelegateHeaderBackground.qml  |  8 +++----
 src/app/TimelinePage.qml                      | 14 ++++++------
 src/app/TimelineSectionDelegate.qml           | 12 +++++-----
 src/app/TouristAttractionDelegate.qml         | 10 ++++-----
 src/app/TouristAttractionPage.qml             | 14 ++++++------
 src/app/TrainDelegate.qml                     | 12 +++++-----
 src/app/TrainEditor.qml                       | 16 +++++++-------
 src/app/TrainPage.qml                         | 16 +++++++-------
 src/app/TransferDelegate.qml                  | 14 ++++++------
 src/app/TransferPage.qml                      | 16 +++++++-------
 src/app/TripGroupDelegate.qml                 | 14 ++++++------
 src/app/VehicleLayoutPage.qml                 | 14 ++++++------
 src/app/VehicleLoadIndicator.qml              |  8 +++----
 src/app/VerticalNavigationButton.qml          | 10 ++++-----
 src/app/WeatherForecastDelegate.qml           | 12 +++++-----
 src/app/WeatherForecastPage.qml               | 12 +++++-----
 src/app/WelcomePage.qml                       | 12 +++++-----
 src/app/components/RadioSelector.qml          |  8 +++----
 src/app/main.qml                              | 20 ++++++++---------
 src/app/onlineimport/db.qml                   | 12 +++++-----
 src/app/onlineimport/sncf.qml                 | 12 +++++-----
 tests/journeyquerytest.qml                    | 10 ++++-----
 tests/pkpassviewer.qml                        |  8 +++----
 tests/vehiclelayoutviewer.qml                 | 10 ++++-----
 123 files changed, 798 insertions(+), 798 deletions(-)

diff --git a/src/app/AboutPage.qml b/src/app/AboutPage.qml
index 60208b883..1627d37c6 100644
--- a/src/app/AboutPage.qml
+++ b/src/app/AboutPage.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.13
-import QtQuick.Layouts 1.11
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import org.kde.kirigamiaddons.formcard as FormCard
 
 FormCard.AboutPage {
     id: root
diff --git a/src/app/ActionsCard.qml b/src/app/ActionsCard.qml
index ea5e26b0b..1416989e1 100644
--- a/src/app/ActionsCard.qml
+++ b/src/app/ActionsCard.qml
@@ -2,16 +2,16 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import Qt.labs.platform 1.1 as Platform
-import internal.org.kde.kcalendarcore 1.0 as KCalendarCore
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitemmodels 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.platform as Platform
+import internal.org.kde.kcalendarcore as KCalendarCore
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitemmodels
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/AlternativeJourneyPage.qml b/src/app/AlternativeJourneyPage.qml
index fef63d617..61051e325 100644
--- a/src/app/AlternativeJourneyPage.qml
+++ b/src/app/AlternativeJourneyPage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 App.JourneyQueryPage {
diff --git a/src/app/BarcodeContainer.qml b/src/app/BarcodeContainer.qml
index 132862ddf..387d46cc3 100644
--- a/src/app/BarcodeContainer.qml
+++ b/src/app/BarcodeContainer.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtQuick.Window 2.15
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.prison 1.0 as Prison
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtQuick.Window
+import org.kde.kirigami as Kirigami
+import org.kde.prison as Prison
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 Item {
diff --git a/src/app/BarcodeScanModeButton.qml b/src/app/BarcodeScanModeButton.qml
index bb753aec3..560c27da5 100644
--- a/src/app/BarcodeScanModeButton.qml
+++ b/src/app/BarcodeScanModeButton.qml
@@ -2,11 +2,11 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.components 1.0 as Components
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components as Components
+import org.kde.itinerary
 
 Components.FloatingButton {
     id: root
diff --git a/src/app/BarcodeScanModeController.qml b/src/app/BarcodeScanModeController.qml
index babe4c55d..d93bcd5a0 100644
--- a/src/app/BarcodeScanModeController.qml
+++ b/src/app/BarcodeScanModeController.qml
@@ -4,8 +4,8 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import org.kde.solidextras 1.0 as Solid
+import QtQuick
+import org.kde.solidextras as Solid
 
 /** Shared logic and state for the barcode scan mode.
  *  That is, disable screen locking and switch to full brightness.
diff --git a/src/app/BarcodeScannerPage.qml b/src/app/BarcodeScannerPage.qml
index 7b5437522..dae3664af 100644
--- a/src/app/BarcodeScannerPage.qml
+++ b/src/app/BarcodeScannerPage.qml
@@ -3,13 +3,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtMultimedia 5.15
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.prison.scanner 1.0 as Prison
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtMultimedia
+import org.kde.kirigami as Kirigami
+import org.kde.prison.scanner as Prison
+import org.kde.itinerary
 import "." as App
 
 Kirigami.Page {
diff --git a/src/app/BoardingPass.qml b/src/app/BoardingPass.qml
index 331b40009..4ed9ec2f2 100644
--- a/src/app/BoardingPass.qml
+++ b/src/app/BoardingPass.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.pkpass 1.0 as KPkPass
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.pkpass as KPkPass
+import org.kde.itinerary
 import "." as App
 
 Item {
diff --git a/src/app/BoatDelegate.qml b/src/app/BoatDelegate.qml
index 40a1a0d66..5e1e2ae79 100644
--- a/src/app/BoatDelegate.qml
+++ b/src/app/BoatDelegate.qml
@@ -3,11 +3,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/BoatEditor.qml b/src/app/BoatEditor.qml
index 97c005013..d75360120 100644
--- a/src/app/BoatEditor.qml
+++ b/src/app/BoatEditor.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/BoatPage.qml b/src/app/BoatPage.qml
index f770131ed..1f6b0a00d 100644
--- a/src/app/BoatPage.qml
+++ b/src/app/BoatPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/BookingCard.qml b/src/app/BookingCard.qml
index 58bb06e78..1b2edec84 100644
--- a/src/app/BookingCard.qml
+++ b/src/app/BookingCard.qml
@@ -3,12 +3,12 @@
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
 import "." as App
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 
 /// Booking details
 ColumnLayout {
diff --git a/src/app/BookingEditorCard.qml b/src/app/BookingEditorCard.qml
index beb3b55cc..0628430c1 100644
--- a/src/app/BookingEditorCard.qml
+++ b/src/app/BookingEditorCard.qml
@@ -1,13 +1,13 @@
 // SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/BusDelegate.qml b/src/app/BusDelegate.qml
index 377c40241..cbcc63e36 100644
--- a/src/app/BusDelegate.qml
+++ b/src/app/BusDelegate.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/BusEditor.qml b/src/app/BusEditor.qml
index b5d5a69e0..34cca0bea 100644
--- a/src/app/BusEditor.qml
+++ b/src/app/BusEditor.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/BusPage.qml b/src/app/BusPage.qml
index 12769023a..f51877930 100644
--- a/src/app/BusPage.qml
+++ b/src/app/BusPage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitinerary
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/CalendarImportPage.qml b/src/app/CalendarImportPage.qml
index 60ce4b67c..e3eecdb73 100644
--- a/src/app/CalendarImportPage.qml
+++ b/src/app/CalendarImportPage.qml
@@ -3,12 +3,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import internal.org.kde.kcalendarcore 1.0 as KCalendarCore
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import internal.org.kde.kcalendarcore as KCalendarCore
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/CalendarSelectionSheet.qml b/src/app/CalendarSelectionSheet.qml
index 44daaa376..d2434ddc6 100644
--- a/src/app/CalendarSelectionSheet.qml
+++ b/src/app/CalendarSelectionSheet.qml
@@ -3,10 +3,10 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
 
 Kirigami.OverlaySheet {
     id: root
diff --git a/src/app/CarRentalDelegate.qml b/src/app/CarRentalDelegate.qml
index 62d6d5aac..c8fde2fdd 100644
--- a/src/app/CarRentalDelegate.qml
+++ b/src/app/CarRentalDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/CarRentalPage.qml b/src/app/CarRentalPage.qml
index 1a08e8571..9cb099390 100644
--- a/src/app/CarRentalPage.qml
+++ b/src/app/CarRentalPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/CardPageTitle.qml b/src/app/CardPageTitle.qml
index 49c450e1e..3c3b030a5 100644
--- a/src/app/CardPageTitle.qml
+++ b/src/app/CardPageTitle.qml
@@ -1,11 +1,11 @@
 // SPDX-FileCopyrightText: 2023 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
 
 ColumnLayout {
     id: root
diff --git a/src/app/ContactCard.qml b/src/app/ContactCard.qml
index ee18a449a..c684d0fa4 100644
--- a/src/app/ContactCard.qml
+++ b/src/app/ContactCard.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/ContactEditorCard.qml b/src/app/ContactEditorCard.qml
index f441e0e4c..1dcd037fd 100644
--- a/src/app/ContactEditorCard.qml
+++ b/src/app/ContactEditorCard.qml
@@ -1,13 +1,13 @@
 // SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/CountryComboBox.qml b/src/app/CountryComboBox.qml
index 862094421..d5baac9f3 100644
--- a/src/app/CountryComboBox.qml
+++ b/src/app/CountryComboBox.qml
@@ -3,9 +3,9 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.i18n.localeData 1.0
+import QtQuick
+import QtQuick.Controls as QQC2
+import org.kde.i18n.localeData
 
 /** Combo box for showing a list of countries.
  *  The model is expected to be an array of ISO 3166-1 alpha 2 codes.
diff --git a/src/app/CountryComboBoxDelegate.qml b/src/app/CountryComboBoxDelegate.qml
index c199138e0..22bbcb62b 100644
--- a/src/app/CountryComboBoxDelegate.qml
+++ b/src/app/CountryComboBoxDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kirigami 2.19 as Kirigami
+import QtQuick
+import QtQuick.Controls as QQC2
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kirigami as Kirigami
 
 /**
  * Combo box for showing a list of countries.
diff --git a/src/app/DepartureQueryPage.qml b/src/app/DepartureQueryPage.qml
index 08256ed67..90946b511 100644
--- a/src/app/DepartureQueryPage.qml
+++ b/src/app/DepartureQueryPage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/DetailsPage.qml b/src/app/DetailsPage.qml
index edf22aab2..8b9decd6d 100644
--- a/src/app/DetailsPage.qml
+++ b/src/app/DetailsPage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import internal.org.kde.kcalendarcore 1.0 as KCalendarCore
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import internal.org.kde.kcalendarcore as KCalendarCore
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/DevelopmentModePage.qml b/src/app/DevelopmentModePage.qml
index 0339a25e5..b5efd96d2 100644
--- a/src/app/DevelopmentModePage.qml
+++ b/src/app/DevelopmentModePage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import Qt.labs.platform 1.1
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.platform
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/DocumentsCard.qml b/src/app/DocumentsCard.qml
index 51cc5ce93..24176a26d 100644
--- a/src/app/DocumentsCard.qml
+++ b/src/app/DocumentsCard.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import Qt.labs.platform 1.1
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.platform
+import org.kde.kirigami as Kirigami
+import org.kde.kitinerary
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/EditorPage.qml b/src/app/EditorPage.qml
index f042fb62b..ed2ee0f22 100644
--- a/src/app/EditorPage.qml
+++ b/src/app/EditorPage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtQuick.Templates 2.15 as T
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtQuick.Templates as T
+import org.kde.kirigami as Kirigami
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/EventDelegate.qml b/src/app/EventDelegate.qml
index 9224b116a..f4733374e 100644
--- a/src/app/EventDelegate.qml
+++ b/src/app/EventDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/EventEditor.qml b/src/app/EventEditor.qml
index 7b1f33019..68962c98e 100644
--- a/src/app/EventEditor.qml
+++ b/src/app/EventEditor.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/EventPage.qml b/src/app/EventPage.qml
index 253ef760e..85ef27109 100644
--- a/src/app/EventPage.qml
+++ b/src/app/EventPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/EventTicket.qml b/src/app/EventTicket.qml
index bdfc50fbc..bd4516e7d 100644
--- a/src/app/EventTicket.qml
+++ b/src/app/EventTicket.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import QtGraphicalEffects 1.0 as Effects
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.pkpass 1.0 as KPkPass
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtGraphicalEffects as Effects
+import org.kde.kirigami as Kirigami
+import org.kde.pkpass as KPkPass
+import org.kde.itinerary
 import "." as App
 
 Item {
diff --git a/src/app/FavoriteLocationPage.qml b/src/app/FavoriteLocationPage.qml
index b363bc1b3..288669b5b 100644
--- a/src/app/FavoriteLocationPage.qml
+++ b/src/app/FavoriteLocationPage.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import Qt.labs.platform 1.1 as Platform
-import QtLocation 5.11 as QtLocation
-import QtPositioning 5.11
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.platform as Platform
+import QtLocation as QtLocation
+import QtPositioning
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 Kirigami.Page {
diff --git a/src/app/FlightDelegate.qml b/src/app/FlightDelegate.qml
index ebddb5689..a4e1fd336 100644
--- a/src/app/FlightDelegate.qml
+++ b/src/app/FlightDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/FlightEditor.qml b/src/app/FlightEditor.qml
index bc2b78b5c..4d67811aa 100644
--- a/src/app/FlightEditor.qml
+++ b/src/app/FlightEditor.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/FlightPage.qml b/src/app/FlightPage.qml
index 7682e545d..84755acd9 100644
--- a/src/app/FlightPage.qml
+++ b/src/app/FlightPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/FormDateTimeEditDelegate.qml b/src/app/FormDateTimeEditDelegate.qml
index bc951143b..e7f420301 100644
--- a/src/app/FormDateTimeEditDelegate.qml
+++ b/src/app/FormDateTimeEditDelegate.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.dateandtime 0.1 as Addon
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.dateandtime as Addon
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 // TODO KF6 replace with FormCard.FormDateTimeDelegate
diff --git a/src/app/FormPlaceDelegate.qml b/src/app/FormPlaceDelegate.qml
index 228f79646..17c35e387 100644
--- a/src/app/FormPlaceDelegate.qml
+++ b/src/app/FormPlaceDelegate.qml
@@ -2,12 +2,12 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 /** Display a location and corresponding navigation actions. */
diff --git a/src/app/FormPlaceEditorDelegate.qml b/src/app/FormPlaceEditorDelegate.qml
index 2828317ba..ab52035bf 100644
--- a/src/app/FormPlaceEditorDelegate.qml
+++ b/src/app/FormPlaceEditorDelegate.qml
@@ -4,17 +4,17 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtLocation 5.15 as QtLocation
-import QtPositioning 5.15
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.contacts 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtLocation as QtLocation
+import QtPositioning
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.contacts
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/FormPlatformDelegate.qml b/src/app/FormPlatformDelegate.qml
index 79c532e66..fe6bc1a3f 100644
--- a/src/app/FormPlatformDelegate.qml
+++ b/src/app/FormPlatformDelegate.qml
@@ -2,12 +2,12 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 FormCard.AbstractFormDelegate {
diff --git a/src/app/FormPriceDelegate.qml b/src/app/FormPriceDelegate.qml
index d00df4219..6a4c5bae0 100644
--- a/src/app/FormPriceDelegate.qml
+++ b/src/app/FormPriceDelegate.qml
@@ -1,14 +1,14 @@
 // SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormTextDelegate {
diff --git a/src/app/FormPriceEditDelegate.qml b/src/app/FormPriceEditDelegate.qml
index 9db79aed9..16ee0be3c 100644
--- a/src/app/FormPriceEditDelegate.qml
+++ b/src/app/FormPriceEditDelegate.qml
@@ -1,14 +1,14 @@
 // SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 FormCard.AbstractFormDelegate {
diff --git a/src/app/GenericPass.qml b/src/app/GenericPass.qml
index c50b36edf..8c8456d5c 100644
--- a/src/app/GenericPass.qml
+++ b/src/app/GenericPass.qml
@@ -3,12 +3,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.pkpass 1.0 as KPkPass
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.pkpass as KPkPass
+import org.kde.itinerary
 import "." as App
 
 Rectangle {
diff --git a/src/app/GenericPkPassPage.qml b/src/app/GenericPkPassPage.qml
index fa2aa0b85..135f4a381 100644
--- a/src/app/GenericPkPassPage.qml
+++ b/src/app/GenericPkPassPage.qml
@@ -3,11 +3,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 PkPassPage {
diff --git a/src/app/HealthCertificateBarcode.qml b/src/app/HealthCertificateBarcode.qml
index 17e7cbe72..753d89957 100644
--- a/src/app/HealthCertificateBarcode.qml
+++ b/src/app/HealthCertificateBarcode.qml
@@ -3,13 +3,13 @@
  * SPDX-License-Identifier: LGPL-2.0-or-later
  */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.prison 1.0 as Prison
-import org.kde.khealthcertificate 1.0 as KHC
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.prison as Prison
+import org.kde.khealthcertificate as KHC
+import org.kde.itinerary
 
 QQC2.Page {
     id: page
diff --git a/src/app/HealthCertificatePage.qml b/src/app/HealthCertificatePage.qml
index 53d646847..5e190a6f1 100644
--- a/src/app/HealthCertificatePage.qml
+++ b/src/app/HealthCertificatePage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.khealthcertificate 1.0 as KHC
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.khealthcertificate as KHC
+import org.kde.itinerary
 import "." as App
 
 Kirigami.Page {
diff --git a/src/app/HealthCertificateRecovery.qml b/src/app/HealthCertificateRecovery.qml
index e39d2d8fd..19ca77b5c 100644
--- a/src/app/HealthCertificateRecovery.qml
+++ b/src/app/HealthCertificateRecovery.qml
@@ -3,13 +3,13 @@
  * SPDX-License-Identifier: LGPL-2.0-or-later
  */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.prison 1.0 as Prison
-import org.kde.khealthcertificate 1.0 as KHC
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.prison as Prison
+import org.kde.khealthcertificate as KHC
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/HealthCertificateTest.qml b/src/app/HealthCertificateTest.qml
index 243ae447f..ec24c3db9 100644
--- a/src/app/HealthCertificateTest.qml
+++ b/src/app/HealthCertificateTest.qml
@@ -3,14 +3,14 @@
  * SPDX-License-Identifier: LGPL-2.0-or-later
  */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.i18n.localeData 1.0
-import org.kde.prison 1.0 as Prison
-import org.kde.khealthcertificate 1.0 as KHC
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.i18n.localeData
+import org.kde.prison as Prison
+import org.kde.khealthcertificate as KHC
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/HealthCertificateVaccination.qml b/src/app/HealthCertificateVaccination.qml
index 7c896dfbe..cbef2cb1c 100644
--- a/src/app/HealthCertificateVaccination.qml
+++ b/src/app/HealthCertificateVaccination.qml
@@ -3,14 +3,14 @@
  * SPDX-License-Identifier: LGPL-2.0-or-later
  */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.i18n.localeData 1.0
-import org.kde.prison 1.0 as Prison
-import org.kde.khealthcertificate 1.0 as KHC
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.i18n.localeData
+import org.kde.prison as Prison
+import org.kde.khealthcertificate as KHC
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/HotelDelegate.qml b/src/app/HotelDelegate.qml
index ee853ace9..177f0c695 100644
--- a/src/app/HotelDelegate.qml
+++ b/src/app/HotelDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/HotelEditor.qml b/src/app/HotelEditor.qml
index 672787389..665a4f1ac 100644
--- a/src/app/HotelEditor.qml
+++ b/src/app/HotelEditor.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/HotelPage.qml b/src/app/HotelPage.qml
index 4c188626b..83e5e4d15 100644
--- a/src/app/HotelPage.qml
+++ b/src/app/HotelPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/IndoorMapAmenityDelegate.qml b/src/app/IndoorMapAmenityDelegate.qml
index 0337b02dd..b1f0eda8f 100644
--- a/src/app/IndoorMapAmenityDelegate.qml
+++ b/src/app/IndoorMapAmenityDelegate.qml
@@ -3,12 +3,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kopeninghours 1.0
-import org.kde.kosmindoormap 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kopeninghours
+import org.kde.kosmindoormap
 
 Kirigami.AbstractListItem {
     id: root
diff --git a/src/app/IndoorMapAmenitySheet.qml b/src/app/IndoorMapAmenitySheet.qml
index 0a4ea4a4e..bd8f7ff9f 100644
--- a/src/app/IndoorMapAmenitySheet.qml
+++ b/src/app/IndoorMapAmenitySheet.qml
@@ -3,11 +3,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kosmindoormap 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kosmindoormap
 
 Kirigami.OverlaySheet {
     id: amenitySheet
diff --git a/src/app/IndoorMapElevatorSheet.qml b/src/app/IndoorMapElevatorSheet.qml
index 35ab38e1b..a9c2fb08f 100644
--- a/src/app/IndoorMapElevatorSheet.qml
+++ b/src/app/IndoorMapElevatorSheet.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kosmindoormap 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kosmindoormap
 
 Kirigami.OverlaySheet {
     id: elevatorSheet
diff --git a/src/app/IndoorMapGateSheet.qml b/src/app/IndoorMapGateSheet.qml
index dc6ea125b..3eac4acad 100644
--- a/src/app/IndoorMapGateSheet.qml
+++ b/src/app/IndoorMapGateSheet.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kosmindoormap 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kosmindoormap
 
 Kirigami.OverlaySheet {
     id: gateSheet
diff --git a/src/app/IndoorMapInfoSheet.qml b/src/app/IndoorMapInfoSheet.qml
index 5b7ff6d51..76543c027 100644
--- a/src/app/IndoorMapInfoSheet.qml
+++ b/src/app/IndoorMapInfoSheet.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kosmindoormap 1.0
-import org.kde.osm.editorcontroller 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kosmindoormap
+import org.kde.osm.editorcontroller
+import org.kde.itinerary
 
 Kirigami.OverlaySheet {
     id: elementDetailsSheet
diff --git a/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml b/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml
index fd9195f0c..59c8f6055 100644
--- a/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml
+++ b/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kopeninghours 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kopeninghours
+import org.kde.itinerary
 
 Column {
     id: root
diff --git a/src/app/IndoorMapPage.qml b/src/app/IndoorMapPage.qml
index b29ea971d..b6d2bede3 100644
--- a/src/app/IndoorMapPage.qml
+++ b/src/app/IndoorMapPage.qml
@@ -4,17 +4,17 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.components 1.0 as Components
-import org.kde.solidextras 1.0 as Solid
-import org.kde.kpublictransport 1.0 as PT
-import org.kde.kosmindoormap 1.0
-import org.kde.itinerary 1.0
-import org.kde.kosmindoormap.kpublictransport 1.0
-import org.kde.osm.editorcontroller 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components as Components
+import org.kde.solidextras as Solid
+import org.kde.kpublictransport as PT
+import org.kde.kosmindoormap
+import org.kde.itinerary
+import org.kde.kosmindoormap.kpublictransport
+import org.kde.osm.editorcontroller
 
 Kirigami.Page {
     id: root
diff --git a/src/app/IndoorMapPlatformSheet.qml b/src/app/IndoorMapPlatformSheet.qml
index 6e0ef9955..ee8acfea3 100644
--- a/src/app/IndoorMapPlatformSheet.qml
+++ b/src/app/IndoorMapPlatformSheet.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0 as PublicTransport
-import org.kde.kosmindoormap 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport as PublicTransport
+import org.kde.kosmindoormap
+import org.kde.itinerary
 
 Kirigami.OverlaySheet {
     id: platformSheet
diff --git a/src/app/IntermediateStopSelector.qml b/src/app/IntermediateStopSelector.qml
index 20fe0ac80..4e17fd120 100644
--- a/src/app/IntermediateStopSelector.qml
+++ b/src/app/IntermediateStopSelector.qml
@@ -3,13 +3,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kitinerary 1.0
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitinerary
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 Kirigami.OverlaySheet {
diff --git a/src/app/JourneyDelegateHeader.qml b/src/app/JourneyDelegateHeader.qml
index f762b152a..b2471f980 100644
--- a/src/app/JourneyDelegateHeader.qml
+++ b/src/app/JourneyDelegateHeader.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/JourneyPathPage.qml b/src/app/JourneyPathPage.qml
index e13a98ee8..59c576090 100644
--- a/src/app/JourneyPathPage.qml
+++ b/src/app/JourneyPathPage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/JourneyQueryPage.qml b/src/app/JourneyQueryPage.qml
index b85a0fc32..01328929b 100644
--- a/src/app/JourneyQueryPage.qml
+++ b/src/app/JourneyQueryPage.qml
@@ -5,14 +5,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kitemmodels 1.0
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitemmodels
+import org.kde.kpublictransport
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/JourneyRequestPage.qml b/src/app/JourneyRequestPage.qml
index 5ee7b24e1..fb1ceb099 100644
--- a/src/app/JourneyRequestPage.qml
+++ b/src/app/JourneyRequestPage.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kirigamiaddons.dateandtime 0.1 as Addon
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kirigamiaddons.dateandtime as Addon
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 import "./components" as Components
 
diff --git a/src/app/JourneySectionDelegate.qml b/src/app/JourneySectionDelegate.qml
index 4ff05d687..029c35615 100644
--- a/src/app/JourneySectionDelegate.qml
+++ b/src/app/JourneySectionDelegate.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 FormCard.AbstractFormDelegate {
diff --git a/src/app/JourneySectionPage.qml b/src/app/JourneySectionPage.qml
index efb15099d..8b1b6d01b 100644
--- a/src/app/JourneySectionPage.qml
+++ b/src/app/JourneySectionPage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/JourneySectionStopDelegate.qml b/src/app/JourneySectionStopDelegate.qml
index 7fb4cd809..882f967d3 100644
--- a/src/app/JourneySectionStopDelegate.qml
+++ b/src/app/JourneySectionStopDelegate.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 Item {
diff --git a/src/app/JourneySectionStopDelegateLineSegment.qml b/src/app/JourneySectionStopDelegateLineSegment.qml
index 400a737ce..19608b88f 100644
--- a/src/app/JourneySectionStopDelegateLineSegment.qml
+++ b/src/app/JourneySectionStopDelegateLineSegment.qml
@@ -3,12 +3,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 /** Line segment drawn on the left in the journey section view.
diff --git a/src/app/JourneySummaryDelegate.qml b/src/app/JourneySummaryDelegate.qml
index 78cf55d25..a13c8fb7f 100644
--- a/src/app/JourneySummaryDelegate.qml
+++ b/src/app/JourneySummaryDelegate.qml
@@ -5,13 +5,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 FormCard.AbstractFormDelegate {
diff --git a/src/app/LiveStatusPage.qml b/src/app/LiveStatusPage.qml
index 5161cdeab..66dd196ba 100644
--- a/src/app/LiveStatusPage.qml
+++ b/src/app/LiveStatusPage.qml
@@ -3,15 +3,15 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtLocation 5.11 as QtLocation
-import QtPositioning 5.11
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.kpublictransport.onboard 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtLocation as QtLocation
+import QtPositioning
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.kpublictransport.onboard
+import org.kde.itinerary
 
 Kirigami.Page {
     id: root
diff --git a/src/app/LocationInfoDelegate.qml b/src/app/LocationInfoDelegate.qml
index 5292f7ab4..77cd635ee 100644
--- a/src/app/LocationInfoDelegate.qml
+++ b/src/app/LocationInfoDelegate.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.i18n.localeData 1.0
-import org.kde.kitinerary 1.0 as KItinerary
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.i18n.localeData
+import org.kde.kitinerary as KItinerary
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCard {
diff --git a/src/app/LocationPicker.qml b/src/app/LocationPicker.qml
index 1ad006f89..90ad38d32 100644
--- a/src/app/LocationPicker.qml
+++ b/src/app/LocationPicker.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import QtLocation 5.11 as QtLocation
-import QtPositioning 5.11
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtLocation as QtLocation
+import QtPositioning
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 Kirigami.Page {
diff --git a/src/app/MapView.qml b/src/app/MapView.qml
index 4f4c7c816..9f74bb18d 100644
--- a/src/app/MapView.qml
+++ b/src/app/MapView.qml
@@ -3,9 +3,9 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtLocation 5.11 as QtLocation
+import QtQuick
+import QtQuick.Layouts
+import QtLocation as QtLocation
 
 /** QtLocation map view with standard intercation settings. */
 QtLocation.Map {
diff --git a/src/app/MatrixRoomSelectionSheet.qml b/src/app/MatrixRoomSelectionSheet.qml
index cc1df7be6..9fb4cf3a7 100644
--- a/src/app/MatrixRoomSelectionSheet.qml
+++ b/src/app/MatrixRoomSelectionSheet.qml
@@ -1,13 +1,13 @@
 // SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kitemmodels 1.0
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.components 1.0 as AddonComponents
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kitemmodels
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components as AddonComponents
+import org.kde.itinerary
 import "." as App
 
 // TODO sort room list in activity order
diff --git a/src/app/NavigationBar.qml b/src/app/NavigationBar.qml
index a37cb392e..54ae4692b 100644
--- a/src/app/NavigationBar.qml
+++ b/src/app/NavigationBar.qml
@@ -4,9 +4,9 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 Kirigami.NavigationTabBar {
diff --git a/src/app/OnlineImportPage.qml b/src/app/OnlineImportPage.qml
index 62c7254b6..28a3301a6 100644
--- a/src/app/OnlineImportPage.qml
+++ b/src/app/OnlineImportPage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCardPage {
diff --git a/src/app/PassPage.qml b/src/app/PassPage.qml
index e798e8c64..62733bf2b 100644
--- a/src/app/PassPage.qml
+++ b/src/app/PassPage.qml
@@ -3,13 +3,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import Qt.labs.qmlmodels 1.0 as Models
-import org.kde.kitemmodels 1.0
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.qmlmodels as Models
+import org.kde.kitemmodels
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/PkPassBarcode.qml b/src/app/PkPassBarcode.qml
index 3aace0add..6ab1c2b86 100644
--- a/src/app/PkPassBarcode.qml
+++ b/src/app/PkPassBarcode.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.pkpass 1.0 as KPkPass
-import org.kde.prison 1.0 as Prison
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.pkpass as KPkPass
+import org.kde.prison as Prison
 
 Rectangle {
     id: root
diff --git a/src/app/PkPassPage.qml b/src/app/PkPassPage.qml
index dde3d72ad..7cd3d33e4 100644
--- a/src/app/PkPassPage.qml
+++ b/src/app/PkPassPage.qml
@@ -4,9 +4,9 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.pkpass 1.0 as KPkPass
+import QtQuick
+import org.kde.kirigami as Kirigami
+import org.kde.pkpass as KPkPass
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/ProgramMembershipCard.qml b/src/app/ProgramMembershipCard.qml
index 824c0aee9..5663127e5 100644
--- a/src/app/ProgramMembershipCard.qml
+++ b/src/app/ProgramMembershipCard.qml
@@ -2,12 +2,12 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 
 ColumnLayout {
     id: root
diff --git a/src/app/ProgramMembershipEditor.qml b/src/app/ProgramMembershipEditor.qml
index 41bc2a9c1..06e6e5392 100644
--- a/src/app/ProgramMembershipEditor.qml
+++ b/src/app/ProgramMembershipEditor.qml
@@ -3,13 +3,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCardPage {
diff --git a/src/app/ProgramMembershipEditorCard.qml b/src/app/ProgramMembershipEditorCard.qml
index 522b3fa46..5050027b9 100644
--- a/src/app/ProgramMembershipEditorCard.qml
+++ b/src/app/ProgramMembershipEditorCard.qml
@@ -1,14 +1,14 @@
 // SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitemmodels 1.0
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitemmodels
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/ProgramMembershipPage.qml b/src/app/ProgramMembershipPage.qml
index f32128343..04b964504 100644
--- a/src/app/ProgramMembershipPage.qml
+++ b/src/app/ProgramMembershipPage.qml
@@ -3,13 +3,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCardPage {
diff --git a/src/app/PublicTransportBackendPage.qml b/src/app/PublicTransportBackendPage.qml
index 47774e7c3..bc01153c3 100644
--- a/src/app/PublicTransportBackendPage.qml
+++ b/src/app/PublicTransportBackendPage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.i18n.localeData 1.0
-import org.kde.kpublictransport 1.0 as KPublicTransport
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.i18n.localeData
+import org.kde.kpublictransport as KPublicTransport
+import org.kde.itinerary
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/ReservationDocumentsCard.qml b/src/app/ReservationDocumentsCard.qml
index 11172d1f4..0c6edd441 100644
--- a/src/app/ReservationDocumentsCard.qml
+++ b/src/app/ReservationDocumentsCard.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DocumentsCard {
diff --git a/src/app/RestaurantDelegate.qml b/src/app/RestaurantDelegate.qml
index aaede119d..a8fba1505 100644
--- a/src/app/RestaurantDelegate.qml
+++ b/src/app/RestaurantDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/RestaurantEditor.qml b/src/app/RestaurantEditor.qml
index cfcaf304c..fa33de567 100644
--- a/src/app/RestaurantEditor.qml
+++ b/src/app/RestaurantEditor.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/RestaurantPage.qml b/src/app/RestaurantPage.qml
index aa62e6936..82aca78a1 100644
--- a/src/app/RestaurantPage.qml
+++ b/src/app/RestaurantPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/SettingsPage.qml b/src/app/SettingsPage.qml
index 59492cf7f..2ee8f4462 100644
--- a/src/app/SettingsPage.qml
+++ b/src/app/SettingsPage.qml
@@ -2,15 +2,15 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtPositioning 5.11
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.i18n.localeData 1.0
-import org.kde.kpublictransport.onboard 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtPositioning
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.i18n.localeData
+import org.kde.kpublictransport.onboard
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCardPage {
diff --git a/src/app/StatisticsDelegate.qml b/src/app/StatisticsDelegate.qml
index aed2bfab8..1b9874975 100644
--- a/src/app/StatisticsDelegate.qml
+++ b/src/app/StatisticsDelegate.qml
@@ -2,12 +2,12 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 FormCard.FormTextDelegate {
diff --git a/src/app/StatisticsPage.qml b/src/app/StatisticsPage.qml
index eeae95c91..532a8534d 100644
--- a/src/app/StatisticsPage.qml
+++ b/src/app/StatisticsPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.i18n.localeData 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.i18n.localeData
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 FormCard.FormCardPage {
diff --git a/src/app/StopPickerPage.qml b/src/app/StopPickerPage.qml
index dfe26c932..5af1fe6a7 100644
--- a/src/app/StopPickerPage.qml
+++ b/src/app/StopPickerPage.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kitemmodels 1.0
-import org.kde.i18n.localeData 1.0
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitemmodels
+import org.kde.i18n.localeData
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/TicketEditor.qml b/src/app/TicketEditor.qml
index de9d9c87a..5a91ae3a2 100644
--- a/src/app/TicketEditor.qml
+++ b/src/app/TicketEditor.qml
@@ -3,14 +3,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import QtQuick.Templates 2.15 as T
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtQuick.Templates as T
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/TicketPage.qml b/src/app/TicketPage.qml
index eee065a6c..96a8d8997 100644
--- a/src/app/TicketPage.qml
+++ b/src/app/TicketPage.qml
@@ -3,13 +3,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCardPage {
diff --git a/src/app/TicketTokenDelegate.qml b/src/app/TicketTokenDelegate.qml
index e53b4b8e9..f1a946a95 100644
--- a/src/app/TicketTokenDelegate.qml
+++ b/src/app/TicketTokenDelegate.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import QtQuick.Window 2.10
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.prison 1.0 as Prison
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtQuick.Window
+import org.kde.kirigami as Kirigami
+import org.kde.prison as Prison
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 ColumnLayout {
diff --git a/src/app/TimelineDelegate.qml b/src/app/TimelineDelegate.qml
index cdcfe84cb..47e216cdc 100644
--- a/src/app/TimelineDelegate.qml
+++ b/src/app/TimelineDelegate.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCard {
diff --git a/src/app/TimelineDelegateHeaderBackground.qml b/src/app/TimelineDelegateHeaderBackground.qml
index a1d1d4ee1..5feb78818 100644
--- a/src/app/TimelineDelegateHeaderBackground.qml
+++ b/src/app/TimelineDelegateHeaderBackground.qml
@@ -3,10 +3,10 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
 
 Kirigami.ShadowedRectangle {
     id: root
diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index d99781da4..211c7f8d9 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import Qt.labs.qmlmodels 1.0 as Models
-import Qt.labs.platform 1.1 as Platform
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.qmlmodels as Models
+import Qt.labs.platform as Platform
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/TimelineSectionDelegate.qml b/src/app/TimelineSectionDelegate.qml
index c8d50cd8f..a5f19aee7 100644
--- a/src/app/TimelineSectionDelegate.qml
+++ b/src/app/TimelineSectionDelegate.qml
@@ -2,12 +2,12 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import org.kde.kirigami 2.17 as Kirigami
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import QtQuick.Layouts 1.15
-import org.kde.itinerary 1.0
+import QtQuick
+import org.kde.kirigami as Kirigami
+import QtQuick.Controls as QQC2
+import org.kde.kirigamiaddons.formcard as FormCard
+import QtQuick.Layouts
+import org.kde.itinerary
 import "." as App
 
 QQC2.Pane {
diff --git a/src/app/TouristAttractionDelegate.qml b/src/app/TouristAttractionDelegate.qml
index 9245292c4..51831b550 100644
--- a/src/app/TouristAttractionDelegate.qml
+++ b/src/app/TouristAttractionDelegate.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/TouristAttractionPage.qml b/src/app/TouristAttractionPage.qml
index fa0d5a026..2a6d19bff 100644
--- a/src/app/TouristAttractionPage.qml
+++ b/src/app/TouristAttractionPage.qml
@@ -2,13 +2,13 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/TrainDelegate.qml b/src/app/TrainDelegate.qml
index 8d87252e6..9e153ada0 100644
--- a/src/app/TrainDelegate.qml
+++ b/src/app/TrainDelegate.qml
@@ -2,12 +2,12 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 App.TimelineDelegate {
diff --git a/src/app/TrainEditor.qml b/src/app/TrainEditor.qml
index 3384b5206..853b1f0eb 100644
--- a/src/app/TrainEditor.qml
+++ b/src/app/TrainEditor.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kitinerary 1.0
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kitinerary
+import org.kde.kpublictransport
+import org.kde.itinerary
 import "." as App
 
 App.EditorPage {
diff --git a/src/app/TrainPage.qml b/src/app/TrainPage.qml
index d85e6726e..d6623743b 100644
--- a/src/app/TrainPage.qml
+++ b/src/app/TrainPage.qml
@@ -2,14 +2,14 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.kpublictransport 1.0 as KPublicTransport
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.kpublictransport as KPublicTransport
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 App.DetailsPage {
diff --git a/src/app/TransferDelegate.qml b/src/app/TransferDelegate.qml
index 5cb34fabf..664e4774f 100644
--- a/src/app/TransferDelegate.qml
+++ b/src/app/TransferDelegate.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 FormCard.FormCard {
diff --git a/src/app/TransferPage.qml b/src/app/TransferPage.qml
index 1c82aca3d..5094321a9 100644
--- a/src/app/TransferPage.qml
+++ b/src/app/TransferPage.qml
@@ -4,14 +4,14 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kitemmodels 1.0
-import org.kde.kpublictransport 1.0
-import org.kde.itinerary 1.0
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitemmodels
+import org.kde.kpublictransport
+import org.kde.itinerary
+import org.kde.kirigamiaddons.formcard as FormCard
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/TripGroupDelegate.qml b/src/app/TripGroupDelegate.qml
index d47b7dfa0..5aa8a34e5 100644
--- a/src/app/TripGroupDelegate.qml
+++ b/src/app/TripGroupDelegate.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.i18n.localeData 1.0
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.i18n.localeData
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 FormCard.FormCard {
diff --git a/src/app/VehicleLayoutPage.qml b/src/app/VehicleLayoutPage.qml
index 088e9613f..0731f3da7 100644
--- a/src/app/VehicleLayoutPage.qml
+++ b/src/app/VehicleLayoutPage.qml
@@ -4,13 +4,13 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0 as KPublicTransport
-import org.kde.kpublictransport.ui 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport as KPublicTransport
+import org.kde.kpublictransport.ui
+import org.kde.itinerary
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/VehicleLoadIndicator.qml b/src/app/VehicleLoadIndicator.qml
index e1e1124f3..be7723816 100644
--- a/src/app/VehicleLoadIndicator.qml
+++ b/src/app/VehicleLoadIndicator.qml
@@ -4,10 +4,10 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.12
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0
+import QtQuick
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport
 
 Item {
     property var loadInformation
diff --git a/src/app/VerticalNavigationButton.qml b/src/app/VerticalNavigationButton.qml
index 32441d65a..de1c8bf41 100644
--- a/src/app/VerticalNavigationButton.qml
+++ b/src/app/VerticalNavigationButton.qml
@@ -1,11 +1,11 @@
 // SPDX-FileCopyrightText: 2019 Volker Krause <vkrause@kde.org>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.20 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
 
 ColumnLayout {
     id: root
diff --git a/src/app/WeatherForecastDelegate.qml b/src/app/WeatherForecastDelegate.qml
index 9bbd5d86f..f968c791a 100644
--- a/src/app/WeatherForecastDelegate.qml
+++ b/src/app/WeatherForecastDelegate.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 import "." as App
 
 
diff --git a/src/app/WeatherForecastPage.qml b/src/app/WeatherForecastPage.qml
index 4dd006c47..d8a46e2e8 100644
--- a/src/app/WeatherForecastPage.qml
+++ b/src/app/WeatherForecastPage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kitinerary 1.0
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kitinerary
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/WelcomePage.qml b/src/app/WelcomePage.qml
index ed9814afc..54c4f5cd2 100644
--- a/src/app/WelcomePage.qml
+++ b/src/app/WelcomePage.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import QtPositioning 5.11
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import QtPositioning
+import org.kde.kirigami as Kirigami
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ScrollablePage {
diff --git a/src/app/components/RadioSelector.qml b/src/app/components/RadioSelector.qml
index 92741175c..c8dc67d46 100644
--- a/src/app/components/RadioSelector.qml
+++ b/src/app/components/RadioSelector.qml
@@ -1,10 +1,10 @@
 // SPDX-License-Identifier: LGPL-2.0-or-later
 // SPDX-FileCopyrightText: 2023 Mathis Brüchert <mbb@kaidan.im>
 
-import QtQuick 2.15
-import QtQuick.Controls 2.15 as QQC2
-import QtQuick.Layouts 1.15
-import org.kde.kirigami 2.19 as Kirigami
+import QtQuick
+import QtQuick.Controls as QQC2
+import QtQuick.Layouts
+import org.kde.kirigami as Kirigami
 
 RowLayout {
     id: root
diff --git a/src/app/main.qml b/src/app/main.qml
index 0c24ace3a..c1ce4cc07 100644
--- a/src/app/main.qml
+++ b/src/app/main.qml
@@ -4,16 +4,16 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.13
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import Qt.labs.platform 1.1
-import QtLocation 5.11 as QtLocation
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.solidextras 1.0 as Solid
-import org.kde.kpublictransport.onboard 1.0
-import internal.org.kde.kcalendarcore 1.0 as KCalendarCore
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import Qt.labs.platform
+import QtLocation as QtLocation
+import org.kde.kirigami as Kirigami
+import org.kde.solidextras as Solid
+import org.kde.kpublictransport.onboard
+import internal.org.kde.kcalendarcore as KCalendarCore
+import org.kde.itinerary
 import "." as App
 
 Kirigami.ApplicationWindow {
diff --git a/src/app/onlineimport/db.qml b/src/app/onlineimport/db.qml
index 04432ab70..ada0ca205 100644
--- a/src/app/onlineimport/db.qml
+++ b/src/app/onlineimport/db.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 
 ColumnLayout {
     id: root
diff --git a/src/app/onlineimport/sncf.qml b/src/app/onlineimport/sncf.qml
index 61d2eae96..879e033a2 100644
--- a/src/app/onlineimport/sncf.qml
+++ b/src/app/onlineimport/sncf.qml
@@ -4,12 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.15
-import QtQuick.Layouts 1.15
-import QtQuick.Controls 2.15 as QQC2
-import org.kde.kirigami 2.19 as Kirigami
-import org.kde.kirigamiaddons.formcard 1.0 as FormCard
-import org.kde.itinerary 1.0
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.formcard as FormCard
+import org.kde.itinerary
 
 ColumnLayout {
     id: root
diff --git a/tests/journeyquerytest.qml b/tests/journeyquerytest.qml
index 0c6f2d5c6..8fd3728e9 100644
--- a/tests/journeyquerytest.qml
+++ b/tests/journeyquerytest.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0 as KPT
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport as KPT
 import "." as App
 
 Kirigami.ApplicationWindow {
diff --git a/tests/pkpassviewer.qml b/tests/pkpassviewer.qml
index 76780f66b..51bb675d0 100644
--- a/tests/pkpassviewer.qml
+++ b/tests/pkpassviewer.qml
@@ -4,10 +4,10 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
 import "." as App
 
 Kirigami.ApplicationWindow {
diff --git a/tests/vehiclelayoutviewer.qml b/tests/vehiclelayoutviewer.qml
index 608d0747b..e9d654c8e 100644
--- a/tests/vehiclelayoutviewer.qml
+++ b/tests/vehiclelayoutviewer.qml
@@ -4,11 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
-import QtQuick 2.5
-import QtQuick.Layouts 1.1
-import QtQuick.Controls 2.1 as QQC2
-import org.kde.kirigami 2.17 as Kirigami
-import org.kde.kpublictransport 1.0 as KPT
+import QtQuick
+import QtQuick.Layouts
+import QtQuick.Controls as QQC2
+import org.kde.kirigami as Kirigami
+import org.kde.kpublictransport as KPT
 import "." as App
 
 Kirigami.ApplicationWindow {
-- 
GitLab


From fb2f651470f7d6a1f0fc8652f3f23af8423d0602 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 19:59:47 +0100
Subject: [PATCH 02/36] Port away from Kirigami.AbstractListItem

---
 src/app/CalendarImportPage.qml         | 5 +++--
 src/app/IndoorMapAmenityDelegate.qml   | 5 +++--
 src/app/IndoorMapPlatformSheet.qml     | 6 ++++--
 src/app/JourneyPathPage.qml            | 5 +++--
 src/app/MatrixRoomSelectionSheet.qml   | 5 +++--
 src/app/PublicTransportBackendPage.qml | 5 +++--
 6 files changed, 19 insertions(+), 12 deletions(-)

diff --git a/src/app/CalendarImportPage.qml b/src/app/CalendarImportPage.qml
index e3eecdb73..1ccbc647d 100644
--- a/src/app/CalendarImportPage.qml
+++ b/src/app/CalendarImportPage.qml
@@ -36,9 +36,10 @@ Kirigami.ScrollablePage {
         id: eventList
         model: importModel
 
-        delegate: Kirigami.AbstractListItem {
+        delegate: QQC2.ItemDelegate {
             highlighted: model.selected
-            GridLayout {
+            width: ListView.view.width
+            contentItem: GridLayout {
                 columns: 2
                 rows: 2
 
diff --git a/src/app/IndoorMapAmenityDelegate.qml b/src/app/IndoorMapAmenityDelegate.qml
index b1f0eda8f..d55885271 100644
--- a/src/app/IndoorMapAmenityDelegate.qml
+++ b/src/app/IndoorMapAmenityDelegate.qml
@@ -10,7 +10,7 @@ import org.kde.kirigami as Kirigami
 import org.kde.kopeninghours
 import org.kde.kosmindoormap
 
-Kirigami.AbstractListItem {
+QQC2.ItemDelegate {
     id: root
     required property string name
     required property string typeName
@@ -24,6 +24,7 @@ Kirigami.AbstractListItem {
     required property int index // for Kirigami
 
     highlighted: false
+    width: ListView.view.width
 
     property var oh: {
         let v = OpeningHoursParser.parse(root.openingHours);
@@ -36,7 +37,7 @@ Kirigami.AbstractListItem {
         return v;
     }
 
-    RowLayout {
+    contentItem: RowLayout {
         spacing: Kirigami.Units.largeSpacing
 
         Kirigami.Icon {
diff --git a/src/app/IndoorMapPlatformSheet.qml b/src/app/IndoorMapPlatformSheet.qml
index ee8acfea3..61b606c67 100644
--- a/src/app/IndoorMapPlatformSheet.qml
+++ b/src/app/IndoorMapPlatformSheet.qml
@@ -22,13 +22,15 @@ Kirigami.OverlaySheet {
 
     ListView {
         model: platformSheet.model
+        clip: true
         Layout.preferredWidth: Kirigami.Units.gridUnit * 25
 
         Component {
             id: platformDelegate
-            Kirigami.AbstractListItem {
+            QQC2.ItemDelegate {
                 property var platform: model
-                Row {
+                width: ListView.view.width
+                contentItem: Row {
                     spacing: Kirigami.Units.smallSpacing
                     QQC2.Label {
                         text: {
diff --git a/src/app/JourneyPathPage.qml b/src/app/JourneyPathPage.qml
index 59c576090..cfe866bb2 100644
--- a/src/app/JourneyPathPage.qml
+++ b/src/app/JourneyPathPage.qml
@@ -17,10 +17,11 @@ Kirigami.ScrollablePage {
 
     Component {
         id: pathDelegate
-        Kirigami.AbstractListItem {
+        QQC2.ItemDelegate {
             highlighted: false
+            width: ListView.view.width
             property var section: model.section
-            GridLayout {
+            contentItem: GridLayout {
                 rows: 2
                 columns: 4
 
diff --git a/src/app/MatrixRoomSelectionSheet.qml b/src/app/MatrixRoomSelectionSheet.qml
index 9fb4cf3a7..eb8473f8c 100644
--- a/src/app/MatrixRoomSelectionSheet.qml
+++ b/src/app/MatrixRoomSelectionSheet.qml
@@ -41,7 +41,7 @@ Kirigami.OverlaySheet {
             }
         }
 
-        delegate: Kirigami.AbstractListItem {
+        delegate: QQC2.ItemDelegate {
             required property string displayName
             required property var avatar
             required property var avatarImage
@@ -49,7 +49,8 @@ Kirigami.OverlaySheet {
             required property string id
             required property int index
 
-            GridLayout {
+            width: ListView.view.width
+            contentItem: GridLayout {
                 rows: 2
                 columns: 3
                 AddonComponents.Avatar {
diff --git a/src/app/PublicTransportBackendPage.qml b/src/app/PublicTransportBackendPage.qml
index bc01153c3..779bdaecc 100644
--- a/src/app/PublicTransportBackendPage.qml
+++ b/src/app/PublicTransportBackendPage.qml
@@ -25,11 +25,12 @@ Kirigami.ScrollablePage {
 
     Component {
         id: backendDelegate
-        Kirigami.AbstractListItem {
+        QQC2.ItemDelegate {
             highlighted: false
             enabled: model.itemEnabled
+            width: ListView.view.width
 
-            Item {
+            contentItem: Item {
                 anchors.margins: Kirigami.Units.largeSpacing
                 implicitHeight: childrenRect.height
 
-- 
GitLab


From 78f3690785d7124937eeac1373e57a82b985d202 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:05:46 +0100
Subject: [PATCH 03/36] Port Kirigami page actions

---
 src/app/AlternativeJourneyPage.qml  |  2 +-
 src/app/BarcodeScannerPage.qml      | 23 +++++++++-----
 src/app/CalendarImportPage.qml      | 29 +++++++++++------
 src/app/DepartureQueryPage.qml      |  2 +-
 src/app/EditorPage.qml              | 17 +++++-----
 src/app/FavoriteLocationPage.qml    | 34 +++++++++++++-------
 src/app/GenericPkPassPage.qml       |  2 +-
 src/app/HealthCertificatePage.qml   |  2 +-
 src/app/IndoorMapPage.qml           |  4 ++-
 src/app/JourneyQueryPage.qml        |  2 +-
 src/app/LiveStatusPage.qml          | 12 ++++---
 src/app/LocationPicker.qml          | 29 +++++++++++------
 src/app/PassPage.qml                |  2 +-
 src/app/ProgramMembershipEditor.qml | 49 +++++++++++++++++------------
 src/app/StopPickerPage.qml          |  2 +-
 src/app/TimelinePage.qml            |  4 ++-
 src/app/TransferPage.qml            |  2 +-
 src/app/main.qml                    | 10 +++++-
 18 files changed, 145 insertions(+), 82 deletions(-)

diff --git a/src/app/AlternativeJourneyPage.qml b/src/app/AlternativeJourneyPage.qml
index 61051e325..edc183261 100644
--- a/src/app/AlternativeJourneyPage.qml
+++ b/src/app/AlternativeJourneyPage.qml
@@ -52,7 +52,7 @@ App.JourneyQueryPage {
 
     Component.onCompleted: {
         for (const action of [fullJourneyAction, oneJourneyAction, actionSeparator, longDistanceModeAction, localTrainModeAction, rapidTransitModeAction, busModeAction, ferryModeAction]) {
-                actions.contextualActions.push(action);
+                actions.push(action);
         }
     }
 
diff --git a/src/app/BarcodeScannerPage.qml b/src/app/BarcodeScannerPage.qml
index dae3664af..9e3f0212a 100644
--- a/src/app/BarcodeScannerPage.qml
+++ b/src/app/BarcodeScannerPage.qml
@@ -8,6 +8,7 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import QtMultimedia
 import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components
 import org.kde.prison.scanner as Prison
 import org.kde.itinerary
 import "." as App
@@ -21,13 +22,21 @@ Kirigami.Page {
     topPadding: 0
     bottomPadding: 0
 
-    actions.main: Kirigami.Action {
-        icon.name: checked ? "flashlight-off" : "flashlight-on"
-        text: i18n("Light")
-        checkable: true
-        checked: camera.flash.mode == Camera.FlashVideoLight
-        visible: camera.flash.supportedModes.length > 1
-        onTriggered: camera.flash.mode = (camera.flash.mode == Camera.FlashVideoLight ? Camera.FlashOff : Camera.FlashVideoLight)
+    FloatingButton {
+        anchors {
+            right: parent.right
+            rightMargin: Kirigami.Units.largeSpacing + (root.contentItem.QQC2.ScrollBar && root.contentItem.QQC2.ScrollBar.vertical ? root.contentItem.QQC2.ScrollBar.vertical.width : 0)
+            bottom: parent.bottom
+            bottomMargin: Kirigami.Units.largeSpacing
+        }
+        action: Kirigami.Action {
+            icon.name: checked ? "flashlight-off" : "flashlight-on"
+            text: i18n("Light")
+            checkable: true
+            checked: camera.flash.mode == Camera.FlashVideoLight
+            visible: camera.flash.supportedModes.length > 1
+            onTriggered: camera.flash.mode = (camera.flash.mode == Camera.FlashVideoLight ? Camera.FlashOff : Camera.FlashVideoLight)
+        }
     }
 
     VideoOutput {
diff --git a/src/app/CalendarImportPage.qml b/src/app/CalendarImportPage.qml
index 1ccbc647d..62db84b54 100644
--- a/src/app/CalendarImportPage.qml
+++ b/src/app/CalendarImportPage.qml
@@ -7,6 +7,7 @@ import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components
 import internal.org.kde.kcalendarcore as KCalendarCore
 import org.kde.itinerary
 import "." as App
@@ -18,16 +19,6 @@ Kirigami.ScrollablePage {
 
     title: i18n("Calendar Import")
 
-    actions.main: Kirigami.Action {
-        icon.name: "document-open"
-        text: i18n("Import selected events")
-        enabled: importModel.hasSelection
-        onTriggered: {
-            importModel.selectedReservations().forEach(r => ReservationManager.importReservation(r));
-            applicationWindow().pageStack.pop();
-        }
-    }
-
     CalendarImportModel {
         id: importModel
     }
@@ -68,5 +59,23 @@ Kirigami.ScrollablePage {
             visible: eventList.count === 0
             anchors.fill: parent
         }
+
+        FloatingButton {
+            anchors {
+                right: parent.right
+                rightMargin: Kirigami.Units.largeSpacing + (root.contentItem.QQC2.ScrollBar && root.contentItem.QQC2.ScrollBar.vertical ? root.contentItem.QQC2.ScrollBar.vertical.width : 0)
+                bottom: parent.bottom
+                bottomMargin: Kirigami.Units.largeSpacing
+            }
+            action: Kirigami.Action {
+                icon.name: "document-open"
+                text: i18n("Import selected events")
+                enabled: importModel.hasSelection
+                onTriggered: {
+                    importModel.selectedReservations().forEach(r => ReservationManager.importReservation(r));
+                    applicationWindow().pageStack.pop();
+                }
+            }
+    }
     }
 }
diff --git a/src/app/DepartureQueryPage.qml b/src/app/DepartureQueryPage.qml
index 90946b511..f6c78dbf8 100644
--- a/src/app/DepartureQueryPage.qml
+++ b/src/app/DepartureQueryPage.qml
@@ -20,7 +20,7 @@ Kirigami.ScrollablePage {
     property var dateTime
 
     title: i18n("Departures")
-    contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Earlier")
             icon.name: "go-up-symbolic"
diff --git a/src/app/EditorPage.qml b/src/app/EditorPage.qml
index ed2ee0f22..6e5fb3fd2 100644
--- a/src/app/EditorPage.qml
+++ b/src/app/EditorPage.qml
@@ -9,6 +9,7 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import QtQuick.Templates as T
 import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components
 import org.kde.kitinerary
 import org.kde.itinerary
 import "." as App
@@ -57,15 +58,13 @@ Kirigami.ScrollablePage {
     leftPadding: 0
     rightPadding: 0
 
-    footer: QQC2.ToolBar {
-        contentItem: RowLayout {
-            Item {
-                Layout.fillWidth: true
-            }
-
-            QQC2.Button {
-                action: saveAction
-            }
+    data: FloatingButton {
+        anchors {
+            right: parent.right
+            rightMargin: Kirigami.Units.largeSpacing + (root.contentItem.QQC2.ScrollBar && root.contentItem.QQC2.ScrollBar.vertical ? root.contentItem.QQC2.ScrollBar.vertical.width : 0)
+            bottom: parent.bottom
+            bottomMargin: Kirigami.Units.largeSpacing
         }
+        action: root.saveAction
     }
 }
diff --git a/src/app/FavoriteLocationPage.qml b/src/app/FavoriteLocationPage.qml
index 288669b5b..cadea6146 100644
--- a/src/app/FavoriteLocationPage.qml
+++ b/src/app/FavoriteLocationPage.qml
@@ -11,6 +11,7 @@ import Qt.labs.platform as Platform
 import QtLocation as QtLocation
 import QtPositioning
 import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components
 import org.kde.itinerary
 import "." as App
 
@@ -46,17 +47,7 @@ Kirigami.Page {
         onAccepted: FavoriteLocationModel.importFromGpx(file)
     }
 
-   actions.main: Kirigami.Action {
-        icon.name: "crosshairs"
-        text: i18n("Pick Location")
-        onTriggered: {
-            var idx = FavoriteLocationModel.index(combo.currentIndex, 0);
-            FavoriteLocationModel.setData(idx, map.center.latitude, FavoriteLocationModel.LatitudeRole);
-            FavoriteLocationModel.setData(idx, map.center.longitude, FavoriteLocationModel.LongitudeRole);
-            applicationWindow().pageStack.goBack();
-        }
-    }
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Add Favorite Location")
             icon.name: "list-add"
@@ -147,4 +138,25 @@ Kirigami.Page {
             }
         }
     }
+
+    FloatingButton {
+        anchors {
+            right: parent.right
+            rightMargin: Kirigami.Units.largeSpacing + (root.contentItem.QQC2.ScrollBar && root.contentItem.QQC2.ScrollBar.vertical ? root.contentItem.QQC2.ScrollBar.vertical.width : 0)
+            bottom: parent.bottom
+            bottomMargin: Kirigami.Units.largeSpacing
+        }
+        action: Kirigami.Action {
+            icon.name: "crosshairs"
+            text: i18n("Pick Location")
+            onTriggered: {
+                var idx = FavoriteLocationModel.index(combo.currentIndex, 0);
+                FavoriteLocationModel.setData(idx, map.center.latitude, FavoriteLocationModel.LatitudeRole);
+                FavoriteLocationModel.setData(idx, map.center.longitude, FavoriteLocationModel.LongitudeRole);
+                applicationWindow().pageStack.goBack();
+            }
+        }
+    }
+
+    footer: null
 }
diff --git a/src/app/GenericPkPassPage.qml b/src/app/GenericPkPassPage.qml
index 135f4a381..d00d77994 100644
--- a/src/app/GenericPkPassPage.qml
+++ b/src/app/GenericPkPassPage.qml
@@ -32,7 +32,7 @@ PkPassPage {
         ]
     }
 
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             icon.name: "edit-delete"
             text: i18n("Delete")
diff --git a/src/app/HealthCertificatePage.qml b/src/app/HealthCertificatePage.qml
index 5e190a6f1..ecaef3b1f 100644
--- a/src/app/HealthCertificatePage.qml
+++ b/src/app/HealthCertificatePage.qml
@@ -41,7 +41,7 @@ Kirigami.Page {
         }
     }
 
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             id: importFromClipboardAction
             icon.name: "edit-paste"
diff --git a/src/app/IndoorMapPage.qml b/src/app/IndoorMapPage.qml
index b6d2bede3..a443208bf 100644
--- a/src/app/IndoorMapPage.qml
+++ b/src/app/IndoorMapPage.qml
@@ -54,7 +54,7 @@ Kirigami.Page {
     // TODO in theory we could make this conditional to having panned the map all the way to the right
     Kirigami.ColumnView.preventStealing: true
 
-    contextualActions: [
+    actions: [
         Kirigami.Action {
             id: zoomInAction
             text: i18n("Zoom In")
@@ -357,4 +357,6 @@ Kirigami.Page {
             visible: map.floorLevels.hasFloorLevels
         }
     }
+
+    footer: null
 }
diff --git a/src/app/JourneyQueryPage.qml b/src/app/JourneyQueryPage.qml
index 01328929b..1cb94b7e0 100644
--- a/src/app/JourneyQueryPage.qml
+++ b/src/app/JourneyQueryPage.qml
@@ -24,7 +24,7 @@ Kirigami.ScrollablePage {
     property alias journeyRequest: journeyModel.request
     property alias publicTransportManager: journeyModel.manager
 
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Earlier")
             icon.name: "go-up-symbolic"
diff --git a/src/app/LiveStatusPage.qml b/src/app/LiveStatusPage.qml
index 66dd196ba..5f26130b1 100644
--- a/src/app/LiveStatusPage.qml
+++ b/src/app/LiveStatusPage.qml
@@ -23,11 +23,13 @@ Kirigami.Page {
     topPadding: 0
     bottomPadding: 0
 
-    actions.contextualActions: Kirigami.Action {
-        text: matrixBeacon.isActive ? i18n("Stop Location Sharing") : i18n("Share Location via Matrix")
-        icon.name: matrixBeacon.isActive ? "dialog-cancel" : "emblem-shared-symbolic"
-        onTriggered: matrixBeacon.isActive ? matrixBeacon.stop() : matrixRoomSheet.open()
-    }
+    actions: [
+        Kirigami.Action {
+            text: matrixBeacon.isActive ? i18n("Stop Location Sharing") : i18n("Share Location via Matrix")
+            icon.name: matrixBeacon.isActive ? "dialog-cancel" : "emblem-shared-symbolic"
+            onTriggered: matrixBeacon.isActive ? matrixBeacon.stop() : matrixRoomSheet.open()
+        }
+    ]
 
     OnboardStatus {
         id: onboardStatus
diff --git a/src/app/LocationPicker.qml b/src/app/LocationPicker.qml
index 90ad38d32..3b12172c8 100644
--- a/src/app/LocationPicker.qml
+++ b/src/app/LocationPicker.qml
@@ -10,6 +10,7 @@ import QtQuick.Controls as QQC2
 import QtLocation as QtLocation
 import QtPositioning
 import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components
 import org.kde.itinerary
 import "." as App
 
@@ -25,15 +26,6 @@ Kirigami.Page {
     // prevent swipe to the right changing pages, we want to pan the map instead
     Kirigami.ColumnView.preventStealing: true
 
-   actions.main: Kirigami.Action {
-        icon.name: "crosshairs"
-        text: i18n("Pick Location")
-        onTriggered: {
-            coordinate = map.center;
-            applicationWindow().pageStack.goBack();
-        }
-    }
-
     MapView {
         id: map
         anchors.fill: parent
@@ -52,4 +44,23 @@ Kirigami.Page {
             }
         }
     }
+
+    FloatingButton {
+        anchors {
+            right: parent.right
+            rightMargin: Kirigami.Units.largeSpacing + (root.contentItem.QQC2.ScrollBar && root.contentItem.QQC2.ScrollBar.vertical ? root.contentItem.QQC2.ScrollBar.vertical.width : 0)
+            bottom: parent.bottom
+            bottomMargin: Kirigami.Units.largeSpacing
+        }
+        action: Kirigami.Action {
+            icon.name: "crosshairs"
+            text: i18n("Pick Location")
+            onTriggered: {
+                coordinate = map.center;
+                applicationWindow().pageStack.goBack();
+            }
+        }
+    }
+
+    footer: null
 }
diff --git a/src/app/PassPage.qml b/src/app/PassPage.qml
index 62733bf2b..9caf517c1 100644
--- a/src/app/PassPage.qml
+++ b/src/app/PassPage.qml
@@ -25,7 +25,7 @@ Kirigami.ScrollablePage {
         App.TicketPage {}
     }
 
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Add Program Membership...")
             icon.name: "list-add-symbolic"
diff --git a/src/app/ProgramMembershipEditor.qml b/src/app/ProgramMembershipEditor.qml
index 06e6e5392..b7dd480ba 100644
--- a/src/app/ProgramMembershipEditor.qml
+++ b/src/app/ProgramMembershipEditor.qml
@@ -7,6 +7,7 @@ import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
+import org.kde.kirigamiaddons.components
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
@@ -22,28 +23,36 @@ FormCard.FormCardPage {
 
     title: i18n("Edit Program Membership")
 
-    actions.main: Kirigami.Action {
-        text: i18n("Save")
-        icon.name: "document-save"
-        enabled: root.isValidInput
-        onTriggered: {
-            let program = root.passId !== "" ? PassManager.pass(root.passId) : root.programMembership;
+    data: FloatingButton {
+        anchors {
+            right: parent.right
+            rightMargin: Kirigami.Units.largeSpacing + (root.contentItem.QQC2.ScrollBar && root.contentItem.QQC2.ScrollBar.vertical ? root.contentItem.QQC2.ScrollBar.vertical.width : 0)
+            bottom: parent.bottom
+            bottomMargin: Kirigami.Units.largeSpacing
+        }
+        action: Kirigami.Action {
+            text: i18n("Save")
+            icon.name: "document-save"
+            enabled: root.isValidInput
+            onTriggered: {
+                let program = root.passId !== "" ? PassManager.pass(root.passId) : root.programMembership;
 
-            let member = program.member;
-            member.name = memberNameEdit.text;
-            program.member = member;
-            program.programName = programNameEdit.text;
-            program.membershipNumber = numberEdit.text;
-            if (validFromEdit.isModified)
-                program = Util.setDateTimePreserveTimezone(program, "validFrom", validFromEdit.value);
-            if (validUntilEdit.isModified)
-                program = Util.setDateTimePreserveTimezone(program, "validUntil", validUntilEdit.value);
+                let member = program.member;
+                member.name = memberNameEdit.text;
+                program.member = member;
+                program.programName = programNameEdit.text;
+                program.membershipNumber = numberEdit.text;
+                if (validFromEdit.isModified)
+                    program = Util.setDateTimePreserveTimezone(program, "validFrom", validFromEdit.value);
+                if (validUntilEdit.isModified)
+                    program = Util.setDateTimePreserveTimezone(program, "validUntil", validUntilEdit.value);
 
-            if (root.passId !== "")
-                PassManager.update(root.passId, program);
-            else
-                PassManager.import(program);
-            applicationWindow().pageStack.pop();
+                if (root.passId !== "")
+                    PassManager.update(root.passId, program);
+                else
+                    PassManager.import(program);
+                applicationWindow().pageStack.pop();
+            }
         }
     }
 
diff --git a/src/app/StopPickerPage.qml b/src/app/StopPickerPage.qml
index 5af1fe6a7..df692af62 100644
--- a/src/app/StopPickerPage.qml
+++ b/src/app/StopPickerPage.qml
@@ -24,7 +24,7 @@ Kirigami.ScrollablePage {
     property var location
 
     QQC2.ActionGroup { id: sortActionGroup }
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Clear history")
             icon.name: "edit-clear-history"
diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index 211c7f8d9..263f52193 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -83,7 +83,7 @@ Kirigami.ScrollablePage {
         });
     }
     // context drawer content
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Go To Now")
             icon.name: "view-calendar-day"
@@ -470,4 +470,6 @@ Kirigami.ScrollablePage {
     }
 
     Component.onCompleted: positionTimer.start()
+
+    footer: null
 }
diff --git a/src/app/TransferPage.qml b/src/app/TransferPage.qml
index 5094321a9..fea63a283 100644
--- a/src/app/TransferPage.qml
+++ b/src/app/TransferPage.qml
@@ -39,7 +39,7 @@ Kirigami.ScrollablePage {
         color: Kirigami.Theme.backgroundColor
     }
 
-    actions.contextualActions: [
+    actions: [
         Kirigami.Action {
             text: i18n("Depart Now")
             icon.name: "clock"
diff --git a/src/app/main.qml b/src/app/main.qml
index c1ce4cc07..ee2fcf46a 100644
--- a/src/app/main.qml
+++ b/src/app/main.qml
@@ -31,7 +31,10 @@ Kirigami.ApplicationWindow {
     pageStack {
         columnView.columnResizeMode: Kirigami.ColumnView.SingleColumn
 
-        globalToolBar.showNavigationButtons: Kirigami.ApplicationHeaderStyle.ShowBackButton
+        globalToolBar {
+            style: Kirigami.Settings.isMobile ? Kirigami.ApplicationHeaderStyle.Breadcrumb : Kirigami.ApplicationHeaderStyle.Auto
+            showNavigationButtons: Kirigami.ApplicationHeaderStyle.ShowBackButton
+        }
     }
 
     // pop pages when not in use
@@ -240,6 +243,11 @@ Kirigami.ApplicationWindow {
     }
     contextDrawer: Kirigami.ContextDrawer {
         id: contextDrawer
+        actions: {
+            if (pageStack.layers.depth > 1)
+                return (pageStack.layers.currentItem as Kirigami.Page)?.actions ?? [];
+            else (pageStack.currentItem as Kirigami.Page)?.actions ?? [];
+        }
     }
     pageStack.initialPage: pagepool.loadPage(Qt.resolvedUrl("TimelinePage.qml"))
 
-- 
GitLab


From 75f29eb4765e8920fe32f76c26db479bcce0d588 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:17:14 +0100
Subject: [PATCH 04/36] Port away from Kirigami.BasicListItem

---
 src/app/CalendarSelectionSheet.qml   |  6 +++-
 src/app/IndoorMapElevatorSheet.qml   |  9 +++--
 src/app/IndoorMapGateSheet.qml       | 25 +++++++------
 src/app/IntermediateStopSelector.qml | 13 ++++---
 src/app/PassPage.qml                 | 54 ++++++++++++++++------------
 src/app/StopPickerPage.qml           |  7 ++--
 6 files changed, 69 insertions(+), 45 deletions(-)

diff --git a/src/app/CalendarSelectionSheet.qml b/src/app/CalendarSelectionSheet.qml
index d2434ddc6..3d31996f7 100644
--- a/src/app/CalendarSelectionSheet.qml
+++ b/src/app/CalendarSelectionSheet.qml
@@ -19,12 +19,16 @@ Kirigami.OverlaySheet {
     ListView {
         id: calendarSelectorListView
         implicitWidth: Kirigami.Units.gridUnit * 20
-        delegate: Kirigami.BasicListItem {
+        delegate: QQC2.ItemDelegate {
             required property int index
             required property string name
             required property var calendar
 
             text: name
+            width: ListView.view.width
+            contentItem: Kirigami.TitleSubtitle {
+                title: parent.text
+            }
             onClicked: {
                 root.calendarSelected(calendar);
                 root.close();
diff --git a/src/app/IndoorMapElevatorSheet.qml b/src/app/IndoorMapElevatorSheet.qml
index a9c2fb08f..f8f0000b7 100644
--- a/src/app/IndoorMapElevatorSheet.qml
+++ b/src/app/IndoorMapElevatorSheet.qml
@@ -22,10 +22,13 @@ Kirigami.OverlaySheet {
         model: elevatorSheet.model
         Layout.preferredWidth: Kirigami.Units.gridUnit * 10
 
-        delegate: Kirigami.BasicListItem {
+        delegate: QQC2.ItemDelegate {
             highlighted: false
-            label: model.display
-            bold: model.isCurrentFloor
+            width: ListView.view.width
+            contentItem: Kirigami.TitleSubtitle {
+                title: model.display
+                font.bold: model.isCurrentFloor
+            }
             onClicked: {
                 elevatorSheet.close();
                 map.view.floorLevel = model.floorLevel;
diff --git a/src/app/IndoorMapGateSheet.qml b/src/app/IndoorMapGateSheet.qml
index 3eac4acad..fd73f00af 100644
--- a/src/app/IndoorMapGateSheet.qml
+++ b/src/app/IndoorMapGateSheet.qml
@@ -22,18 +22,21 @@ Kirigami.OverlaySheet {
         model: gateSheet.model
         Layout.preferredWidth: Kirigami.Units.gridUnit * 10
 
-        delegate: Kirigami.BasicListItem {
-            property var gate: model
-            text: {
-                if (gate.isDepartureGate && gate.isArrivalGate)
-                    return i18nc("flight departure/arrival gate", "%1 (arrival + departure)", gate.display);
-                if (gate.isDepartureGate)
-                    return i18nc("flight departure gate", "%1 (departure)", gate.display);
-                if (gate.isArrivalGate)
-                    return i18nc("flight arrival gate", "%1 (arrival)", gate.display);
-                return gate.display
-            }
+        delegate: QQC2.ItemDelegate {
             highlighted: false
+            width: ListView.view.width
+            contentItem: Kirigami.TitleSubtitle {
+                property var gate: model
+                title: {
+                    if (gate.isDepartureGate && gate.isArrivalGate)
+                        return i18nc("flight departure/arrival gate", "%1 (arrival + departure)", gate.display);
+                    if (gate.isDepartureGate)
+                        return i18nc("flight departure gate", "%1 (departure)", gate.display);
+                    if (gate.isArrivalGate)
+                        return i18nc("flight arrival gate", "%1 (arrival)", gate.display);
+                    return gate.display
+                }
+            }
             onClicked: {
                 map.view.floorLevel = model.level
                 map.view.centerOnGeoCoordinate(model.coordinate);
diff --git a/src/app/IntermediateStopSelector.qml b/src/app/IntermediateStopSelector.qml
index 4e17fd120..a0f53e60f 100644
--- a/src/app/IntermediateStopSelector.qml
+++ b/src/app/IntermediateStopSelector.qml
@@ -26,13 +26,16 @@ Kirigami.OverlaySheet {
     ListView {
         id: stopSelector
         currentIndex: -1
-        delegate: Kirigami.BasicListItem {
+        delegate: QQC2.ItemDelegate {
             highlighted: ListView.isCurrentItem
-            text: {
-                if (modelData.scheduledDepartureTime.getTime()) {
-                    return Localizer.formatTime(modelData, "scheduledDepartureTime") + " " + modelData.stopPoint.name
+            width: ListView.view.width
+            contentItem: Kirigami.TitleSubtitle {
+                title: {
+                    if (modelData.scheduledDepartureTime.getTime()) {
+                        return Localizer.formatTime(modelData, "scheduledDepartureTime") + " " + modelData.stopPoint.name
+                    }
+                    return Localizer.formatTime(modelData, "scheduledArrivalTime") + " " + modelData.stopPoint.name
                 }
-                return Localizer.formatTime(modelData, "scheduledArrivalTime") + " " + modelData.stopPoint.name
             }
             enabled: modelData.disruptionEffect != Disruption.NoService
         }
diff --git a/src/app/PassPage.qml b/src/app/PassPage.qml
index 9caf517c1..1051bece0 100644
--- a/src/app/PassPage.qml
+++ b/src/app/PassPage.qml
@@ -38,45 +38,53 @@ Kirigami.ScrollablePage {
         role: "type"
         Models.DelegateChoice {
             roleValue: PassManager.ProgramMembership
-            Kirigami.BasicListItem {
+            QQC2.ItemDelegate {
                 highlighted: false
-                icon: "meeting-attending"
-                text: model.pass.programName
-                subtitle: {
-                    if (!model.pass.member.name)
-                        return model.pass.membershipNumber;
-                    if (!model.pass.membershipNumber)
-                        return model.pass.member.name;
-                    return i18nc("name - number", "%1 - %2", model.pass.member.name, model.pass.membershipNumber)
+                width: ListView.view.width
+                contentItem: Kirigami.IconTitleSubtitle {
+                    icon.name: "meeting-attending"
+                    title: model.pass.programName
+                    subtitle: {
+                        if (!model.pass.member.name)
+                            return model.pass.membershipNumber;
+                        if (!model.pass.membershipNumber)
+                            return model.pass.member.name;
+                        return i18nc("name - number", "%1 - %2", model.pass.member.name, model.pass.membershipNumber)
+                    }
                 }
                 onClicked: applicationWindow().pageStack.push(programMembershipPage, { programMembership: model.pass, passId: model.passId })
             }
         }
         Models.DelegateChoice {
             roleValue: PassManager.PkPass
-            Kirigami.BasicListItem {
+            QQC2.ItemDelegate {
                 readonly property string pkPassId: PkPassManager.passId(model.pass)
                 readonly property var pkPass: PkPassManager.pass(pkPassId)
                 highlighted: false
-                text: pkPass.description
-                subtitle: pkPass.organizationName
-                icon: pkPass.hasIcon ? "image://org.kde.pkpass/" + pkPassId + "/icon" : "bookmarks"
-                reserveSpaceForIcon: true
+                width: ListView.view.width
+                contentItem: Kirigami.IconTitleSubtitle {
+                    title: pkPass.description
+                    subtitle: pkPass.organizationName
+                    icon.name: pkPass.hasIcon ? "image://org.kde.pkpass/" + pkPassId + "/icon" : "bookmarks"
+                }
                 onClicked: applicationWindow().pageStack.push(pkpassComponent, { passId: pkPassId, pass: pkPass, genericPassId: model.passId });
             }
         }
         Models.DelegateChoice {
             roleValue: PassManager.Ticket
-            Kirigami.BasicListItem {
+            QQC2.ItemDelegate {
                 highlighted: false
-                icon: "bookmarks"
-                text: model.pass.name
-                subtitle: {
-                    if (model.pass.underName.name === "")
-                        return model.validRangeLabel;
-                    if (model.validRangeLabel === "")
-                        return model.pass.underName.name;
-                    return i18nc("name - valid time range", "%1 - %2", model.pass.underName.name, model.validRangeLabel);
+                width: ListView.view.width
+                contentItem: Kirigami.IconTitleSubtitle {
+                    icon.name: "bookmarks"
+                    title: model.pass.name
+                    subtitle: {
+                        if (model.pass.underName.name === "")
+                            return model.validRangeLabel;
+                        if (model.validRangeLabel === "")
+                            return model.pass.underName.name;
+                        return i18nc("name - valid time range", "%1 - %2", model.pass.underName.name, model.validRangeLabel);
+                    }
                 }
                 onClicked: applicationWindow().pageStack.push(ticketComponent, { ticket: model.pass, passId: model.passId })
             }
diff --git a/src/app/StopPickerPage.qml b/src/app/StopPickerPage.qml
index df692af62..5723f5b5d 100644
--- a/src/app/StopPickerPage.qml
+++ b/src/app/StopPickerPage.qml
@@ -141,8 +141,11 @@ Kirigami.ScrollablePage {
 
     Component {
         id: queryResultDelegate
-        Kirigami.BasicListItem {
-            text: model.location.name
+        QQC2.ItemDelegate {
+            width: ListView.view.width
+            contentItem: Kirigami.TitleSubtitle {
+                title: model.location.name
+            }
             onClicked: {
                 root.location = model.location
                 locationHistoryModel.addLocation(model.location);
-- 
GitLab


From 2c129b92fce2cebc6b69f40ae9666734fe2e6eec Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:17:23 +0100
Subject: [PATCH 05/36] Port to new icon name properties

---
 src/app/NavigationBar.qml | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/app/NavigationBar.qml b/src/app/NavigationBar.qml
index 54ae4692b..f6b6e7ef9 100644
--- a/src/app/NavigationBar.qml
+++ b/src/app/NavigationBar.qml
@@ -15,13 +15,13 @@ Kirigami.NavigationTabBar {
     visible: pageStack.layers.depth < 2
     actions: [
         Kirigami.PagePoolAction {
-            iconName: "format-list-unordered"
+            icon.name: "format-list-unordered"
             text: i18n("Itinerary")
             pagePool: pagepool
             page: Qt.resolvedUrl("TimelinePage.qml")
         },
         Kirigami.Action {
-            iconName: "search"
+            icon.name: "search"
             text: i18n("Plan Trip")
             onTriggered: {
                 if (pageStack.currentItem.objectName !== "JourneyRequestPage") {
@@ -30,7 +30,7 @@ Kirigami.NavigationTabBar {
             }
         },
         Kirigami.PagePoolAction {
-            iconName: "wallet-open"
+            icon.name: "wallet-open"
             text: i18n("Passes & Programs")
             pagePool: pagepool
             page: Qt.resolvedUrl("PassPage.qml")
-- 
GitLab


From 4a5385e92f45ead179614e6ee0cfecdf783c95f9 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:23:59 +0100
Subject: [PATCH 06/36] Adapt to Kirigami.OverlaySheet API changes

---
 src/app/IndoorMapAmenitySheet.qml    | 7 ++-----
 src/app/IndoorMapInfoSheet.qml       | 7 +------
 src/app/MatrixRoomSelectionSheet.qml | 7 ++-----
 3 files changed, 5 insertions(+), 16 deletions(-)

diff --git a/src/app/IndoorMapAmenitySheet.qml b/src/app/IndoorMapAmenitySheet.qml
index bd8f7ff9f..03a1ff042 100644
--- a/src/app/IndoorMapAmenitySheet.qml
+++ b/src/app/IndoorMapAmenitySheet.qml
@@ -21,7 +21,7 @@ Kirigami.OverlaySheet {
 
     ListView {
         model: AmenitySortFilterProxyModel {
-            sourceModel: amenitySheet.sheetOpen ? amenitySheet.model : null
+            sourceModel: amenitySheet.visible ? amenitySheet.model : null
             filterString: amenitySearchField.text
         }
         Layout.preferredWidth: Kirigami.Units.gridUnit * 25
@@ -49,8 +49,5 @@ Kirigami.OverlaySheet {
         focus: true
     }
 
-    onSheetOpenChanged: {
-        if (sheetOpen)
-            amenitySearchField.clear();
-    }
+    onOpened: amenitySearchField.clear()
 }
diff --git a/src/app/IndoorMapInfoSheet.qml b/src/app/IndoorMapInfoSheet.qml
index 76543c027..f97b0e499 100644
--- a/src/app/IndoorMapInfoSheet.qml
+++ b/src/app/IndoorMapInfoSheet.qml
@@ -146,10 +146,5 @@ Kirigami.OverlaySheet {
     }
     footer: Settings.osmContributorMode ? elementDetailsSheet.footerLoader.item : null
 
-    onSheetOpenChanged: {
-        console.log(elementDetailsSheet.model);
-        if (sheetOpen == false) {
-            elementDetailsSheet.model.clear()
-        }
-    }
+    onClosed: elementDetailsSheet.model.clear()
 }
diff --git a/src/app/MatrixRoomSelectionSheet.qml b/src/app/MatrixRoomSelectionSheet.qml
index eb8473f8c..a9a4ad2f6 100644
--- a/src/app/MatrixRoomSelectionSheet.qml
+++ b/src/app/MatrixRoomSelectionSheet.qml
@@ -20,7 +20,7 @@ Kirigami.OverlaySheet {
     ListView {
         model: KSortFilterProxyModel {
             // don't set the model right away, that seems to result in all delegates being instantiated before the sheet is even shown
-            sourceModel: sheet.sheetOpen ? MatrixController.roomsModel : null
+            sourceModel: sheet.visible ? MatrixController.roomsModel : null
             filterCaseSensitivity: Qt.CaseInsensitive
             filterString: searchField.text
         }
@@ -102,8 +102,5 @@ Kirigami.OverlaySheet {
         focus: true
     }
 
-    onSheetOpenChanged: {
-        if (sheetOpen)
-            searchField.clear();
-    }
+    onOpened: searchField.clear()
 }
-- 
GitLab


From 093bd8253fe823fd0b40e08a4c01cfc418d7bb45 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:26:33 +0100
Subject: [PATCH 07/36] Port away from QtGraphicalEffects

---
 src/app/EventTicket.qml | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/src/app/EventTicket.qml b/src/app/EventTicket.qml
index bd4516e7d..becaf2513 100644
--- a/src/app/EventTicket.qml
+++ b/src/app/EventTicket.qml
@@ -7,7 +7,7 @@
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
-import QtGraphicalEffects as Effects
+import QtQuick.Effects as Effects
 import org.kde.kirigami as Kirigami
 import org.kde.pkpass as KPkPass
 import org.kde.itinerary
@@ -41,10 +41,13 @@ Item {
             height: parent.implicitHeight
             width: root.implicitWidth
         }
-        Effects.FastBlur {
+        Effects.MultiEffect {
             anchors.fill: backgroundImage
             source: backgroundImage
-            radius: 32
+            autoPaddingEnabled: false
+            blurEnabled: true
+            blur: 1.0
+            blurMax: 32
         }
 
         ColumnLayout {
-- 
GitLab


From eac365abed9d052b9c254a32b0bc00951b48e8a5 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:30:30 +0100
Subject: [PATCH 08/36] Adapt to KSortFilterProxyModel API changes

---
 src/app/ActionsCard.qml    |  2 +-
 src/app/StopPickerPage.qml | 18 +++++++++---------
 2 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/src/app/ActionsCard.qml b/src/app/ActionsCard.qml
index 1416989e1..ab32f3a68 100644
--- a/src/app/ActionsCard.qml
+++ b/src/app/ActionsCard.qml
@@ -92,7 +92,7 @@ ColumnLayout {
     }
     KSortFilterProxyModel {
         id: writableCalendars
-        filterRole: "accessMode"
+        filterRoleName: "accessMode"
         filterString: KCalendarCore.KCalendarCore.ReadWrite
     }
     App.CalendarSelectionSheet {
diff --git a/src/app/StopPickerPage.qml b/src/app/StopPickerPage.qml
index 5723f5b5d..e2b956c15 100644
--- a/src/app/StopPickerPage.qml
+++ b/src/app/StopPickerPage.qml
@@ -35,23 +35,23 @@ Kirigami.ScrollablePage {
         Kirigami.Action {
             QQC2.ActionGroup.group: sortActionGroup
             checkable: true
-            checked: historySortModel.sortRole == "locationName"
+            checked: historySortModel.sortRoleName == "locationName"
             text: i18n("Sort by name")
-            onTriggered: historySortModel.sortRole = "locationName"
+            onTriggered: historySortModel.sortRoleName = "locationName"
         },
         Kirigami.Action {
             QQC2.ActionGroup.group: sortActionGroup
             checkable: true
-            checked: historySortModel.sortRole == "lastUsed"
+            checked: historySortModel.sortRoleName == "lastUsed"
             text: i18n("Most recently used")
-            onTriggered: historySortModel.sortRole = "lastUsed"
+            onTriggered: historySortModel.sortRoleName = "lastUsed"
         },
         Kirigami.Action {
             QQC2.ActionGroup.group: sortActionGroup
             checkable: true
-            checked: historySortModel.sortRole == "useCount"
+            checked: historySortModel.sortRoleName == "useCount"
             text: i18n("Most often used")
-            onTriggered: historySortModel.sortRole = "useCount"
+            onTriggered: historySortModel.sortRoleName = "useCount"
         }
     ]
     header: ColumnLayout {
@@ -109,9 +109,9 @@ Kirigami.ScrollablePage {
     KSortFilterProxyModel {
         id: historySortModel
         sourceModel: locationHistoryModel
-        sortRole: Settings.read("StopPicker/historySortMode", "lastUsed")
-        onSortRoleChanged: Settings.write("StopPicker/historySortMode", sortRole)
-        sortOrder: sortRole == "locationName" ? Qt.AscendingOrder : Qt.DescendingOrder
+        sortRoleName: Settings.read("StopPicker/historySortMode", "lastUsed")
+        onSortRoleChanged: Settings.write("StopPicker/historySortMode", sortRoleName)
+        sortOrder: sortRoleName == "locationName" ? Qt.AscendingOrder : Qt.DescendingOrder
     }
 
     Component {
-- 
GitLab


From 618a66cfd54e6175399bd8d01249a0077cc16736 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:35:28 +0100
Subject: [PATCH 09/36] Adapt barcode scanner to QtMultimedia API changes

---
 src/app/BarcodeScannerPage.qml | 29 ++++++++++++++---------------
 1 file changed, 14 insertions(+), 15 deletions(-)

diff --git a/src/app/BarcodeScannerPage.qml b/src/app/BarcodeScannerPage.qml
index 9e3f0212a..2f27f15f7 100644
--- a/src/app/BarcodeScannerPage.qml
+++ b/src/app/BarcodeScannerPage.qml
@@ -33,24 +33,22 @@ Kirigami.Page {
             icon.name: checked ? "flashlight-off" : "flashlight-on"
             text: i18n("Light")
             checkable: true
-            checked: camera.flash.mode == Camera.FlashVideoLight
-            visible: camera.flash.supportedModes.length > 1
-            onTriggered: camera.flash.mode = (camera.flash.mode == Camera.FlashVideoLight ? Camera.FlashOff : Camera.FlashVideoLight)
+            checked: camera.torchMode == Camera.TorchOn
+            visible: camera.isTorchModeSupported
+            onTriggered: camera.torchMode = (camera.torchMode == Camera.TorchOn ? Camera.TorchOff : Camera.TorchOn)
         }
     }
 
     VideoOutput {
         id: viewFinder
         anchors.fill: parent
-        source: camera
-        filters: [scanner]
-        autoOrientation: true
         fillMode: VideoOutput.PreserveAspectCrop
     }
 
     Prison.VideoScanner {
         id: scanner
         formats: Prison.Format.QRCode | Prison.Format.Aztec | Prison.Format.DataMatrix | Prison.Format.PDF417
+        videoSink: viewFinder.videoSink
         onResultContentChanged: {
             if (result.hasText && ApplicationController.importText(result.text)) {
                 applicationWindow().pageStack.goBack();
@@ -61,12 +59,13 @@ Kirigami.Page {
         }
     }
 
-    Camera {
-        id: camera
-        focus {
-            focusMode: Camera.FocusContinuous
-            focusPointMode: Camera.FocusPointCenter
+    CaptureSession {
+        id: captureSession
+        camera: Camera {
+            id: camera
+            active: true
         }
+        videoOutput: viewFinder
     }
 
     Rectangle {
@@ -77,10 +76,10 @@ Kirigami.Page {
         color: Qt.rgba(Kirigami.Theme.focusColor.r, Kirigami.Theme.focusColor.g, Kirigami.Theme.focusColor.b, 0.2);
         radius: Kirigami.Units.smallSpacing
 
-        x: viewFinder.mapRectToItem(scanner.result.boundingRect).x
-        y: viewFinder.mapRectToItem(scanner.result.boundingRect).y
-        width: viewFinder.mapRectToItem(scanner.result.boundingRect).width
-        height: viewFinder.mapRectToItem(scanner.result.boundingRect).height
+        x: viewFinder.contentRect.x + scanner.result.boundingRect.x / viewFinder.sourceRect.width * viewFinder.contentRect.width
+        y: viewFinder.contentRect.y + scanner.result.boundingRect.y / viewFinder.sourceRect.height * viewFinder.contentRect.height
+        width: scanner.result.boundingRect.width / viewFinder.sourceRect.width * viewFinder.contentRect.width
+        height: scanner.result.boundingRect.height / viewFinder.sourceRect.height * viewFinder.contentRect.height
     }
 
     BarcodeScanModeController {
-- 
GitLab


From ac61ae6d4fc75904b5d3bfd104a5c36338b289fb Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:45:11 +0100
Subject: [PATCH 10/36] Adapt to floating button API changes

---
 src/app/IndoorMapPage.qml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/app/IndoorMapPage.qml b/src/app/IndoorMapPage.qml
index a443208bf..229eab472 100644
--- a/src/app/IndoorMapPage.qml
+++ b/src/app/IndoorMapPage.qml
@@ -341,7 +341,7 @@ Kirigami.Page {
             bottomMargin: Kirigami.Units.largeSpacing + Kirigami.Units.smallSpacing // to not hide the copyright information
         }
 
-        leftAction: Kirigami.Action {
+        leadingAction: Kirigami.Action {
             icon.name: "go-down-symbolic"
             text: i18nc("@action:intoolbar Go down one floor", "Floor down")
             enabled: map.floorLevels.hasFloorLevelBelow(map.view.floorLevel)
@@ -349,7 +349,7 @@ Kirigami.Page {
             visible: map.floorLevels.hasFloorLevels
         }
 
-        rightAction: Kirigami.Action {
+        trailingAction: Kirigami.Action {
             icon.name: "go-up-symbolic"
             text: i18nc("@action:intoolbar Go up one floor", "Floor up")
             enabled: map.floorLevels.hasFloorLevelAbove(map.view.floorLevel)
-- 
GitLab


From 7fdd411a5bc9501b211b36b29c60b3ab449bc15b Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:45:42 +0100
Subject: [PATCH 11/36] Adapt to Kirigami.ApplicationWindow API changes

---
 src/app/main.qml              | 1 -
 tests/journeyquerytest.qml    | 1 -
 tests/pkpassviewer.qml        | 1 -
 tests/vehiclelayoutviewer.qml | 1 -
 4 files changed, 4 deletions(-)

diff --git a/src/app/main.qml b/src/app/main.qml
index ee2fcf46a..2c335656b 100644
--- a/src/app/main.qml
+++ b/src/app/main.qml
@@ -19,7 +19,6 @@ import "." as App
 Kirigami.ApplicationWindow {
     id: root
     title: i18n("KDE Itinerary")
-    reachableModeEnabled: false
 
     width: Kirigami.Settings.isMobile ? 480 : 800
     height: Kirigami.Settings.isMobile ? 720 : 650
diff --git a/tests/journeyquerytest.qml b/tests/journeyquerytest.qml
index 8fd3728e9..cd512eafe 100644
--- a/tests/journeyquerytest.qml
+++ b/tests/journeyquerytest.qml
@@ -13,7 +13,6 @@ import "." as App
 
 Kirigami.ApplicationWindow {
     title: "Journey Query Test"
-    reachableModeEnabled: false
 
     width: 480
     height: 720
diff --git a/tests/pkpassviewer.qml b/tests/pkpassviewer.qml
index 51bb675d0..04fa22dd5 100644
--- a/tests/pkpassviewer.qml
+++ b/tests/pkpassviewer.qml
@@ -12,7 +12,6 @@ import "." as App
 
 Kirigami.ApplicationWindow {
     title: "PkPass Viewer"
-    reachableModeEnabled: false
 
     width: 480
     height: 720
diff --git a/tests/vehiclelayoutviewer.qml b/tests/vehiclelayoutviewer.qml
index e9d654c8e..3c200eb49 100644
--- a/tests/vehiclelayoutviewer.qml
+++ b/tests/vehiclelayoutviewer.qml
@@ -13,7 +13,6 @@ import "." as App
 
 Kirigami.ApplicationWindow {
     title: "Vehicle Layout Viewer"
-    reachableModeEnabled: false
 
     width: 480
     height: 720
-- 
GitLab


From d79b334f7f95da1e93a1baa028abeb2768a7cc84 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:59:20 +0100
Subject: [PATCH 12/36] Fix various map sheet layout/clipping/padding issues

---
 src/app/IndoorMapAmenitySheet.qml                  |  2 ++
 src/app/IndoorMapInfoSheet.qml                     | 11 +++++++++--
 src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml |  3 ++-
 src/app/IndoorMapPlatformSheet.qml                 |  1 +
 4 files changed, 14 insertions(+), 3 deletions(-)

diff --git a/src/app/IndoorMapAmenitySheet.qml b/src/app/IndoorMapAmenitySheet.qml
index 03a1ff042..e373e56b0 100644
--- a/src/app/IndoorMapAmenitySheet.qml
+++ b/src/app/IndoorMapAmenitySheet.qml
@@ -24,6 +24,7 @@ Kirigami.OverlaySheet {
             sourceModel: amenitySheet.visible ? amenitySheet.model : null
             filterString: amenitySearchField.text
         }
+        clip:true
         Layout.preferredWidth: Kirigami.Units.gridUnit * 25
 
         delegate: IndoorMapAmenityDelegate {
@@ -41,6 +42,7 @@ Kirigami.OverlaySheet {
         section.property: "groupName"
         section.delegate: Kirigami.ListSectionHeader {
             label: section
+            width: ListView.view.width
         }
     }
 
diff --git a/src/app/IndoorMapInfoSheet.qml b/src/app/IndoorMapInfoSheet.qml
index f97b0e499..4e648fc25 100644
--- a/src/app/IndoorMapInfoSheet.qml
+++ b/src/app/IndoorMapInfoSheet.qml
@@ -35,11 +35,14 @@ Kirigami.OverlaySheet {
     ListView {
         id: contentView
         model: elementDetailsSheet.model
+        clip: true
         Layout.preferredWidth: Kirigami.Units.gridUnit * 25
 
         Component {
             id: infoStringDelegate
             RowLayout {
+                x: Kirigami.Units.largeSpacing
+                width: parent.ListView.view.width - 2 * x
                 QQC2.Label {
                     visible: row && row.keyLabel != ""
                     text: row ? row.keyLabel + ":" : ""
@@ -58,6 +61,8 @@ Kirigami.OverlaySheet {
         Component {
             id: infoLinkDelegate
             RowLayout {
+                x: Kirigami.Units.largeSpacing
+                width: parent.ListView.view.width - 2 * x
                 QQC2.Label {
                     visible: row && row.keyLabel != ""
                     text: row ? row.keyLabel + ":" : ""
@@ -77,6 +82,8 @@ Kirigami.OverlaySheet {
         Component {
             id: infoAddressDelegate
             QQC2.Label {
+                x: Kirigami.Units.largeSpacing
+                width: parent.ListView.view.width - 2 * x
                 text: row ? Localizer.formatAddress(row.value) : ""
             }
         }
@@ -84,6 +91,8 @@ Kirigami.OverlaySheet {
         Component {
             id: infoOpeningHoursDelegate
             IndoorMapInfoSheetOpeningHoursDelegate {
+                x: Kirigami.Units.largeSpacing
+                width: parent.ListView.view.width - 2 * x
                 mapData: elementDetailsSheet.mapData
                 model: row
             }
@@ -103,8 +112,6 @@ Kirigami.OverlaySheet {
 
         delegate: Loader {
             property var row: model
-            x: Kirigami.Units.largeSpacing
-            width: ListView.view.width - 2 * x
             sourceComponent: {
                 switch (row.type) {
                     case OSMElementInformationModel.Link:
diff --git a/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml b/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml
index 59c8f6055..b920ac7ab 100644
--- a/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml
+++ b/src/app/IndoorMapInfoSheetOpeningHoursDelegate.qml
@@ -5,12 +5,13 @@
 */
 
 import QtQuick
+import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kopeninghours
 import org.kde.itinerary
 
-Column {
+ColumnLayout {
     id: root
     property var model
     property var mapData
diff --git a/src/app/IndoorMapPlatformSheet.qml b/src/app/IndoorMapPlatformSheet.qml
index 61b606c67..11400a32e 100644
--- a/src/app/IndoorMapPlatformSheet.qml
+++ b/src/app/IndoorMapPlatformSheet.qml
@@ -84,6 +84,7 @@ Kirigami.OverlaySheet {
                 case Platform.Bus: return i18n("Bus");
                 default: return section;
             }
+            width: ListView.view.width
         }
         section.criteria: ViewSection.FullString
 
-- 
GitLab


From d9ffda3a0424d7dc37042d22d871e9a14c483f30 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:38:49 +0100
Subject: [PATCH 13/36] Implement input handling for QtLocation map manually

Necessary with Qt 6.
---
 src/app/MapView.qml | 38 ++++++++++++++++++++++++++++++++++++--
 1 file changed, 36 insertions(+), 2 deletions(-)

diff --git a/src/app/MapView.qml b/src/app/MapView.qml
index 9f74bb18d..889fb8a3c 100644
--- a/src/app/MapView.qml
+++ b/src/app/MapView.qml
@@ -5,13 +5,47 @@
 
 import QtQuick
 import QtQuick.Layouts
+import QtPositioning
 import QtLocation as QtLocation
 
+
 /** QtLocation map view with standard intercation settings. */
 QtLocation.Map {
     id: map
     plugin: applicationWindow().osmPlugin()
-    gesture.acceptedGestures: QtLocation.MapGestureArea.PinchGesture | QtLocation.MapGestureArea.PanGesture
-    gesture.preventStealing: true
     onCopyrightLinkActivated: Qt.openUrlExternally(link)
+
+    property geoCoordinate startCentroid
+    PinchHandler {
+        id: pinch
+        target: null
+        onActiveChanged: if (active) {
+            map.startCentroid = map.toCoordinate(pinch.centroid.position, false)
+        }
+        onScaleChanged: (delta) => {
+            map.zoomLevel += Math.log2(delta)
+            map.alignCoordinateToPoint(map.startCentroid, pinch.centroid.position)
+        }
+        grabPermissions: PointerHandler.TakeOverForbidden
+    }
+    WheelHandler {
+        id: wheel
+        rotationScale: 1/120
+        property: "zoomLevel"
+    }
+    DragHandler {
+        id: drag
+        target: null
+        onTranslationChanged: (delta) => map.pan(-delta.x, -delta.y)
+    }
+    Shortcut {
+        enabled: map.zoomLevel < map.maximumZoomLevel
+        sequence: StandardKey.ZoomIn
+        onActivated: map.zoomLevel = Math.round(map.zoomLevel + 1)
+    }
+    Shortcut {
+        enabled: map.zoomLevel > map.minimumZoomLevel
+        sequence: StandardKey.ZoomOut
+        onActivated: map.zoomLevel = Math.round(map.zoomLevel - 1)
+    }
 }
-- 
GitLab


From 93f8877d1e0e7c3993815a5be43cba32561a45a7 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 21:57:41 +0100
Subject: [PATCH 14/36] Fix public transport backend page section titles

---
 src/app/PublicTransportBackendPage.qml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/app/PublicTransportBackendPage.qml b/src/app/PublicTransportBackendPage.qml
index 779bdaecc..6e6a77664 100644
--- a/src/app/PublicTransportBackendPage.qml
+++ b/src/app/PublicTransportBackendPage.qml
@@ -96,8 +96,8 @@ Kirigami.ScrollablePage {
                         return c.emojiFlag + " " + c.name;
                 }
             }
+            width: ListView.view.width
         }
         section.criteria: ViewSection.FullString
-        section.labelPositioning: ViewSection.CurrentLabelAtStart | ViewSection.InlineLabels
     }
 }
-- 
GitLab


From 502f1dc9ed8327af1d4b170d075dd4b4b023e621 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 21:57:54 +0100
Subject: [PATCH 15/36] Fix QML type registration with Qt 6

---
 src/app/main.cpp | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

diff --git a/src/app/main.cpp b/src/app/main.cpp
index 191bd6701..f73ec003f 100644
--- a/src/app/main.cpp
+++ b/src/app/main.cpp
@@ -156,8 +156,8 @@ void registerKCalendarCoreTypes()
 
 void registerKPkPassTypes()
 {
-    qmlRegisterUncreatableType<KPkPass::Barcode>("org.kde.pkpass", 1, 0, "Barcode", {});
-    qmlRegisterUncreatableType<KPkPass::Field>("org.kde.pkpass", 1, 0, "Field", {});
+    qmlRegisterUncreatableMetaObject(KPkPass::Barcode::staticMetaObject, "org.kde.pkpass", 1, 0, "Barcode", {});
+    qmlRegisterUncreatableMetaObject(KPkPass::Field::staticMetaObject, "org.kde.pkpass", 1, 0, "Field", {});
     qmlRegisterUncreatableType<KPkPass::Pass>("org.kde.pkpass", 1, 0, "Pass", {});
     qmlRegisterUncreatableType<KPkPass::BoardingPass>("org.kde.pkpass", 1, 0, "BoardingPass", {});
 }
@@ -165,7 +165,7 @@ void registerKPkPassTypes()
 void registerKItineraryTypes()
 {
     qRegisterMetaType<KItinerary::KnowledgeDb::DrivingSide>();
-    qmlRegisterUncreatableType<KItinerary::Ticket>("org.kde.kitinerary", 1, 0, "Ticket", {});
+    qmlRegisterUncreatableMetaObject(KItinerary::Ticket::staticMetaObject, "org.kde.kitinerary", 1, 0, "Ticket", {});
     qmlRegisterUncreatableMetaObject(KItinerary::KnowledgeDb::staticMetaObject, "org.kde.kitinerary", 1, 0, "KnowledgeDb", {});
     qmlRegisterSingletonType("org.kde.itinerary", 1, 0, "PriceUtil", [](QQmlEngine*, QJSEngine *engine) -> QJSValue {
 #if KITINERARY_VERSION >= QT_VERSION_CHECK(5, 24, 41)
@@ -185,11 +185,11 @@ void registerApplicationTypes()
     qRegisterMetaType<Permission::Permission>();
     qRegisterMetaType<HealthCertificateManager*>();
 
-    qmlRegisterUncreatableType<LocationInformation>("org.kde.itinerary", 1, 0, "LocationInformation", {});
-    qmlRegisterUncreatableType<StatisticsItem>("org.kde.itinerary", 1, 0, "StatisticsItem", {});
-    qmlRegisterUncreatableType<TimelineElement>("org.kde.itinerary", 1, 0, "TimelineElement", {});
+    qmlRegisterUncreatableMetaObject(LocationInformation::staticMetaObject, "org.kde.itinerary", 1, 0, "LocationInformation", {});
+    qmlRegisterUncreatableMetaObject(StatisticsItem::staticMetaObject, "org.kde.itinerary", 1, 0, "StatisticsItem", {});
+    qmlRegisterUncreatableMetaObject(TimelineElement::staticMetaObject, "org.kde.itinerary", 1, 0, "TimelineElement", {});
     qmlRegisterUncreatableType<TimelineModel>("org.kde.itinerary", 1, 0, "TimelineModel", {});
-    qmlRegisterUncreatableType<Transfer>("org.kde.itinerary", 1, 0, "Transfer", {});
+    qmlRegisterUncreatableMetaObject(Transfer::staticMetaObject, "org.kde.itinerary", 1, 0, "Transfer", {});
 
     qmlRegisterUncreatableMetaObject(Permission::staticMetaObject, "org.kde.itinerary", 1, 0, "Permission", {});
 #if HAVE_MATRIX
-- 
GitLab


From 6d5e7650943a9891ae97d72dabc9056c6f38f8dc Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 22:30:04 +0100
Subject: [PATCH 16/36] Fix pass/programs page section headers

---
 src/app/PassPage.qml | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/app/PassPage.qml b/src/app/PassPage.qml
index 1051bece0..080568829 100644
--- a/src/app/PassPage.qml
+++ b/src/app/PassPage.qml
@@ -97,6 +97,7 @@ Kirigami.ScrollablePage {
         delegate: chooser
         section.delegate: Kirigami.ListSectionHeader {
             text: section
+            width: ListView.view.width
         }
         section.property: "section"
 
-- 
GitLab


From 418fb4af1a3d2d9f321ae0a63275bdf9d99eb232 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 22:37:05 +0100
Subject: [PATCH 17/36] Update about data to reflect reality

---
 src/app/AboutPage.qml | 2 +-
 src/app/main.cpp      | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/app/AboutPage.qml b/src/app/AboutPage.qml
index 1627d37c6..71b50e813 100644
--- a/src/app/AboutPage.qml
+++ b/src/app/AboutPage.qml
@@ -23,7 +23,7 @@ FormCard.AboutPage {
     data: ListModel {
         id: licenseModel
         ListElement {
-            name: "KDE Itinerary, KDE PIM and KDE Frameworks 5"
+            name: "KDE Itinerary, KDE PIM and KDE Frameworks 6"
             copyright: "© The KDE community"
             licenseId: "LGPL-2.0-or-later"
             licenseName: "GNU Library General Public License v2 or later"
diff --git a/src/app/main.cpp b/src/app/main.cpp
index f73ec003f..217e832c4 100644
--- a/src/app/main.cpp
+++ b/src/app/main.cpp
@@ -354,7 +354,7 @@ int main(int argc, char **argv)
     aboutData.setLicense(KAboutLicense::LGPL_V2, KAboutLicense::OrLaterVersions);
     aboutData.setHomepage(QStringLiteral("https://apps.kde.org/itinerary"));
     aboutData.setShortDescription(i18n("Digital Travel Assistant"));
-    aboutData.setCopyrightStatement(i18n("Copyright © 2018-%1 The KDE Community", QStringLiteral("2022")));
+    aboutData.setCopyrightStatement(i18n("Copyright © The KDE Community"));
     aboutData.setDesktopFileName(QStringLiteral("org.kde.itinerary"));
     KAboutData::setApplicationData(aboutData);
 
-- 
GitLab


From e47279d825da3b53f6007bacba964a68d50638da Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 23:13:16 +0100
Subject: [PATCH 18/36] Adapt to ListView behavior changes

---
 src/app/TimelineDelegate.qml        | 2 +-
 src/app/TimelinePage.qml            | 2 +-
 src/app/TransferDelegate.qml        | 2 +-
 src/app/TripGroupDelegate.qml       | 2 +-
 src/app/WeatherForecastDelegate.qml | 2 +-
 src/app/WeatherForecastPage.qml     | 2 +-
 6 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/src/app/TimelineDelegate.qml b/src/app/TimelineDelegate.qml
index 47e216cdc..13b0c3c6e 100644
--- a/src/app/TimelineDelegate.qml
+++ b/src/app/TimelineDelegate.qml
@@ -14,7 +14,7 @@ import "." as App
 
 FormCard.FormCard {
     id: root
-    width: parent.width
+    width: ListView.view.width
     /** Reservation batch identifier (@see ReservationManager). */
     property alias batchId: _controller.batchId
     /** All reservations that are part of this patch. */
diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index 263f52193..8c2aff6f4 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -395,7 +395,7 @@ Kirigami.ScrollablePage {
         Models.DelegateChoice {
             roleValue: TimelineElement.TodayMarker
             RowLayout {
-                width: parent.width
+                width: ListView.view.width
                 Item{ Layout.fillWidth: true }
                 QQC2.Label {
                     Layout.maximumWidth: Kirigami.Units.gridUnit * 30
diff --git a/src/app/TransferDelegate.qml b/src/app/TransferDelegate.qml
index 664e4774f..99374dc70 100644
--- a/src/app/TransferDelegate.qml
+++ b/src/app/TransferDelegate.qml
@@ -15,7 +15,7 @@ import "." as App
 
 FormCard.FormCard {
     id: root
-    width: parent.width
+    width: ListView.view.width
 
     required property var transfer
     property bool journeyDetailsExpanded: false
diff --git a/src/app/TripGroupDelegate.qml b/src/app/TripGroupDelegate.qml
index 5aa8a34e5..9b9320e47 100644
--- a/src/app/TripGroupDelegate.qml
+++ b/src/app/TripGroupDelegate.qml
@@ -15,7 +15,7 @@ import "." as App
 
 FormCard.FormCard {
     id: root
-    width: parent.width
+    width: ListView.view.width
 
     required property var tripGroup
     required property string tripGroupId
diff --git a/src/app/WeatherForecastDelegate.qml b/src/app/WeatherForecastDelegate.qml
index f968c791a..61c087693 100644
--- a/src/app/WeatherForecastDelegate.qml
+++ b/src/app/WeatherForecastDelegate.qml
@@ -15,7 +15,7 @@ import "." as App
 
 FormCard.FormCard {
     id: root
-    width: parent.width
+    width: ListView.view.width
     required property var weatherInformation
     readonly property var weatherForecast: weatherInformation.forecast
 
diff --git a/src/app/WeatherForecastPage.qml b/src/app/WeatherForecastPage.qml
index d8a46e2e8..0b7ae92dc 100644
--- a/src/app/WeatherForecastPage.qml
+++ b/src/app/WeatherForecastPage.qml
@@ -56,7 +56,7 @@ Kirigami.ScrollablePage {
             required property string localizedTime
 
             highlighted: false
-            width: parent.width
+            width: ListView.view.width
 
             background: Rectangle {
                 color: weatherForecast.isSevere ? Kirigami.Theme.negativeBackgroundColor : Kirigami.Theme.backgroundColor
-- 
GitLab


From 5afc24d41e0cd00853f7b41b3145b63ccaf14dc8 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sun, 17 Dec 2023 12:44:37 +0100
Subject: [PATCH 19/36] Port away from Qt.labs.platform

---
 CMakeLists.txt                   |  3 ---
 src/app/ActionsCard.qml          | 11 ++++++-----
 src/app/DevelopmentModePage.qml  |  7 ++++---
 src/app/DocumentsCard.qml        |  7 ++++---
 src/app/FavoriteLocationPage.qml | 19 ++++++++++---------
 src/app/TimelinePage.qml         | 19 ++++++++++---------
 src/app/main.qml                 | 11 ++++++-----
 7 files changed, 40 insertions(+), 37 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 761771ab4..28cd5399f 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -102,9 +102,6 @@ ecm_find_qmlmodule(org.kde.prison 1.0)
 ecm_find_qmlmodule(org.kde.prison.scanner 1.0)
 ecm_find_qmlmodule(org.kde.kosmindoormap 1.0)
 ecm_find_qmlmodule(org.kde.kopeninghours 1.0)
-if (NOT ANDROID)
-    ecm_find_qmlmodule(Qt.labs.platform 1.0)
-endif()
 
 # runtime dependencies are build-time dependencies on Android
 if (ANDROID)
diff --git a/src/app/ActionsCard.qml b/src/app/ActionsCard.qml
index ab32f3a68..779d9fcc8 100644
--- a/src/app/ActionsCard.qml
+++ b/src/app/ActionsCard.qml
@@ -2,10 +2,11 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
+import QtCore
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
-import Qt.labs.platform as Platform
+import QtQuick.Dialogs
 import internal.org.kde.kcalendarcore as KCalendarCore
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
@@ -161,13 +162,13 @@ ColumnLayout {
                 deviceModel.refresh();
         }
     }
-    Platform.FileDialog {
+    FileDialog {
         id: batchFileExportDialog
-        fileMode: Platform.FileDialog.SaveFile
+        fileMode: FileDialog.SaveFile
         title: i18n("Export Reservation")
-        folder: Platform.StandardPaths.writableLocation(Platform.StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: [i18n("Itinerary file (*.itinerary)")]
-        onAccepted: ApplicationController.exportBatchToFile(root.batchId, file)
+        onAccepted: ApplicationController.exportBatchToFile(root.batchId, selectedFile)
     }
 
     FormCard.FormHeader {
diff --git a/src/app/DevelopmentModePage.qml b/src/app/DevelopmentModePage.qml
index b5efd96d2..940fcfb27 100644
--- a/src/app/DevelopmentModePage.qml
+++ b/src/app/DevelopmentModePage.qml
@@ -4,10 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
+import QtCore
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
-import Qt.labs.platform
+import QtQuick.Dialogs
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
 
@@ -18,9 +19,9 @@ Kirigami.ScrollablePage {
     FileDialog {
         id: mapcssDialog
         title: "Import MapCSS"
-        folder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: ["MapCSS style sheets (*.mapcss)"]
-        onAccepted: DevelopmentModeController.importMapCSS(file)
+        onAccepted: DevelopmentModeController.importMapCSS(selectedFile)
     }
 
     ColumnLayout {
diff --git a/src/app/DocumentsCard.qml b/src/app/DocumentsCard.qml
index 24176a26d..9dab5fb27 100644
--- a/src/app/DocumentsCard.qml
+++ b/src/app/DocumentsCard.qml
@@ -4,10 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
+import QtCore
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
-import Qt.labs.platform
+import QtQuick.Dialogs
 import org.kde.kirigami as Kirigami
 import org.kde.kitinerary
 import org.kde.itinerary
@@ -33,9 +34,9 @@ ColumnLayout {
     FileDialog {
         id: addDialog
         title: i18n("Add Document")
-        folder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: [i18n("All Files (*.*)")]
-        onAccepted: root.addDocument(file)
+        onAccepted: root.addDocument(selectedFile)
     }
 
     Component {
diff --git a/src/app/FavoriteLocationPage.qml b/src/app/FavoriteLocationPage.qml
index cadea6146..e295f4931 100644
--- a/src/app/FavoriteLocationPage.qml
+++ b/src/app/FavoriteLocationPage.qml
@@ -4,10 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
+import QtCore
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
-import Qt.labs.platform as Platform
+import QtQuick.Dialogs
 import QtLocation as QtLocation
 import QtPositioning
 import org.kde.kirigami as Kirigami
@@ -30,21 +31,21 @@ Kirigami.Page {
 
     }
 
-    Platform.FileDialog {
+    FileDialog {
         id: favoriteGpxExportDialog
-        fileMode: Platform.FileDialog.SaveFile
+        fileMode: FileDialog.SaveFile
         title: i18n("Export Favorite Locations")
-        folder: Platform.StandardPaths.writableLocation(Platform.StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: [i18n("GPX Files (*.gpx)")]
-        onAccepted: FavoriteLocationModel.exportToGpx(file)
+        onAccepted: FavoriteLocationModel.exportToGpx(selectedFile)
     }
-    Platform.FileDialog {
+    FileDialog {
         id: favoriteGpxImportDialog
-        fileMode: Platform.FileDialog.OpenFile
+        fileMode: FileDialog.OpenFile
         title: i18n("Import Favorite Locations")
-        folder: Platform.StandardPaths.writableLocation(Platform.StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: [i18n("GPX Files (*.gpx)")]
-        onAccepted: FavoriteLocationModel.importFromGpx(file)
+        onAccepted: FavoriteLocationModel.importFromGpx(selectedFile)
     }
 
     actions: [
diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index 8c2aff6f4..c7b87eb5f 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -4,11 +4,12 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
+import QtCore
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import Qt.labs.qmlmodels as Models
-import Qt.labs.platform as Platform
+import QtQuick.Dialogs
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
 import "." as App
@@ -216,23 +217,23 @@ Kirigami.ScrollablePage {
                 deviceModel.refresh();
         }
     }
-    Platform.FileDialog {
+    FileDialog {
         id: tripGroupFileExportDialog
         property string tripGroupId
-        fileMode: Platform.FileDialog.SaveFile
+        fileMode: FileDialog.SaveFile
         title: i18n("Export Trip")
-        folder: Platform.StandardPaths.writableLocation(Platform.StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: [i18n("Itinerary file (*.itinerary)")]
-        onAccepted: ApplicationController.exportTripToFile(tripGroupId, file)
+        onAccepted: ApplicationController.exportTripToFile(tripGroupId, selectedFile)
     }
-    Platform.FileDialog {
+    FileDialog {
         id: tripGroupGpxExportDialog
         property string tripGroupId
-        fileMode: Platform.FileDialog.SaveFile
+        fileMode: FileDialog.SaveFile
         title: i18n("Export Trip")
-        folder: Platform.StandardPaths.writableLocation(Platform.StandardPaths.DocumentsLocation)
+        currentFolder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
         nameFilters: [i18n("GPX Files (*.gpx)")]
-        onAccepted: ApplicationController.exportTripToGpx(tripGroupId, file)
+        onAccepted: ApplicationController.exportTripToGpx(tripGroupId, selectedFile)
     }
 
     Component {
diff --git a/src/app/main.qml b/src/app/main.qml
index 2c335656b..bb0697efb 100644
--- a/src/app/main.qml
+++ b/src/app/main.qml
@@ -4,10 +4,11 @@
     SPDX-License-Identifier: LGPL-2.0-or-later
 */
 
+import QtCore as QtCore
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
-import Qt.labs.platform
+import QtQuick.Dialogs
 import QtLocation as QtLocation
 import org.kde.kirigami as Kirigami
 import org.kde.solidextras as Solid
@@ -116,18 +117,18 @@ Kirigami.ApplicationWindow {
         id: importFileDialog
         fileMode: FileDialog.OpenFile
         title: i18n("Import Reservation")
-        folder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
+        currentFolder: QtCore.StandardPaths.writableLocation(QtCore.StandardPaths.DocumentsLocation)
         nameFilters: [i18n("All Files (*.*)"), i18n("PkPass files (*.pkpass)"), i18n("PDF files (*.pdf)"), i18n("KDE Itinerary files (*.itinerary)")]
-        onAccepted: ApplicationController.importFromUrl(file)
+        onAccepted: ApplicationController.importFromUrl(selectedFile)
     }
 
     FileDialog {
         id: exportDialog
         fileMode: FileDialog.SaveFile
         title: i18n("Export Itinerary Data")
-        folder: StandardPaths.writableLocation(StandardPaths.DocumentsLocation)
+        currentFolder: QtCore.StandardPaths.writableLocation(QtCore.StandardPaths.DocumentsLocation)
         nameFilters: [i18n("KDE Itinerary files (*.itinerary)")]
-        onAccepted: ApplicationController.exportToFile(file)
+        onAccepted: ApplicationController.exportToFile(selectedFile)
     }
 
     Component {
-- 
GitLab


From 77af5af0828f13cba303f8ac1c71e3ab886b9f00 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sun, 17 Dec 2023 13:05:10 +0100
Subject: [PATCH 20/36] Port APK build to Qt 6

---
 CMakeLists.txt                                |  1 +
 src/app/CMakeLists.txt                        |  1 +
 src/app/android/AndroidManifest.xml           |  2 +-
 src/app/android/build.gradle                  | 40 +++++--------------
 .../src/org/kde/itinerary/Activity.java       |  2 +-
 5 files changed, 13 insertions(+), 33 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 28cd5399f..d723dd37f 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -26,6 +26,7 @@ include(KDECMakeSettings)
 include(GenerateExportHeader)
 include(ECMQmlModule)
 include(ECMDeprecationSettings)
+include(ECMAddAndroidApk)
 
 set(CMAKE_CXX_STANDARD 17)
 set(CMAKE_AUTOMOC ON)
diff --git a/src/app/CMakeLists.txt b/src/app/CMakeLists.txt
index 1640ae4e8..d546f6a34 100644
--- a/src/app/CMakeLists.txt
+++ b/src/app/CMakeLists.txt
@@ -241,6 +241,7 @@ if (ANDROID)
         weather-storm
     )
 
+    ecm_add_android_apk(itinerary-app ANDROID_DIR ${CMAKE_CURRENT_SOURCE_DIR}/android)
     install(FILES sc-apps-org.kde.itinerary.svg  DESTINATION ${KDE_INSTALL_QMLDIR}/org/kde/kirigami.2/icons/ RENAME org.kde.itinerary.svg)
 else ()
     target_link_libraries(itinerary PRIVATE Qt::Positioning Qt::DBus Qt::Widgets)
diff --git a/src/app/android/AndroidManifest.xml b/src/app/android/AndroidManifest.xml
index 61d9c3125..65f607f80 100644
--- a/src/app/android/AndroidManifest.xml
+++ b/src/app/android/AndroidManifest.xml
@@ -23,7 +23,7 @@
     <uses-permission android:name="android.permission.POST_NOTIFICATIONS"/> <!-- for Android >= 33 -->
     <!-- %%INSERT_FEATURES -->
 
-    <application android:name="org.qtproject.qt5.android.bindings.QtApplication" android:label="@string/application_name_full" android:icon="@mipmap/ic_launcher">
+    <application android:name="org.qtproject.qt.android.bindings.QtApplication" android:label="@string/application_name_full" android:icon="@mipmap/ic_launcher">
         <activity android:configChanges="orientation|uiMode|screenLayout|screenSize|smallestScreenSize|layoutDirection|locale|fontScale|keyboard|keyboardHidden|navigation"
                   android:name="org.kde.itinerary.Activity"
                   android:label="@string/application_name_short"
diff --git a/src/app/android/build.gradle b/src/app/android/build.gradle
index c4b2ed952..c03f8f53b 100644
--- a/src/app/android/build.gradle
+++ b/src/app/android/build.gradle
@@ -12,7 +12,7 @@ buildscript {
     }
 
     dependencies {
-        classpath 'com.android.tools.build:gradle:7.0.2'
+        classpath 'com.android.tools.build:gradle:7.4.1'
     }
 }
 
@@ -36,7 +36,7 @@ android {
      * The following variables:
      * - androidBuildToolsVersion,
      * - androidCompileSdkVersion
-     * - qt5AndroidDir - holds the path to qt android files
+     * - qtAndroidDir - holds the path to qt android files
      *                   needed to build any Qt application
      *                   on Android.
      *
@@ -45,17 +45,19 @@ android {
      * Changing them manually might break the compilation!
      *******************************************************/
 
-    compileSdkVersion androidCompileSdkVersion.toInteger()
-
+    compileSdkVersion androidCompileSdkVersion
     buildToolsVersion androidBuildToolsVersion
     ndkVersion androidNdkVersion
 
+    // Extract native libraries from the APK
+    packagingOptions.jniLibs.useLegacyPackaging true
+
     sourceSets {
         main {
             manifest.srcFile 'AndroidManifest.xml'
-            java.srcDirs = [qt5AndroidDir + '/src', 'src', 'java']
-            aidl.srcDirs = [qt5AndroidDir + '/src', 'src', 'aidl']
-            res.srcDirs = [qt5AndroidDir + '/res', 'res']
+            java.srcDirs = [qtAndroidDir + '/src', 'src', 'java']
+            aidl.srcDirs = [qtAndroidDir + '/src', 'src', 'aidl']
+            res.srcDirs = [qtAndroidDir + '/res', 'res']
             resources.srcDirs = ['src']
             renderscript.srcDirs = ['src']
             assets.srcDirs = ['assets']
@@ -81,28 +83,4 @@ android {
         versionName projectVersionFull
         manifestPlaceholders = [versionName: projectVersionFull, versionCode: timestamp]
     }
-
-    packagingOptions {
-        exclude 'lib/*/*_Controls.2_Fusion_*'
-        exclude 'lib/*/*_Controls.2_Imagine_*'
-        exclude 'lib/*/*RemoteObjects*'
-        exclude 'lib/*/*StateMachine*'
-        exclude 'lib/*/*_audio_*'
-        exclude 'lib/*/*_imageformats_qico_*'
-        exclude 'lib/*/*_imageformats_qicns_*'
-        exclude 'lib/*/*_imageformats_qtga_*'
-        exclude 'lib/*/*_imageformats_qtiff_*'
-        exclude 'lib/*/*_playlistformats_*'
-        exclude 'lib/*/*_qmltooling_*'
-        exclude 'lib/*/*_qtgeoservices_esri_*'
-        exclude 'lib/*/*_qtgeoservices_mapbox_*'
-        exclude 'lib/*/*_qtgeoservices_nokia_*'
-        exclude 'lib/*/*_texttospeech_*'
-    }
-
-    aaptOptions {
-        // different syntax than above
-        // see https://android.googlesource.com/platform/frameworks/base/+/refs/heads/pie-release/tools/aapt2/util/Files.h#90
-        ignoreAssetsPattern '!<dir>ECM:!<dir>aclocal:!<dir>doc:!<dir>fonts:!<dir>gtk-doc:!<dir>man:!<dir>mime:!<dir>ndk-modules:!<dir>pkgconfig:!<dir>qlogging-categories5:!<dir>qt5keychain:!<dir>sr@ijekavian:!<dir>sr@ijekavianlatin:!<dir>plugins:!<file>iso_15924.mo:!<file>iso_3166.mo:!<file>iso_3166_2.mo:<file>iso_3166-3.mo:!<file>iso_4217.mo:!<file>iso_639.mo:!<file>iso_639-2.mo:!<file>iso_639-3.mo:!<file>iso_639_3.mo:!<file>iso_639-5.mo:!<file>iso_639_5.mo:!<file>kcodecs5_qt.qm:!<file>kde5_xml_mimetypes.qm:!<file>karchive5_qt.qm:!<file>kcontacts5.mo:!<file>knotifications5_qt.qm:!<file>libkholidays5_qt.qm:!<file>libkmime5.mo:!<file>iso_15924.json:!<file>iso_3166-3.json:!<file>iso_4217.json:!<file>iso_639-2.json:!<file>iso_639-3.json:!<file>iso_639-5.json:!<file>schema-15924.json:!<file>schema-3166-1.json:!<file>schema-3166-2.json:!<file>schema-3166-3.json:!<file>schema-4217.json:!<file>schema-639-2.json:!<file>schema-639-3.json:!<file>schema-639-5.json'
-    }
 }
diff --git a/src/app/android/src/org/kde/itinerary/Activity.java b/src/app/android/src/org/kde/itinerary/Activity.java
index 34c8625fd..57f289b0d 100644
--- a/src/app/android/src/org/kde/itinerary/Activity.java
+++ b/src/app/android/src/org/kde/itinerary/Activity.java
@@ -6,7 +6,7 @@
 
 package org.kde.itinerary;
 
-import org.qtproject.qt5.android.bindings.QtActivity;
+import org.qtproject.qt.android.bindings.QtActivity;
 
 import androidx.core.content.FileProvider;
 
-- 
GitLab


From 924ac8f6e360d30839ba55b3a09a5eea663c0e0a Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sun, 17 Dec 2023 14:44:04 +0100
Subject: [PATCH 21/36] Adapt icon bundling to KF6 changes

---
 src/app/CMakeLists.txt | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/app/CMakeLists.txt b/src/app/CMakeLists.txt
index d546f6a34..8f6fcbbc5 100644
--- a/src/app/CMakeLists.txt
+++ b/src/app/CMakeLists.txt
@@ -186,6 +186,7 @@ if (ANDROID)
         go-up-symbolic
         help-about-symbolic
         help-contents
+        license
         list-add
         mail-message-new
         media-playback-playing
@@ -201,6 +202,7 @@ if (ANDROID)
         temperature-normal
         temperature-warm
         view-barcode-qr
+        view-calendar
         view-calendar-day
         view-list-symbolic
         view-list-details
@@ -242,7 +244,7 @@ if (ANDROID)
     )
 
     ecm_add_android_apk(itinerary-app ANDROID_DIR ${CMAKE_CURRENT_SOURCE_DIR}/android)
-    install(FILES sc-apps-org.kde.itinerary.svg  DESTINATION ${KDE_INSTALL_QMLDIR}/org/kde/kirigami.2/icons/ RENAME org.kde.itinerary.svg)
+    install(FILES sc-apps-org.kde.itinerary.svg  DESTINATION ${KDE_INSTALL_QMLDIR}/org/kde/kirigami/breeze-internal/icons/ RENAME org.kde.itinerary.svg)
 else ()
     target_link_libraries(itinerary PRIVATE Qt::Positioning Qt::DBus Qt::Widgets)
     target_link_libraries(itinerary-app PRIVATE
-- 
GitLab


From 352a03d4f22f84f3dee4003fd928704aa3fd6656 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sun, 17 Dec 2023 13:19:54 +0100
Subject: [PATCH 22/36] Switch to Breeze style on Android

Looks much better than the in some places weirdly colored Material style,
and thanks to changes in KF6 no longer pulls in an unreasonably heavy
QtWidgets dependency.
---
 src/app/main.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/app/main.cpp b/src/app/main.cpp
index 217e832c4..2ec7ca56d 100644
--- a/src/app/main.cpp
+++ b/src/app/main.cpp
@@ -335,7 +335,7 @@ int main(int argc, char **argv)
 #endif
 #ifdef Q_OS_ANDROID
     QGuiApplication app(argc, argv);
-    QQuickStyle::setStyle(QStringLiteral("Material"));
+    QQuickStyle::setStyle(QStringLiteral("org.kde.breeze"));
 #else
     QIcon::setFallbackThemeName(QStringLiteral("breeze"));
     QApplication app(argc, argv); // for native file dialogs
-- 
GitLab


From 5ff0f744b6abfe49ee8ab48dd284e38cb3b87b7b Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 22:19:09 +0100
Subject: [PATCH 23/36] Switch to Breeze style on Android

Looks much better than the in some places weirdly colored Material style,
and thanks to changes in KF6 no longer pulls in an unreasonably heavy
QtWidgets dependency.
---
 src/app/qml.qrc                       | 2 --
 src/app/qtquickcontrols2.conf         | 4 ----
 src/app/qtquickcontrols2.conf.license | 2 --
 3 files changed, 8 deletions(-)
 delete mode 100644 src/app/qtquickcontrols2.conf
 delete mode 100644 src/app/qtquickcontrols2.conf.license

diff --git a/src/app/qml.qrc b/src/app/qml.qrc
index 1bd09da62..8ba9186db 100644
--- a/src/app/qml.qrc
+++ b/src/app/qml.qrc
@@ -4,8 +4,6 @@
 -->
 <RCC>
     <qresource prefix="/">
-        <file>qtquickcontrols2.conf</file>
-
         <file>main.qml</file>
         <file>AboutPage.qml</file>
         <file>ActionsCard.qml</file>
diff --git a/src/app/qtquickcontrols2.conf b/src/app/qtquickcontrols2.conf
deleted file mode 100644
index fb79f068e..000000000
--- a/src/app/qtquickcontrols2.conf
+++ /dev/null
@@ -1,4 +0,0 @@
-[Material]
-Primary=Blue
-Accent=Blue
-Theme=System
diff --git a/src/app/qtquickcontrols2.conf.license b/src/app/qtquickcontrols2.conf.license
deleted file mode 100644
index 23c184917..000000000
--- a/src/app/qtquickcontrols2.conf.license
+++ /dev/null
@@ -1,2 +0,0 @@
-SPDX-License-Identifier: CC0-1.0
-SPDX-FileCopyrightText: none
-- 
GitLab


From 30346d05ba102fcc46c733aeb36ccc5e863a3072 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 22:19:42 +0100
Subject: [PATCH 24/36] Fix Matrix room selection sheet

---
 src/app/FormPlaceDelegate.qml        | 1 +
 src/app/MatrixRoomSelectionSheet.qml | 2 ++
 2 files changed, 3 insertions(+)

diff --git a/src/app/FormPlaceDelegate.qml b/src/app/FormPlaceDelegate.qml
index 17c35e387..0e78a12ec 100644
--- a/src/app/FormPlaceDelegate.qml
+++ b/src/app/FormPlaceDelegate.qml
@@ -39,6 +39,7 @@ FormCard.AbstractFormDelegate {
     }
 
     MatrixRoomSelectionSheet {
+        parent: applicationWindow().overlay
         id: matrixRoomSheet
             onRoomSelected: {
             console.log(room);
diff --git a/src/app/MatrixRoomSelectionSheet.qml b/src/app/MatrixRoomSelectionSheet.qml
index a9a4ad2f6..57d648c57 100644
--- a/src/app/MatrixRoomSelectionSheet.qml
+++ b/src/app/MatrixRoomSelectionSheet.qml
@@ -18,6 +18,7 @@ Kirigami.OverlaySheet {
 
     header: Kirigami.Heading { text: i18n("Share Location") }
     ListView {
+        clip: true
         model: KSortFilterProxyModel {
             // don't set the model right away, that seems to result in all delegates being instantiated before the sheet is even shown
             sourceModel: sheet.visible ? MatrixController.roomsModel : null
@@ -38,6 +39,7 @@ Kirigami.OverlaySheet {
                         case MatrixRoomsModel.Space: return i18nc("matrix room type", "Spaces");
                     }
                 }
+                width: ListView.view.width
             }
         }
 
-- 
GitLab


From 7ad1c03aef98a60e5d3a3ca0274fc05e74cd61bb Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Mon, 18 Dec 2023 17:15:06 +0100
Subject: [PATCH 25/36] Use Image rather than Icon for platform sheet line
 logos

All of those are files and not icons, so this is an easy way to bypass
the aspect ratio scaling issues in Icon here.
---
 src/app/IndoorMapPlatformSheet.qml | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/app/IndoorMapPlatformSheet.qml b/src/app/IndoorMapPlatformSheet.qml
index 11400a32e..515caf66c 100644
--- a/src/app/IndoorMapPlatformSheet.qml
+++ b/src/app/IndoorMapPlatformSheet.qml
@@ -33,6 +33,7 @@ Kirigami.OverlaySheet {
                 contentItem: Row {
                     spacing: Kirigami.Units.smallSpacing
                     QQC2.Label {
+                        id: label
                         text: {
                             if (platform.isDeparturePlatform && platform.isArrivalPlatform)
                                 return i18nc("train arrival/departure platform", "%1 (arrival/departure)", platform.display);
@@ -46,9 +47,10 @@ Kirigami.OverlaySheet {
 
                     Repeater {
                         model: platform.lines
-                        delegate: Kirigami.Icon {
+                        delegate: Image {
                             height: Kirigami.Units.iconSizes.small
-                            width: implicitWidth
+                            width: Math.round(Kirigami.Units.iconSizes.small * implicitWidth / implicitHeight)
+                            anchors.verticalCenter: label.verticalCenter
                             visible: source != ""
                             source: {
                                 switch (platform.mode) {
-- 
GitLab


From 251657591bcc361424de77176dd127f476fef31a Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 20:21:33 +0100
Subject: [PATCH 26/36] Port date/time inputs

---
 src/app/FormDateTimeEditDelegate.qml | 61 ++--------------------------
 src/app/JourneyRequestPage.qml       | 20 +++------
 2 files changed, 10 insertions(+), 71 deletions(-)

diff --git a/src/app/FormDateTimeEditDelegate.qml b/src/app/FormDateTimeEditDelegate.qml
index e7f420301..6e21c4f62 100644
--- a/src/app/FormDateTimeEditDelegate.qml
+++ b/src/app/FormDateTimeEditDelegate.qml
@@ -7,76 +7,23 @@ import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
-import org.kde.kirigamiaddons.dateandtime as Addon
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
 import "." as App
 
-// TODO KF6 replace with FormCard.FormDateTimeDelegate
-FormCard.AbstractFormDelegate {
+FormCard.FormDateTimeDelegate {
     id: root
 
     property variant obj
     property string propertyName
-    property date value: Util.dateTimeStripTimezone(obj, propertyName)
+    value: Util.dateTimeStripTimezone(obj, propertyName)
     readonly property bool hasValue: !isNaN(value.getTime())
     property bool isModified: Util.dateTimeStripTimezone(obj, propertyName).getTime() != value.getTime()
-    property date initialValue: {
+    // TODO this is not used with KF6 yet!
+    initialValue: {
         let d = new Date();
         d.setTime(d.getTime() + 60 * 60 * 1000 - (d.getTime() % (60 * 60 * 1000)));
         return d;
     }
-
-    // input validation, as in FormTextFieldDelegate
-    property var status: Kirigami.MessageType.Information
-    property string statusMessage: ""
-
-    contentItem: ColumnLayout {
-        spacing: Kirigami.Units.smallSpacing
-        QQC2.Label {
-            Layout.fillWidth: true
-            elide: Text.ElideRight
-            text: root.text
-            Accessible.ignored: true
-        }
-        Addon.DateInput {
-            id: dateInput
-            selectedDate: root.value
-            onSelectedDateChanged: root.updateValue()
-            visible: root.hasValue
-        }
-        Addon.TimeInput {
-            id: timeInput
-            value: root.value
-            onValueChanged: root.updateValue()
-            visible: root.hasValue
-        }
-        QQC2.ToolButton {
-            icon.name: "document-edit"
-            visible: !root.hasValue
-            onClicked: {
-                dateInput.item.selectedDate = root.initialValue
-                timeInput.value = root.initialValue
-            }
-        }
-        Kirigami.InlineMessage {
-            id: formErrorHandler
-            visible: root.statusMessage.length > 0
-            Layout.topMargin: visible ? Kirigami.Units.smallSpacing : 0
-            Layout.fillWidth: true
-            text: root.statusMessage
-            type: root.status
-        }
-    }
-
-    Connections {
-        target: dateInput
-        function onSelectedDateChanged() { root.updateValue(); }
-    }
-    function updateValue() {
-        const dt = new Date(dateInput.selectedDate.getFullYear(), dateInput.selectedDate.getMonth(), dateInput.selectedDate.getDate(), timeInput.value.getHours(), timeInput.value.getMinutes());
-        console.log(dt, dateInput.selectedDate, timeInput.value);
-        root.value = dt;
-    }
 }
diff --git a/src/app/JourneyRequestPage.qml b/src/app/JourneyRequestPage.qml
index fb1ceb099..ff81740f4 100644
--- a/src/app/JourneyRequestPage.qml
+++ b/src/app/JourneyRequestPage.qml
@@ -136,19 +136,12 @@ FormCard.FormCardPage {
                         }
                     ]
                 }
-                Flow {
-                    Layout.fillWidth: true
-                    Addon.DateInput {
-                        id: dateInput
-                        selectedDate: root.initialDateTime
-                    }
-                    Addon.TimeInput {
-                        id: timeInput
-                        value: root.initialDateTime
-                    }
-                }
             }
         }
+        FormCard.FormDateTimeDelegate {
+            id: dateTimeInput
+            value: root.initialDateTime
+        }
 
         FormCard.FormDelegateSeparator {
             below: timeSelector
@@ -166,9 +159,8 @@ FormCard.FormCardPage {
                 req.from = root.departureStop;
                 req.to = root.arrivalStop;
 
-                const dt = new Date(dateInput.selectedDate.getFullYear(), dateInput.selectedDate.getMonth(), dateInput.selectedDate.getDate(), timeInput.value.getHours(), timeInput.value.getMinutes());
-                console.log(dt, dateInput.selectedDate, timeInput.value);
-                req.dateTime = dt;
+                console.log(dateTimeInput.value);
+                req.dateTime = dateTimeInput.value;
                 req.maximumResults = 6;
                 req.downloadAssets = true;
 
-- 
GitLab


From 684407c1cef6089a710d785cb0a1b6a01d761521 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Sat, 16 Dec 2023 21:33:47 +0100
Subject: [PATCH 27/36] Adapt CI and build system to be Qt6-only

---
 .craft.ini                           | 25 +++++++++++-
 .gitlab-ci.yml                       |  9 ++---
 .kde-ci.yml                          | 44 ++-------------------
 CMakeLists.txt                       | 59 ++++++++++------------------
 autotests/CMakeLists.txt             |  5 +--
 src/CMakeLists.txt                   |  4 +-
 src/app/CMakeLists.txt               | 48 ++++++++++------------
 src/calendarextras/CMakeLists.txt    |  2 +-
 src/kandroidextras/CMakeLists.txt    | 13 +-----
 src/matrix/CMakeLists.txt            |  2 +-
 src/metadataextractor/CMakeLists.txt | 12 +++---
 src/solidextras/CMakeLists.txt       | 12 ++----
 src/thumbnailer/CMakeLists.txt       |  4 +-
 src/weather/CMakeLists.txt           |  2 +-
 14 files changed, 91 insertions(+), 150 deletions(-)

diff --git a/.craft.ini b/.craft.ini
index 0995e7b35..bd5e0a8f0 100644
--- a/.craft.ini
+++ b/.craft.ini
@@ -2,8 +2,31 @@
 ; SPDX-License-Identifier: CC0-1.0
 
 [BlueprintSettings]
-kde/pim.version=release/23.08
+kde/frameworks.version=master
+kde/pim.version=master
 kde/libs.version=master
+kde/plasma.version=master
 kde/plasma-mobile.version=master
+kde/unreleased.version=master
+libs/qt.qtMajorVersion=6
+
+; stripped-down/size-optimized Poppler, KArchive and libxml2 for our needs
 data/urw-base35-fonts.ignored=True
 data/poppler-data.ignored=True
+libs/libarchive.ignored=True
+libs/libbzip2.ignored=True
+libs/liblzma.ignored=True
+libs/libcurl.ignored=True
+libs/lcms2.ignored=True
+libs/gpgme.ignored=True
+libs/nss.ignored=True
+libs/tiff.ignored=True
+libs/boost/boost-headers.ignored=True
+
+qt-libs/poppler.buildCppFrontend=False
+qt-libs/poppler.buildQtFrontend=False
+
+libs/freetype.patchLevel=1
+libs/libxml2.patchLevel=1
+qt-libs/poppler.patchLevel=1
+kde/frameworks/tier1/karchive.patchLevel=1
diff --git a/.gitlab-ci.yml b/.gitlab-ci.yml
index 9e5f4c5e4..1cc64993c 100644
--- a/.gitlab-ci.yml
+++ b/.gitlab-ci.yml
@@ -4,13 +4,10 @@
 include:
   - project: sysadmin/ci-utilities
     file:
-      - /gitlab-templates/android.yml
-      - /gitlab-templates/linux.yml
-      - /gitlab-templates/freebsd.yml
       - /gitlab-templates/linux-qt6.yml
       - /gitlab-templates/freebsd-qt6.yml
       - /gitlab-templates/android-qt6.yml
       - /gitlab-templates/reuse-lint.yml
-      - /gitlab-templates/flatpak.yml
-      - /gitlab-templates/craft-android-apks.yml
-      # - /gitlab-templates/craft-android-qt6-apks.yml
+      # TODO waiting for a Qt6 flatpak runtime
+      #- /gitlab-templates/flatpak.yml
+      - /gitlab-templates/craft-android-qt6-apks.yml
diff --git a/.kde-ci.yml b/.kde-ci.yml
index 9a3b76aed..6bafb434a 100644
--- a/.kde-ci.yml
+++ b/.kde-ci.yml
@@ -2,42 +2,7 @@
 # SPDX-License-Identifier: CC0-1.0
 
 Dependencies:
-- 'on': ['Linux/Qt5', 'FreeBSD/Qt5', 'Windows/Qt5', 'Android/Qt5']
-  'require':
-    'frameworks/extra-cmake-modules': '@stable'
-    'frameworks/kcoreaddons': '@stable'
-    'frameworks/kconfig': '@stable'
-    'frameworks/ki18n': '@stable'
-    'frameworks/kcontacts': '@stable'
-    'frameworks/kirigami': '@stable'
-    'frameworks/kitemmodels': '@stable'
-    'frameworks/knotifications': '@stable'
-    'frameworks/kholidays': '@stable'
-    'frameworks/karchive': '@stable'
-    'frameworks/prison': '@stable'
-    'frameworks/kunitconversion': '@stable'
-    'libraries/kpublictransport': "@same"
-    'libraries/kosmindoormap': "@same"
-    'libraries/kirigami-addons': '@latest'
-    'pim/kpkpass': '@stable'
-    'pim/kitinerary': '@stable'
-    'pim/khealthcertificate': '@latest'
-    'third-party/libquotient': '@latest'
-
-- 'on': ['Linux/Qt5', 'FreeBSD/Qt5']
-  'require':
-    'frameworks/kdbusaddons': '@stable'
-    'frameworks/qqc2-desktop-style': '@stable'
-    'frameworks/kcrash': '@stable'
-    'frameworks/kio': '@stable'
-    'frameworks/kfilemetadata': '@stable'
-    'frameworks/kwindowsystem': '@stable'
-
-- 'on': ['Linux/Qt5']
-  'require':
-    'frameworks/networkmanager-qt': '@stable'
-
-- 'on': ['Linux/Qt6', 'FreeBSD/Qt6', 'Windows/Qt6', 'Android/Qt6']
+- 'on': ['Linux', 'FreeBSD', 'Windows', 'Android']
   'require':
     'frameworks/extra-cmake-modules': '@latest-kf6'
     'frameworks/kcoreaddons': '@latest-kf6'
@@ -53,14 +18,13 @@ Dependencies:
     'frameworks/kunitconversion': '@latest-kf6'
     'libraries/kpublictransport': "@same"
     'libraries/kosmindoormap': "@same"
-# TODO we cannot pull this in as long as it doesn't depend on "real" KF6
-#    'libraries/kirigami-addons': '@latest'
+    'libraries/kirigami-addons': '@latest-kf6'
     'pim/kpkpass': '@latest-kf6'
     'pim/kitinerary': '@latest-kf6'
     'pim/khealthcertificate': '@latest'
     'third-party/libquotient': '@latest'
 
-- 'on': ['Linux/Qt6', 'FreeBSD/Qt6']
+- 'on': ['Linux', 'FreeBSD']
   'require':
     'frameworks/kdbusaddons': '@latest-kf6'
     'frameworks/qqc2-desktop-style': '@latest-kf6'
@@ -69,7 +33,7 @@ Dependencies:
     'frameworks/kfilemetadata': '@latest-kf6'
     'frameworks/kwindowsystem': '@latest-kf6'
 
-- 'on': ['Linux/Qt6']
+- 'on': ['Linux']
   'require':
     'frameworks/networkmanager-qt': '@latest-kf6'
 
diff --git a/CMakeLists.txt b/CMakeLists.txt
index d723dd37f..164a8a7df 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -10,8 +10,8 @@ set (RELEASE_SERVICE_VERSION_MICRO "85")
 set (RELEASE_SERVICE_VERSION "${RELEASE_SERVICE_VERSION_MAJOR}.${RELEASE_SERVICE_VERSION_MINOR}.${RELEASE_SERVICE_VERSION_MICRO}")
 project(itinerary VERSION ${RELEASE_SERVICE_VERSION})
 
-set(KF5_MIN_VERSION 5.100)
-find_package(ECM ${KF5_MIN_VERSION} REQUIRED NO_MODULE)
+set(KF_MIN_VERSION 5.245)
+find_package(ECM ${KF_MIN_VERSION} REQUIRED NO_MODULE)
 set(CMAKE_MODULE_PATH ${ECM_MODULE_PATH} ${CMAKE_SOURCE_DIR}/cmake)
 
 include(KDECompilerSettings NO_POLICY_SCOPE)
@@ -44,44 +44,28 @@ if (EXISTS "${CMAKE_SOURCE_DIR}/.git")
     endif()
 endif()
 
-set(QT_MIN_VERSION 5.15.2)
-if (ANDROID)
-    set(QT_MIN_VERSION 5.15.10) # due to 5.15.10 changing NDK versioning
-endif()
-if (QT_MAJOR_VERSION EQUAL "6")
-    set(KF_MAJOR_VERSION "6")
-else()
-    set(KF_MAJOR_VERSION "5")
-endif()
+set(QT_MIN_VERSION 6.5)
 
 # build-time dependencies
-find_package(Qt${QT_MAJOR_VERSION} ${QT_MIN_VERSION} REQUIRED COMPONENTS Test Quick Positioning QuickControls2)
-if (QT_MAJOR_VERSION STREQUAL "5")
-    find_package(Qt${QT_MAJOR_VERSION} ${QT_MIN_VERSION} REQUIRED COMPONENTS Location)
-endif()
-find_package(Qt${QT_MAJOR_VERSION} CONFIG QUIET OPTIONAL_COMPONENTS QuickCompiler)
-find_package(KF${KF_MAJOR_VERSION} ${KF5_MIN_VERSION} REQUIRED COMPONENTS I18n CoreAddons Contacts Notifications CalendarCore Holidays UnitConversion)
-find_package(KF${KF_MAJOR_VERSION} ${KF5_MIN_VERSION} OPTIONAL_COMPONENTS NetworkManagerQt)
-if (NOT KF_MAJOR_VERSION EQUAL "6") # TODO temporary workaround until kirigami-addons is switched to KF6
-find_package(KF5KirigamiAddons 0.11.0 REQUIRED)
-endif()
-find_package(KPim${KF_MAJOR_VERSION}PkPass CONFIG REQUIRED)
-find_package(KPim${KF_MAJOR_VERSION}Itinerary 5.23.0 CONFIG REQUIRED)
+find_package(Qt6 ${QT_MIN_VERSION} REQUIRED COMPONENTS Test Quick Positioning QuickControls2)
+find_package(Qt6 CONFIG QUIET OPTIONAL_COMPONENTS QuickCompiler)
+find_package(KF6 ${KF_MIN_VERSION} REQUIRED COMPONENTS I18n CoreAddons Contacts Notifications CalendarCore Holidays UnitConversion)
+find_package(KF6 ${KF_MIN_VERSION} OPTIONAL_COMPONENTS NetworkManagerQt)
+find_package(KF6KirigamiAddons 0.11.40 REQUIRED)
+find_package(KPim6PkPass CONFIG REQUIRED)
+find_package(KPim6Itinerary 5.23.0 CONFIG REQUIRED)
 find_package(KPublicTransport 23.07.70 CONFIG REQUIRED)
 find_package(KOSMIndoorMap CONFIG REQUIRED)
 find_package(KHealthCertificate CONFIG)
 find_package(LibIcal 3.0)
 find_package(ZLIB REQUIRED)
 set(QUOTIENT_FORCE_NAMESPACED_INCLUDES ON)
-if(QT_MAJOR_VERSION STREQUAL "6")
-    set(QUOTIENT_SUFFIX "Qt6")
-endif()
-find_package(Quotient${QUOTIENT_SUFFIX} 0.7.2 CONFIG)
+find_package(QuotientQt6 0.7.2 CONFIG)
 set_package_properties("ZLIB" PROPERTIES PURPOSE "Needed for retrieving weather forecast data.")
 set_package_properties(LibIcal PROPERTIES PURPOSE "Needed for Android calendar integration.")
-set_package_properties(KF${KF_MAJOR_VERSION}Solid PROPERTIES TYPE RUNTIME PURPOSE "Used for controlling the screen brightness.")
+set_package_properties(KF6Solid PROPERTIES TYPE RUNTIME PURPOSE "Used for controlling the screen brightness.")
 set_package_properties(KHealthCertificate PROPERTIES TYPE OPTIONAL PURPOSE "Needed for the vaccination certificate manager.")
-set_package_properties(Quotient${QUOTIENT_SUFFIX} PROPERTIES TYPE OPTIONAL PURPOSE "Needed for Matrix location sharing.")
+set_package_properties(QuotientQt6 PROPERTIES TYPE OPTIONAL PURPOSE "Needed for Matrix location sharing.")
 if (ANDROID)
     set_package_properties(LibIcal PROPERTIES TYPE REQUIRED)
 else()
@@ -106,29 +90,26 @@ ecm_find_qmlmodule(org.kde.kopeninghours 1.0)
 
 # runtime dependencies are build-time dependencies on Android
 if (ANDROID)
-    find_package(Qt${QT_MAJOR_VERSION} REQUIRED COMPONENTS Svg)
-    if (QT_MAJOR_VERSION EQUAL "5")
-        find_package(Qt5 REQUIRED COMPONENTS AndroidExtras)
-    endif()
-    find_package(KF${KF_MAJOR_VERSION} ${KF5_MIN_VERSION} REQUIRED COMPONENTS Archive Kirigami2 Prison)
+    find_package(Qt6 REQUIRED COMPONENTS Svg)
+    find_package(KF6 ${KF_MIN_VERSION} REQUIRED COMPONENTS Archive Kirigami2 Prison)
     if (NOT DEFINED BREEZEICONS_DIR AND EXISTS ${CMAKE_SOURCE_DIR}/../breeze-icons)
         set(BREEZEICONS_DIR ${CMAKE_SOURCE_DIR}/../breeze-icons)
     endif()
     find_package(OpenSSL REQUIRED)
     find_package(Gradle REQUIRED)
 else()
-    find_package(Qt${QT_MAJOR_VERSION} REQUIRED COMPONENTS Widgets DBus)
-    find_package(KF${KF_MAJOR_VERSION} ${KF5_MIN_VERSION} REQUIRED COMPONENTS DBusAddons QQC2DesktopStyle WindowSystem)
-    find_package(KF${KF_MAJOR_VERSION} ${KF5_MIN_VERSION} OPTIONAL_COMPONENTS Solid Crash FileMetaData KIO)
+    find_package(Qt6 REQUIRED COMPONENTS Widgets DBus)
+    find_package(KF6 ${KF_MIN_VERSION} REQUIRED COMPONENTS DBusAddons QQC2DesktopStyle WindowSystem)
+    find_package(KF6 ${KF_MIN_VERSION} OPTIONAL_COMPONENTS Solid Crash FileMetaData KIO)
     set(HAVE_DBUS ON)
 endif()
-if (TARGET KF${KF_MAJOR_VERSION}::Crash)
+if (TARGET KF6::Crash)
     set(HAVE_KCRASH TRUE)
 endif()
 if (TARGET KHealthCertificate)
     set(HAVE_KHEALTHCERTIFICATE TRUE)
 endif()
-if (TARGET Quotient)
+if (TARGET QuotientQt6)
     set(HAVE_MATRIX TRUE)
 else()
     set(HAVE_MATRIX FALSE)
diff --git a/autotests/CMakeLists.txt b/autotests/CMakeLists.txt
index 52ec91c77..041db0e8b 100644
--- a/autotests/CMakeLists.txt
+++ b/autotests/CMakeLists.txt
@@ -45,7 +45,4 @@ ecm_add_test(weathertest.cpp LINK_LIBRARIES Qt::Test itinerary-weather)
 target_include_directories(weathertest PRIVATE ${CMAKE_BINARY_DIR})
 
 # verify QML code
-# TODO remove limit on Qt5 once the QML code is ported to Qt6
-if (QT_MAJOR_VERSION EQUAL 5)
-    add_test(NAME itinerary-self-test COMMAND itinerary-app --self-test)
-endif()
+add_test(NAME itinerary-self-test COMMAND itinerary-app --self-test)
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index 5e13f2360..9aa423583 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -13,9 +13,9 @@ if (HAVE_MATRIX)
     add_subdirectory(matrix)
 endif()
 
-if (TARGET KF${KF_MAJOR_VERSION}::FileMetaData)
+if (TARGET KF6::FileMetaData)
     add_subdirectory(metadataextractor)
 endif()
-if (TARGET KF${KF_MAJOR_VERSION}::KIOWidgets)
+if (TARGET KF6::KIOWidgets)
     add_subdirectory(thumbnailer)
 endif()
diff --git a/src/app/CMakeLists.txt b/src/app/CMakeLists.txt
index 8f6fcbbc5..a67c55ecf 100644
--- a/src/app/CMakeLists.txt
+++ b/src/app/CMakeLists.txt
@@ -68,23 +68,19 @@ target_link_libraries(itinerary PUBLIC
     KPublicTransport
     KPublicTransportOnboard
     KOSMIndoorMap
-    KPim${KF_MAJOR_VERSION}::Itinerary
-    KPim${KF_MAJOR_VERSION}::PkPass
-    KF${KF_MAJOR_VERSION}::CalendarCore
-    KF${KF_MAJOR_VERSION}::I18n
-    KF${KF_MAJOR_VERSION}::I18nLocaleData
-    KF${KF_MAJOR_VERSION}::Contacts
-    KF${KF_MAJOR_VERSION}::CoreAddons
-    KF${KF_MAJOR_VERSION}::Notifications
-    KF${KF_MAJOR_VERSION}::Holidays
+    KPim6::Itinerary
+    KPim6::PkPass
+    KPim6::Mime
+    KF6::CalendarCore
+    KF6::I18n
+    KF6::I18nLocaleData
+    KF6::Contacts
+    KF6::CoreAddons
+    KF6::Notifications
+    KF6::Holidays
     Qt::Network
     Qt::Quick
 )
-if (TARGET KF5::Mime)
-    target_link_libraries(itinerary PUBLIC KF5::Mime)
-else()
-    target_link_libraries(itinerary PUBLIC KPim${KF_MAJOR_VERSION}::Mime)
-endif()
 if (HAVE_MATRIX)
     target_link_libraries(itinerary PUBLIC KMatrix)
 endif()
@@ -121,24 +117,20 @@ target_sources(itinerary-app PRIVATE
 target_include_directories(itinerary-app PRIVATE ${CMAKE_BINARY_DIR})
 target_link_libraries(itinerary-app PRIVATE
     itinerary
-    KF${KF_MAJOR_VERSION}::UnitConversion
+    KF6::UnitConversion
     Qt::QuickControls2
     KCalendarCoreExtras
 )
 if (ANDROID)
-    target_include_directories(itinerary-app PRIVATE ${Qt5Core_PRIVATE_INCLUDE_DIRS})
-    target_link_libraries(itinerary PUBLIC KAndroidExtras)
-    if (QT_MAJOR_VERSION EQUAL "6")
-        target_link_libraries(itinerary PRIVATE Qt::CorePrivate)
-        target_link_libraries(itinerary-app PRIVATE Qt::CorePrivate)
-    endif()
+    target_link_libraries(itinerary PUBLIC KAndroidExtras PRIVATE Qt::CorePrivate)
     # explicitly add runtime dependencies and transitive link dependencies,
     # so androiddeployqt picks them up
     target_link_libraries(itinerary-app PRIVATE
-        KF${KF_MAJOR_VERSION}::Archive
-        KF${KF_MAJOR_VERSION}::Kirigami2
+        KF6::Archive
+        KF6::Kirigami2
         Qt::Svg
-        KF${KF_MAJOR_VERSION}::Prison
+        Qt::CorePrivate
+        KF6::Prison
         OpenSSL::SSL
     )
 
@@ -248,15 +240,15 @@ if (ANDROID)
 else ()
     target_link_libraries(itinerary PRIVATE Qt::Positioning Qt::DBus Qt::Widgets)
     target_link_libraries(itinerary-app PRIVATE
-        KF${KF_MAJOR_VERSION}::DBusAddons
-        KF${KF_MAJOR_VERSION}::WindowSystem
+        KF6::DBusAddons
+        KF6::WindowSystem
         Qt::Widgets
     )
     set_target_properties(itinerary-app PROPERTIES OUTPUT_NAME "itinerary")
     ecm_install_icons(ICONS sc-apps-org.kde.itinerary.svg DESTINATION ${KDE_INSTALL_ICONDIR})
 endif()
-if (TARGET KF${KF_MAJOR_VERSION}::Crash)
-    target_link_libraries(itinerary-app PRIVATE KF${KF_MAJOR_VERSION}::Crash)
+if (TARGET KF6::Crash)
+    target_link_libraries(itinerary-app PRIVATE KF6::Crash)
 endif()
 
 install(TARGETS itinerary-app ${KDE_INSTALL_TARGETS_DEFAULT_ARGS})
diff --git a/src/calendarextras/CMakeLists.txt b/src/calendarextras/CMakeLists.txt
index 392c46a41..858c94394 100644
--- a/src/calendarextras/CMakeLists.txt
+++ b/src/calendarextras/CMakeLists.txt
@@ -25,7 +25,7 @@ if (ANDROID)
     target_link_libraries(KCalendarCoreExtras PRIVATE KAndroidExtras LibIcal)
 endif()
 
-target_link_libraries(KCalendarCoreExtras PUBLIC KF${KF_MAJOR_VERSION}::CalendarCore)
+target_link_libraries(KCalendarCoreExtras PUBLIC KF6::CalendarCore)
 
 if (ANDROID)
     install(TARGETS KCalendarCoreExtras ${KF_INSTALL_TARGETS_DEFAULT_ARGS})
diff --git a/src/kandroidextras/CMakeLists.txt b/src/kandroidextras/CMakeLists.txt
index aeeec7d32..ebdd08df4 100644
--- a/src/kandroidextras/CMakeLists.txt
+++ b/src/kandroidextras/CMakeLists.txt
@@ -29,18 +29,9 @@ target_compile_features(KAndroidExtras PUBLIC cxx_std_20) # for __VA_OPT__
 target_link_libraries(KAndroidExtras PUBLIC Qt::Core)
 
 if (ANDROID)
-    if (QT_MAJOR_VERSION EQUAL "5")
-        target_link_libraries(KAndroidExtras PUBLIC Qt5::AndroidExtras)
-    else()
-        target_link_libraries(KAndroidExtras PRIVATE Qt::CorePrivate)
-    endif()
+    target_link_libraries(KAndroidExtras PRIVATE Qt::CorePrivate)
 else()
-    target_include_directories(KAndroidExtras PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/fake)
-    if (QT_MAJOR_VERSION EQUAL "5")
-        target_include_directories(KAndroidExtras PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/fake/qt5)
-    else()
-        target_include_directories(KAndroidExtras PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/fake/qt6)
-    endif()
+    target_include_directories(KAndroidExtras PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/fake ${CMAKE_CURRENT_SOURCE_DIR}/fake/qt6)
 endif()
 
 ecm_generate_headers(KAndroidExtras_android_FORWARDING_HEADERS
diff --git a/src/matrix/CMakeLists.txt b/src/matrix/CMakeLists.txt
index a3574e8cc..db0f508f6 100644
--- a/src/matrix/CMakeLists.txt
+++ b/src/matrix/CMakeLists.txt
@@ -11,7 +11,7 @@ target_sources(KMatrix PRIVATE
 )
 
 generate_export_header(KMatrix BASE_NAME KMatrix)
-target_link_libraries(KMatrix PUBLIC Qt::Core Quotient${QUOTIENT_SUFFIX} PRIVATE KF${KF_MAJOR_VERSION}::I18n)
+target_link_libraries(KMatrix PUBLIC Qt::Core QuotientQt6 PRIVATE KF6::I18n)
 
 ecm_generate_headers(KMatrix_FORWARDING_HEADERS
         HEADER_NAMES
diff --git a/src/metadataextractor/CMakeLists.txt b/src/metadataextractor/CMakeLists.txt
index 816c7efbd..b9cb97c09 100644
--- a/src/metadataextractor/CMakeLists.txt
+++ b/src/metadataextractor/CMakeLists.txt
@@ -4,14 +4,14 @@
 add_library(kfilemetadata_itineraryextractor MODULE itineraryextractor.cpp)
 
 target_link_libraries(kfilemetadata_itineraryextractor
-    KF${KF_MAJOR_VERSION}::FileMetaData
-    KF${KF_MAJOR_VERSION}::I18n
+    KF6::FileMetaData
+    KF6::I18n
     Qt::Gui
-    KPim${KF_MAJOR_VERSION}::Itinerary
-    KPim${KF_MAJOR_VERSION}::PkPass
+    KPim6::Itinerary
+    KPim6::PkPass
 )
 
 set_target_properties(kfilemetadata_itineraryextractor PROPERTIES
-    LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin/kf${QT_MAJOR_VERSION}/kfilemetadata")
+    LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin/kf6/kfilemetadata")
 install(TARGETS kfilemetadata_itineraryextractor
-    DESTINATION ${KDE_INSTALL_PLUGINDIR}/kf${QT_MAJOR_VERSION}/kfilemetadata)
+    DESTINATION ${KDE_INSTALL_PLUGINDIR}/kf6/kfilemetadata)
diff --git a/src/solidextras/CMakeLists.txt b/src/solidextras/CMakeLists.txt
index 1bb023b8d..e7f4f6543 100644
--- a/src/solidextras/CMakeLists.txt
+++ b/src/solidextras/CMakeLists.txt
@@ -30,7 +30,7 @@ endif()
 add_library(SolidExtras ${solidextras_srcs})
 generate_export_header(SolidExtras BASE_NAME SolidExtras)
 
-if (TARGET KF${KF_MAJOR_VERSION}::NetworkManagerQt)
+if (TARGET KF6::NetworkManagerQt)
     set(HAVE_NM ON)
 endif()
 configure_file(config-solid-extras.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config-solid-extras.h)
@@ -38,14 +38,10 @@ configure_file(config-solid-extras.h.cmake ${CMAKE_CURRENT_BINARY_DIR}/config-so
 target_include_directories(SolidExtras PUBLIC "$<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/..>")
 target_link_libraries(SolidExtras PUBLIC Qt::Core)
 
-if (ANDROID)
-    if (QT_MAJOR_VERSION EQUAL "5")
-        target_link_libraries(SolidExtras PRIVATE Qt::AndroidExtras)
-    endif()
-else ()
+if (NOT ANDROID)
     target_link_libraries(SolidExtras PRIVATE Qt::DBus)
-    if (TARGET KF${KF_MAJOR_VERSION}::NetworkManagerQt)
-        target_link_libraries(SolidExtras PRIVATE KF${KF_MAJOR_VERSION}::NetworkManagerQt)
+    if (TARGET KF6::NetworkManagerQt)
+        target_link_libraries(SolidExtras PRIVATE KF6::NetworkManagerQt)
     endif()
 endif()
 
diff --git a/src/thumbnailer/CMakeLists.txt b/src/thumbnailer/CMakeLists.txt
index ab5213295..b55e259dd 100644
--- a/src/thumbnailer/CMakeLists.txt
+++ b/src/thumbnailer/CMakeLists.txt
@@ -4,7 +4,7 @@
 kcoreaddons_add_plugin(itinerarythumbnail SOURCES itinerarycreator.cpp INSTALL_NAMESPACE "kf${QT_MAJOR_VERSION}/thumbcreator")
 
 target_link_libraries(itinerarythumbnail
-    KF${KF_MAJOR_VERSION}::KIOGui
+    KF6::KIOGui
     Qt::Gui
-    KPim${KF_MAJOR_VERSION}::PkPass
+    KPim6::PkPass
 )
diff --git a/src/weather/CMakeLists.txt b/src/weather/CMakeLists.txt
index be8bc1fcf..746eb47df 100644
--- a/src/weather/CMakeLists.txt
+++ b/src/weather/CMakeLists.txt
@@ -11,7 +11,7 @@ target_link_libraries(itinerary-weather
     PUBLIC
         Qt::Core
     PRIVATE
-        KF${KF_MAJOR_VERSION}::Holidays
+        KF6::Holidays
         Qt::Network
         ZLIB::ZLIB
 )
-- 
GitLab


From 6446484b853015f8e93a0f2eac4337239998e9d1 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Mon, 18 Dec 2023 17:09:48 +0100
Subject: [PATCH 28/36] Drop Qt 5 code

---
 autotests/androidicalconvertertest.cpp        |  4 +-
 autotests/androidwrappertest.cpp              |  9 +--
 autotests/jniarraytest.cpp                    |  6 +-
 autotests/jnimethodtest.cpp                   | 18 ++---
 autotests/jnipropertytest.cpp                 | 18 ++---
 src/app/android/itineraryactivity.h           | 10 +--
 src/app/calendarimportmodel.cpp               |  6 --
 src/app/developmentmodecontroller.cpp         | 19 -----
 src/app/json.cpp                              |  4 -
 src/app/localizer.cpp                         | 11 +--
 src/app/main.cpp                              | 27 +------
 src/app/permissionmanager.cpp                 | 21 -----
 src/app/reservationhelper.cpp                 | 11 ---
 src/app/reservationhelper.h                   |  5 --
 src/app/reservationmanager.cpp                | 24 +-----
 src/app/transfermanager.cpp                   | 35 ---------
 src/app/unitconversion.cpp                    | 14 ----
 src/calendarextras/androidcalendar.cpp        | 76 -------------------
 src/calendarextras/androidcalendar.h          | 18 -----
 src/calendarextras/androidcalendarplugin.cpp  |  7 --
 src/kandroidextras/android/activity.cpp       | 18 +----
 .../android/contentresolver.cpp               | 14 +---
 src/kandroidextras/android/contentresolver.h  |  7 +-
 src/kandroidextras/android/context.cpp        | 10 +--
 src/kandroidextras/android/context.h          |  8 +-
 src/kandroidextras/android/intent.cpp         |  8 +-
 src/kandroidextras/android/intent.h           | 12 +--
 src/kandroidextras/android/uri.cpp            |  8 +-
 src/kandroidextras/android/uri.h              |  4 +-
 .../fake/qt5/QAndroidJniEnvironment           | 18 -----
 src/kandroidextras/fake/qt5/QAndroidJniObject |  6 --
 src/kandroidextras/fake/qt5/QtAndroid         | 31 --------
 .../fake/qt5/qandroidjniobject.h              | 19 -----
 src/kandroidextras/java/javalocale.cpp        | 12 +--
 src/kandroidextras/java/javalocale.h          | 10 +--
 src/kandroidextras/java/javatypes.h           |  2 +-
 src/kandroidextras/jni/jniarray.h             | 71 ++++++++---------
 src/kandroidextras/jni/jnimethod.h            | 36 ++++-----
 src/kandroidextras/jni/jniobject.h            | 32 ++++----
 src/kandroidextras/jni/jniproperty.h          | 16 ++--
 src/kandroidextras/jni/jnireturnvalue.h       |  6 +-
 src/kandroidextras/jni/jnitypes.h             |  2 +-
 src/kandroidextras/jni/jnitypetraits.h        | 14 +---
 src/solidextras/androidbrightnessbackend.cpp  | 20 +----
 src/solidextras/androidlockbackend.cpp        | 22 +-----
 src/solidextras/networkstatus_android.cpp     | 33 ++------
 tests/journeyquerytest.cpp                    |  5 --
 tests/pkpassviewer.cpp                        |  5 --
 tests/vehiclelayoutviewer.cpp                 |  5 --
 49 files changed, 155 insertions(+), 642 deletions(-)
 delete mode 100644 src/kandroidextras/fake/qt5/QAndroidJniEnvironment
 delete mode 100644 src/kandroidextras/fake/qt5/QAndroidJniObject
 delete mode 100644 src/kandroidextras/fake/qt5/QtAndroid
 delete mode 100644 src/kandroidextras/fake/qt5/qandroidjniobject.h

diff --git a/autotests/androidicalconvertertest.cpp b/autotests/androidicalconvertertest.cpp
index 062c8278f..c4e276551 100644
--- a/autotests/androidicalconvertertest.cpp
+++ b/autotests/androidicalconvertertest.cpp
@@ -38,7 +38,7 @@ private Q_SLOTS:
     void testAlarm()
     {
         KCalendarCore::Event ev;
-        auto data = Jni::fromHandle<JniReminderData>(QAndroidJniObject{});
+        auto data = Jni::fromHandle<JniReminderData>(QJniObject{});
         data.minutes = 5;
         auto alarm = AndroidIcalConverter::readAlarm(data, &ev);
         QCOMPARE(alarm->startOffset().asSeconds(), -300);
@@ -49,7 +49,7 @@ private Q_SLOTS:
 
     void testAttendee()
     {
-        auto data = Jni::fromHandle<JniAttendeeData>(QAndroidJniObject{});
+        auto data = Jni::fromHandle<JniAttendeeData>(QJniObject{});
         data.name = QStringLiteral("Dr Konqi");
         data.email = QStringLiteral("null@kde.org");
         auto attendee = AndroidIcalConverter::readAttendee(data);
diff --git a/autotests/androidwrappertest.cpp b/autotests/androidwrappertest.cpp
index 9b721ffe7..c4a698a0c 100644
--- a/autotests/androidwrappertest.cpp
+++ b/autotests/androidwrappertest.cpp
@@ -7,12 +7,7 @@
 #include <KAndroidExtras/Context>
 #include <KAndroidExtras/ContentResolver>
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QAndroidJniObject>
-#else
 #include <QJniObject>
-using QAndroidJniObject = QJniObject;
-#endif
 #include <QtTest/qtest.h>
 
 using namespace KAndroidExtras;
@@ -42,8 +37,8 @@ private Q_SLOTS:
             "callMethod: moveToFirst ()Z ()\n"
             "callObjectMethod: getString (I)Ljava/lang/String; (I)"
         ));
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.size(), 1);
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.at(0), QLatin1String("getStaticObjectField: android/provider/OpenableColumns DISPLAY_NAME Ljava/lang/String;"));
+        QCOMPARE(QJniObject::m_staticProtocol.size(), 1);
+        QCOMPARE(QJniObject::m_staticProtocol.at(0), QLatin1String("getStaticObjectField: android/provider/OpenableColumns DISPLAY_NAME Ljava/lang/String;"));
 #endif
     }
 };
diff --git a/autotests/jniarraytest.cpp b/autotests/jniarraytest.cpp
index e62280f1e..41396360e 100644
--- a/autotests/jniarraytest.cpp
+++ b/autotests/jniarraytest.cpp
@@ -35,8 +35,8 @@ private Q_SLOTS:
 #ifndef Q_OS_ANDROID
         JNIEnv::m_arrayLength = 3;
 
-        QAndroidJniObject array;
-        const auto a1 = Jni::fromArray<std::vector<QAndroidJniObject>>(array);
+        QJniObject array;
+        const auto a1 = Jni::fromArray<std::vector<QJniObject>>(array);
         QCOMPARE(a1.size(), 3);
 
         JNIEnv::m_arrayLength = 2;
@@ -59,7 +59,7 @@ private Q_SLOTS:
 #ifndef Q_OS_ANDROID
         JNIEnv::m_arrayLength = 3;
 
-        QAndroidJniObject array;
+        QJniObject array;
         // primitive types
         const auto a1 = Jni::Array<jint>(array);
         QCOMPARE(a1.size(), 3);
diff --git a/autotests/jnimethodtest.cpp b/autotests/jnimethodtest.cpp
index 059f0ea3e..f38889ba8 100644
--- a/autotests/jnimethodtest.cpp
+++ b/autotests/jnimethodtest.cpp
@@ -69,7 +69,7 @@ private Q_SLOTS:
         Q_UNUSED(s);
         obj.setName(QStringLiteral("bla"));
          // explicit cast needed when coming from untyped JNI handler
-        obj.setName(Jni::Object<java::lang::String>(QAndroidJniObject::fromString(QStringLiteral("bla"))));
+        obj.setName(Jni::Object<java::lang::String>(QJniObject::fromString(QStringLiteral("bla"))));
         int i = obj.getFlags();
         Q_UNUSED(i);
         obj.setFlags(42);
@@ -85,8 +85,8 @@ private Q_SLOTS:
         Intent intent;
         obj.startIntent(intent);
         // returning a non-wrapped type
-        QAndroidJniObject j = obj.getIntent();
-        // lvalue QAndroidJniObject argument needs explicit cast
+        QJniObject j = obj.getIntent();
+        // lvalue QJniObject argument needs explicit cast
         obj.setName(Jni::Object<java::lang::String>(j));
         // implicit conversion from a static property wrapper
         obj.setFlags(Intent::FLAG_GRANT_READ_URI_PERMISSION);
@@ -167,17 +167,17 @@ private Q_SLOTS:
     void testStaticCalls()
     {
 #ifndef Q_OS_ANDROID
-        QAndroidJniObject::m_staticProtocol.clear();
+        QJniObject::m_staticProtocol.clear();
 
         TestClass::noRetNoArg();
         TestClass::noRetArg(QStringLiteral("test"));
         TestClass::retNoArg();
-        QAndroidJniObject o = TestClass::retArg(true);
+        QJniObject o = TestClass::retArg(true);
 
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.size(), 3);
-        QCOMPARE(QAndroidJniObject::m_staticProtocol[0], QLatin1String("callStaticMethod: android/content/Intent noRetNoArg ()V ()"));
-        QCOMPARE(QAndroidJniObject::m_staticProtocol[1], QLatin1String("callStaticMethod: android/content/Intent noRetArg (Ljava/lang/String;)V (o)"));
-        QCOMPARE(QAndroidJniObject::m_staticProtocol[2], QLatin1String("callStaticMethod: android/content/Intent retNoArg ()J ()"));
+        QCOMPARE(QJniObject::m_staticProtocol.size(), 3);
+        QCOMPARE(QJniObject::m_staticProtocol[0], QLatin1String("callStaticMethod: android/content/Intent noRetNoArg ()V ()"));
+        QCOMPARE(QJniObject::m_staticProtocol[1], QLatin1String("callStaticMethod: android/content/Intent noRetArg (Ljava/lang/String;)V (o)"));
+        QCOMPARE(QJniObject::m_staticProtocol[2], QLatin1String("callStaticMethod: android/content/Intent retNoArg ()J ()"));
         QCOMPARE(o.protocol().at(0), QLatin1String("callStaticObjectMethod: android/content/Intent retArg (Z)Landroid/content/Intent; (Z)"));
 #endif
     }
diff --git a/autotests/jnipropertytest.cpp b/autotests/jnipropertytest.cpp
index ddc8d2751..d3995d2c0 100644
--- a/autotests/jnipropertytest.cpp
+++ b/autotests/jnipropertytest.cpp
@@ -36,7 +36,7 @@ public:
     friend class JniPropertyTest;
 };
 
-static_assert(sizeof(TestClass) == sizeof(QAndroidJniObject));
+static_assert(sizeof(TestClass) == sizeof(QJniObject));
 
 class JniPropertyTest : public QObject
 {
@@ -49,19 +49,19 @@ private Q_SLOTS:
         Q_UNUSED(p1)
         int32_t p2 = TestClass::FLAG_GRANT_READ_URI_PERMISSION;
         Q_UNUSED(p2)
-        QAndroidJniObject p3 = TestClass::OBJECT_TYPE_PROPERTY;
+        QJniObject p3 = TestClass::OBJECT_TYPE_PROPERTY;
         Q_UNUSED(p3)
         bool b = TestClass::BOOL_PROPERTY;
 
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.size(), 4);
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.at(0), QLatin1String("getStaticObjectField: android/content/Intent ACTION_CREATE_DOCUMENT Ljava/lang/String;"));
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.at(1), QLatin1String("getStaticField<>: android/content/Intent FLAG_GRANT_READ_URI_PERMISSION I"));
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.at(2), QLatin1String("getStaticObjectField: android/content/Intent OBJECT_TYPE_PROPERTY Landroid/net/Uri;"));
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.at(3), QLatin1String("getStaticField<>: android/content/Intent BOOL_PROPERTY Z"));
+        QCOMPARE(QJniObject::m_staticProtocol.size(), 4);
+        QCOMPARE(QJniObject::m_staticProtocol.at(0), QLatin1String("getStaticObjectField: android/content/Intent ACTION_CREATE_DOCUMENT Ljava/lang/String;"));
+        QCOMPARE(QJniObject::m_staticProtocol.at(1), QLatin1String("getStaticField<>: android/content/Intent FLAG_GRANT_READ_URI_PERMISSION I"));
+        QCOMPARE(QJniObject::m_staticProtocol.at(2), QLatin1String("getStaticObjectField: android/content/Intent OBJECT_TYPE_PROPERTY Landroid/net/Uri;"));
+        QCOMPARE(QJniObject::m_staticProtocol.at(3), QLatin1String("getStaticField<>: android/content/Intent BOOL_PROPERTY Z"));
 
         const QString p4 = ManifestPermission::READ_CALENDAR;
         Q_UNUSED(p4)
-        QCOMPARE(QAndroidJniObject::m_staticProtocol.at(4), QLatin1String("getStaticObjectField: android/Manifest$permission READ_CALENDAR Ljava/lang/String;"));
+        QCOMPARE(QJniObject::m_staticProtocol.at(4), QLatin1String("getStaticObjectField: android/Manifest$permission READ_CALENDAR Ljava/lang/String;"));
 
 
         TestClass obj;
@@ -72,7 +72,7 @@ private Q_SLOTS:
         obj.myIntField = 42;
         const QUrl url = obj.myUriField;
         obj.myUriField = url;
-        const QAndroidJniObject bla = obj.myIntentField;
+        const QJniObject bla = obj.myIntentField;
         obj.myIntentField = bla;
         b = obj.myBoolProperty;
         obj.myBoolProperty = b;
diff --git a/src/app/android/itineraryactivity.h b/src/app/android/itineraryactivity.h
index e027770fd..17d79e0f1 100644
--- a/src/app/android/itineraryactivity.h
+++ b/src/app/android/itineraryactivity.h
@@ -13,11 +13,7 @@
 #include <kandroidextras/androidtypes.h>
 #include <kandroidextras/uri.h>
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#else
 #include <QCoreApplication>
-#endif
 
 JNI_TYPE(org, kde, itinerary, Activity)
 
@@ -28,12 +24,8 @@ public:
     JNI_METHOD(KAndroidExtras::Jni::Array<KAndroidExtras::java::lang::String>, attachmentsForIntent, KAndroidExtras::android::content::Intent)
     JNI_METHOD(KAndroidExtras::android::net::Uri, openDocument, KAndroidExtras::java::lang::String)
 private:
-    inline QAndroidJniObject jniHandle() const {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-        return QtAndroid::androidActivity();
-#else
+    inline QJniObject jniHandle() const {
         return QNativeInterface::QAndroidApplication::context();
-#endif
     }
 };
 
diff --git a/src/app/calendarimportmodel.cpp b/src/app/calendarimportmodel.cpp
index 1f0c0a38f..08b621013 100644
--- a/src/app/calendarimportmodel.cpp
+++ b/src/app/calendarimportmodel.cpp
@@ -13,8 +13,6 @@
 #include <KItinerary/Reservation>
 #include <KItinerary/Visit>
 
-#include <kcalendarcore_version.h>
-
 #include <QDebug>
 #include <QJsonArray>
 
@@ -47,15 +45,11 @@ void CalendarImportModel::setCalendar(KCalendarCore::Calendar *calendar)
         return;
     }
 
-#if KCALENDARCORE_VERSION >= QT_VERSION_CHECK(5, 96, 0)
     if (!m_calendar->isLoading()) {
         reload();
     } else {
         connect(m_calendar, &KCalendarCore::Calendar::isLoadingChanged, this, &CalendarImportModel::reload);
     }
-#else
-    reload();
-#endif
 }
 
 QVector<QVariant> CalendarImportModel::selectedReservations() const
diff --git a/src/app/developmentmodecontroller.cpp b/src/app/developmentmodecontroller.cpp
index 81a2baec5..0ad305091 100644
--- a/src/app/developmentmodecontroller.cpp
+++ b/src/app/developmentmodecontroller.cpp
@@ -22,28 +22,14 @@
 #include <kandroidextras/manifestpermission.h>
 using namespace KAndroidExtras;
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#else
 #include <private/qandroidextras_p.h>
 #endif
-#endif
 
 #include <csignal>
 
 void DevelopmentModeController::enablePublicTransportLogging()
 {
 #ifdef Q_OS_ANDROID
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    if (QtAndroid::checkPermission(ManifestPermission::WRITE_EXTERNAL_STORAGE) != QtAndroid::PermissionResult::Granted) {
-        QtAndroid::requestPermissions({ManifestPermission::WRITE_EXTERNAL_STORAGE}, [this] (const QtAndroid::PermissionResultMap &result){
-            if (result[ManifestPermission::WRITE_EXTERNAL_STORAGE] == QtAndroid::PermissionResult::Granted) {
-                enablePublicTransportLogging();
-            }
-        });
-        return;
-    }
-#else
     if (QtAndroidPrivate::checkPermission(ManifestPermission::WRITE_EXTERNAL_STORAGE).result() != QtAndroidPrivate::PermissionResult::Authorized) {
         if (QtAndroidPrivate::requestPermission(ManifestPermission::WRITE_EXTERNAL_STORAGE).result() == QtAndroidPrivate::PermissionResult::Authorized) {
             enablePublicTransportLogging();
@@ -51,13 +37,8 @@ void DevelopmentModeController::enablePublicTransportLogging()
             return;
         }
     }
-#endif
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto context = QtAndroid::androidContext();
-#else
     const QJniObject context = QNativeInterface::QAndroidApplication::context();
-#endif
     const auto f = context.callObjectMethod("getExternalFilesDir", Jni::signature<java::io::File(java::lang::String)>(), nullptr);
     const auto baseDir = f.callObjectMethod("getPath", Jni::signature<java::lang::String()>()).toString();
 #else
diff --git a/src/app/json.cpp b/src/app/json.cpp
index 9cc1c23bb..791381c98 100644
--- a/src/app/json.cpp
+++ b/src/app/json.cpp
@@ -202,11 +202,7 @@ void Json::fromJson(const QMetaObject *mo, const QJsonObject &obj, void *elem)
             }
             auto valueData = mt.create();
             *reinterpret_cast<int*>(valueData) = numValue;
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-            QVariant value(prop.userType(), valueData);
-#else
             QVariant value(prop.metaType(), valueData);
-#endif
             prop.writeOnGadget(elem, value);
             continue;
         }
diff --git a/src/app/localizer.cpp b/src/app/localizer.cpp
index 9cd0c0181..1b3af1b13 100644
--- a/src/app/localizer.cpp
+++ b/src/app/localizer.cpp
@@ -6,12 +6,9 @@
 
 #include "localizer.h"
 
-#include <kitinerary_version.h>
 #include <KItinerary/JsonLdDocument>
 #include <KItinerary/Place>
-#if KITINERARY_VERSION >= QT_VERSION_CHECK(5, 24, 41)
 #include <KItinerary/PriceUtil>
-#endif
 
 #include <KContacts/Address>
 
@@ -142,9 +139,9 @@ static QString tzAbbreviation(const QDateTime &dt)
 #ifdef Q_OS_ANDROID
     // the QTimeZone backend implementation on Android isn't as complete as the desktop ones, so we need to do this ourselves here
     // eventually, this should be upstreamed to Qt
-    auto abbr = QAndroidJniObject::callStaticObjectMethod("org/kde/itinerary/QTimeZone", "abbreviation",
+    auto abbr = QJniObject::callStaticObjectMethod("org/kde/itinerary/QTimeZone", "abbreviation",
                     Jni::signature<java::lang::String(java::lang::String, jlong, java::util::Locale, bool)>(),
-                    QAndroidJniObject::fromString(QString::fromUtf8(tz.id())).object(), dt.toMSecsSinceEpoch(),
+                    QJniObject::fromString(QString::fromUtf8(tz.id())).object(), dt.toMSecsSinceEpoch(),
                     KAndroidExtras::Locale::current().object(), tz.isDaylightTime(dt)).toString();
 
     if (!abbr.isEmpty()) {
@@ -260,11 +257,7 @@ QString Localizer::formatTemperature(double temperature)
 
 QString Localizer::formatCurrency(double value, const QString &isoCode)
 {
-#if KITINERARY_VERSION >= QT_VERSION_CHECK(5, 24, 41)
     const auto decimalCount = PriceUtil::decimalCount(isoCode);
-#else
-    const auto decimalCount = 2;
-#endif
 
     // special case for displaying conversion rates (which can be very small)
     // and thus need a higher precision than regular values
diff --git a/src/app/main.cpp b/src/app/main.cpp
index 2ec7ca56d..ae85963ce 100644
--- a/src/app/main.cpp
+++ b/src/app/main.cpp
@@ -63,11 +63,8 @@
 
 #include <KItinerary/CountryDb>
 #include <KItinerary/JsonLdDocument>
-#include <KItinerary/Ticket>
-#include <kitinerary_version.h>
-#if KITINERARY_VERSION >= QT_VERSION_CHECK(5, 24, 41)
 #include <KItinerary/PriceUtil>
-#endif
+#include <KItinerary/Ticket>
 
 #include <KPkPass/Field>
 #include <KPkPass/Barcode>
@@ -116,20 +113,6 @@ class MatrixBeaconStub : public QObject
 };
 #endif
 
-#if KITINERARY_VERSION <QT_VERSION_CHECK(5, 24, 41)
-class DummyPriceUtil
-{
-    Q_GADGET
- public:
-    Q_INVOKABLE static bool hasPrice(const QVariant&) { return false; }
-    Q_INVOKABLE static bool canHavePrice(const QVariant&) { return false; }
-    Q_INVOKABLE static double price(const QVariant&) { return 0.0; }
-    Q_INVOKABLE static QString currency(const QVariant&) { return QString(); }
-    Q_INVOKABLE static void setPrice(QVariant&, double, const QString&) {}
-    Q_INVOKABLE static int decimalCount(QStringView) { return 2; }
-};
-#endif
-
 void registerKContactsTypes()
 {
     // ### this should move into a real QML plugin for KContacts
@@ -168,11 +151,7 @@ void registerKItineraryTypes()
     qmlRegisterUncreatableMetaObject(KItinerary::Ticket::staticMetaObject, "org.kde.kitinerary", 1, 0, "Ticket", {});
     qmlRegisterUncreatableMetaObject(KItinerary::KnowledgeDb::staticMetaObject, "org.kde.kitinerary", 1, 0, "KnowledgeDb", {});
     qmlRegisterSingletonType("org.kde.itinerary", 1, 0, "PriceUtil", [](QQmlEngine*, QJSEngine *engine) -> QJSValue {
-#if KITINERARY_VERSION >= QT_VERSION_CHECK(5, 24, 41)
         return engine->toScriptValue(KItinerary::PriceUtil());
-#else
-        return engine->toScriptValue(DummyPriceUtil());
-#endif
     });
 }
 
@@ -329,10 +308,6 @@ int main(int argc, char **argv)
     QCoreApplication::setOrganizationName(QStringLiteral("KDE"));
     QCoreApplication::setOrganizationDomain(QStringLiteral("kde.org"));
     QCoreApplication::setApplicationVersion(QStringLiteral(ITINERARY_VERSION_STRING));
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QGuiApplication::setAttribute(Qt::AA_EnableHighDpiScaling);
-    QGuiApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);
-#endif
 #ifdef Q_OS_ANDROID
     QGuiApplication app(argc, argv);
     QQuickStyle::setStyle(QStringLiteral("org.kde.breeze"));
diff --git a/src/app/permissionmanager.cpp b/src/app/permissionmanager.cpp
index 29d6f9174..6e79fd4f4 100644
--- a/src/app/permissionmanager.cpp
+++ b/src/app/permissionmanager.cpp
@@ -9,12 +9,8 @@
 
 #ifdef Q_OS_ANDROID
 #include <KAndroidExtras/ManifestPermission>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#else
 #include <private/qandroidextras_p.h>
 #endif
-#endif
 
 #ifdef Q_OS_ANDROID
 static QString permissionName(Permission::Permission p)
@@ -42,19 +38,11 @@ bool PermissionManager::checkPermission(Permission::Permission permission)
         return false;
     }
 #ifdef Q_OS_ANDROID
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    if (permission == Permission::PostNotification && QtAndroid::androidSdkVersion() < 33) {
-        return true;
-    }
-
-    return QtAndroid::checkPermission(permissionName(permission)) == QtAndroid::PermissionResult::Granted;
-#else
     if (permission == Permission::PostNotification && QtAndroidPrivate::androidSdkVersion() < 33) {
         return true;
     }
 
     return QtAndroidPrivate::checkPermission(permissionName(permission)).result() == QtAndroidPrivate::PermissionResult::Authorized;
-#endif
 #else // non-Android
     Q_UNUSED(permission);
     return true;
@@ -76,14 +64,6 @@ void PermissionManager::requestPermission(Permission::Permission permission, QJS
     }
 
 #ifdef Q_OS_ANDROID
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QtAndroid::requestPermissions({permissionName(permission)}, [permission, callback] (const QtAndroid::PermissionResultMap &result) {
-        if (result[permissionName(permission)] == QtAndroid::PermissionResult::Granted) {
-            auto cb = callback;
-            cb.call();
-        }
-    });
-#else
     // TODO make this properly async
     if (QtAndroidPrivate::checkPermission(permissionName(permission)).result() != QtAndroidPrivate::PermissionResult::Authorized) {
         if (QtAndroidPrivate::requestPermission(permissionName(permission)).result() != QtAndroidPrivate::PermissionResult::Authorized) {
@@ -92,7 +72,6 @@ void PermissionManager::requestPermission(Permission::Permission permission, QJS
     }
     callback.call();
 #endif
-#endif
 }
 
 #include "moc_permissionmanager.cpp"
diff --git a/src/app/reservationhelper.cpp b/src/app/reservationhelper.cpp
index bf7ad5528..7c88762c1 100644
--- a/src/app/reservationhelper.cpp
+++ b/src/app/reservationhelper.cpp
@@ -18,17 +18,6 @@
 
 using namespace KItinerary;
 
-void ReservationHelper::setup()
-{
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QMetaType::registerEqualsComparator<BusTrip>();
-    QMetaType::registerEqualsComparator<Flight>();
-    QMetaType::registerEqualsComparator<Person>();
-    QMetaType::registerEqualsComparator<Ticket>();
-    QMetaType::registerEqualsComparator<TrainTrip>();
-#endif
-}
-
 std::pair<QString, QString> ReservationHelper::lineNameAndNumber(const QVariant &res)
 {
     if (JsonLd::isA<TrainReservation>(res)) {
diff --git a/src/app/reservationhelper.h b/src/app/reservationhelper.h
index 11b2b5d71..16e89cc77 100644
--- a/src/app/reservationhelper.h
+++ b/src/app/reservationhelper.h
@@ -15,11 +15,6 @@ class QVariant;
 /** Helper methods for dealing with KItinerary reservation elements. */
 namespace ReservationHelper
 {
-    /** Type registration setup.
-     *  @todo This should happen automatically in KItinerary!
-     */
-    void setup();
-
     std::pair<QString, QString> lineNameAndNumber(const QVariant &res);
 
     bool equals(const QVariant &lhs, const QVariant &rhs);
diff --git a/src/app/reservationmanager.cpp b/src/app/reservationmanager.cpp
index b9649d247..d3378481e 100644
--- a/src/app/reservationmanager.cpp
+++ b/src/app/reservationmanager.cpp
@@ -10,7 +10,6 @@
 #include "logging.h"
 #include "reservationhelper.h"
 
-#include <kitinerary_version.h>
 #include <KItinerary/ExtractorPostprocessor>
 #include <KItinerary/Event>
 #include <KItinerary/Flight>
@@ -36,26 +35,9 @@
 
 using namespace KItinerary;
 
-static bool isSameTrip(const QVariant &lhs, const QVariant &rhs)
-{
-#if KITINERARY_VERSION < QT_VERSION_CHECK(5, 23, 41)
-    if (lhs.userType() != rhs.userType() || !JsonLd::canConvert<Reservation>(lhs) || !JsonLd::canConvert<Reservation>(rhs)) {
-        return false;
-    }
-
-    const auto lhsTrip = JsonLd::convert<Reservation>(lhs).reservationFor();
-    const auto rhsTrip = JsonLd::convert<Reservation>(rhs).reservationFor();
-    return MergeUtil::isSame(lhsTrip, rhsTrip);
-#else
-    return MergeUtil::isSameIncidence(lhs, rhs);
-#endif
-}
-
 ReservationManager::ReservationManager(QObject* parent)
     : QObject(parent)
 {
-    ReservationHelper::setup();
-
     m_validator.setAcceptedTypes<
         BoatReservation,
         BusReservation,
@@ -201,7 +183,7 @@ QString ReservationManager::addReservation(const QVariant &res, const QString &r
             updateReservation(*it, newRes);
             return *it;
         }
-        if (isSameTrip(res, otherRes)) {
+        if (MergeUtil::isSameIncidence(res, otherRes)) {
             // this is a multi-traveler element, check if we have it as one of the batch elements already
             const auto &batch = m_batchToResMap.value(*it);
             for (const auto &batchedId : batch) {
@@ -405,7 +387,7 @@ void ReservationManager::updateBatch(const QString &resId, const QVariant &newRe
         if (SortUtil::startDateTime(otherRes) != SortUtil::startDateTime(newRes)) {
             break; // no hit
         }
-        if (isSameTrip(newRes, otherRes)) {
+        if (MergeUtil::isSameIncidence(newRes, otherRes)) {
             newBatchId = *it;
             break;
         }
@@ -510,7 +492,7 @@ QVector<QString> ReservationManager::applyPartialUpdate(const QVariant &res)
             updatedIds.push_back(*it);
             continue;
         }
-        if (isSameTrip(res, otherRes)) {
+        if (MergeUtil::isSameIncidence(res, otherRes)) {
             // this is a multi-traveler element, check if we have it as one of the batch elements already
             const auto &batch = m_batchToResMap.value(*it);
             for (const auto &batchedId : batch) {
diff --git a/src/app/transfermanager.cpp b/src/app/transfermanager.cpp
index fc3a5ed07..920e9b37c 100644
--- a/src/app/transfermanager.cpp
+++ b/src/app/transfermanager.cpp
@@ -17,7 +17,6 @@
 #include "tripgroup.h"
 #include "tripgroupmanager.h"
 
-#include <kitinerary_version.h>
 #include <KItinerary/BoatTrip>
 #include <KItinerary/BusTrip>
 #include <KItinerary/Event>
@@ -41,40 +40,6 @@
 
 using namespace KItinerary;
 
-// backward compatibility with 23.08
-#if KITINERARY_VERSION < QT_VERSION_CHECK(5, 240, 42)
-bool SortUtil::hasStartTime(const QVariant &elem)
-{
-    if (JsonLd::canConvert<Reservation>(elem)) {
-        return hasStartTime(JsonLd::convert<Reservation>(elem).reservationFor());
-    }
-    if (JsonLd::isA<TrainTrip>(elem)) {
-        return elem.value<TrainTrip>().departureTime().isValid();
-    }
-    if (JsonLd::isA<Flight>(elem)) {
-        return elem.value<Flight>().departureTime().isValid();
-    }
-
-    return SortUtil::startDateTime(elem).isValid();
-}
-
-bool SortUtil::hasEndTime(const QVariant &elem)
-{
-    if (JsonLd::canConvert<Reservation>(elem)) {
-        return hasEndTime(JsonLd::convert<Reservation>(elem).reservationFor());
-    }
-    if (JsonLd::isA<TrainTrip>(elem)) {
-        return elem.value<TrainTrip>().arrivalTime().isValid();
-    }
-    if (JsonLd::isA<Flight>(elem)) {
-        return elem.value<Flight>().arrivalTime().isValid();
-    }
-
-    return SortUtil::endDateTime(elem).isValid();
-}
-#endif
-
-
 // bump this to trigger a full rescan for transfers
 enum { CurrentFullScanVersion = 1 };
 
diff --git a/src/app/unitconversion.cpp b/src/app/unitconversion.cpp
index 9573512ec..24f47405b 100644
--- a/src/app/unitconversion.cpp
+++ b/src/app/unitconversion.cpp
@@ -8,24 +8,10 @@
 
 #include <KUnitConversion/Value>
 
-#include <QScopedValueRollback>
-
 #include <cmath>
 
 double UnitConversion::convertCurrency(double price, const QString &fromCurrency, const QString &toCurrency)
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    // HACK work around KUnitConversion's internal currency update event loop causing us to re-enter here again
-    // which would then subsequently deadlock in KUnitConversion
-    static bool s_entrancyGuard = false;
-    if (s_entrancyGuard) {
-        qCWarning(Log) << "Imminent KUnitConversion deadlock detected, skipping currency conversion!";
-        return NAN;
-    }
-    QScopedValueRollback rollback(s_entrancyGuard, false);
-    s_entrancyGuard = true;
-#endif
-
     if (fromCurrency.isEmpty() || toCurrency.isEmpty() || fromCurrency == toCurrency) {
         return NAN;
     }
diff --git a/src/calendarextras/androidcalendar.cpp b/src/calendarextras/androidcalendar.cpp
index 320b1098d..cac0f0fa0 100644
--- a/src/calendarextras/androidcalendar.cpp
+++ b/src/calendarextras/androidcalendar.cpp
@@ -10,35 +10,18 @@
 
 #include <QCoreApplication>
 #include <QDebug>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#endif
 
 using namespace KAndroidExtras;
 
 AndroidCalendar::AndroidCalendar(const QTimeZone &tz, const QString &owner, jlong id)
     : KCalendarCore::Calendar(tz)
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    , m_calendar(Jni::fromHandle<android::content::Context>(QtAndroid::androidContext()), id)
-#else
     , m_calendar(Jni::fromHandle<android::content::Context>(QJniObject(QNativeInterface::QAndroidApplication::context())), id)
-#endif
     , m_owner(owner)
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    setDeletionTracking(false);
-#endif
 }
 
 AndroidCalendar::~AndroidCalendar() = default;
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-void AndroidCalendar::close()
-{
-    m_incidences.clear();
-}
-#endif
-
 bool AndroidCalendar::deleteIncidenceInstances(const KCalendarCore::Incidence::Ptr &incidence)
 {
     switch (incidence->type()) {
@@ -65,13 +48,6 @@ KCalendarCore::Event::List AndroidCalendar::rawEvents(KCalendarCore::EventSortFi
     return sortEvents(std::move(result), sortField, sortDirection);
 }
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-KCalendarCore::Event::List AndroidCalendar::rawEventsForDate(const QDateTime &dt) const
-{
-    return rawEventsForDate(dt.date(), dt.timeZone());
-}
-#endif
-
 bool AndroidCalendar::addEvent(const KCalendarCore::Event::Ptr &event)
 {
     // set the organizer to the calendar owner if not otherwise specified
@@ -154,24 +130,6 @@ KCalendarCore::Event::Ptr AndroidCalendar::event(const QString &uid, const QDate
     return event;
 }
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-KCalendarCore::Event::Ptr AndroidCalendar::deletedEvent(const QString &uid, const QDateTime& recurrenceId) const
-{
-    // deletion tracking not supported
-    Q_UNUSED(uid);
-    Q_UNUSED(recurrenceId);
-    return {};
-}
-
-KCalendarCore::Event::List AndroidCalendar::deletedEvents(KCalendarCore::EventSortField sortField, KCalendarCore::SortDirection sortDirection) const
-{
-    // deletion tracking not supported
-    Q_UNUSED(sortField);
-    Q_UNUSED(sortDirection);
-    return {};
-}
-#endif
-
 KCalendarCore::Event::List AndroidCalendar::eventInstances(const KCalendarCore::Incidence::Ptr &event, KCalendarCore::EventSortField sortField, KCalendarCore::SortDirection sortDirection) const
 {
     const auto jniEvents = m_calendar.eventInstances(event->uid());
@@ -231,24 +189,6 @@ KCalendarCore::Todo::Ptr AndroidCalendar::todo(const QString &uid, const QDateTi
     return {};
 }
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-KCalendarCore::Todo::Ptr AndroidCalendar::deletedTodo(const QString &uid, const QDateTime& recurrenceId) const
-{
-    // deletion tracking not supported
-    Q_UNUSED(uid);
-    Q_UNUSED(recurrenceId);
-    return {};
-}
-
-KCalendarCore::Todo::List AndroidCalendar::deletedTodos(KCalendarCore::TodoSortField sortField, KCalendarCore::SortDirection sortDirection) const
-{
-    // deletion tracking not supported
-    Q_UNUSED(sortField);
-    Q_UNUSED(sortDirection);
-    return {};
-}
-#endif
-
 KCalendarCore::Todo::List AndroidCalendar::todoInstances(const KCalendarCore::Incidence::Ptr &todo, KCalendarCore::TodoSortField sortField, KCalendarCore::SortDirection sortDirection) const
 {
     Q_UNUSED(todo);
@@ -297,22 +237,6 @@ KCalendarCore::Journal::Ptr AndroidCalendar::journal(const QString &uid, const Q
     return {};
 }
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-KCalendarCore::Journal::Ptr AndroidCalendar::deletedJournal(const QString& uid, const QDateTime& recurrenceId) const
-{
-    Q_UNUSED(uid);
-    Q_UNUSED(recurrenceId);
-    return {};
-}
-
-KCalendarCore::Journal::List AndroidCalendar::deletedJournals(KCalendarCore::JournalSortField sortField, KCalendarCore::SortDirection sortDirection) const
-{
-    Q_UNUSED(sortField);
-    Q_UNUSED(sortDirection);
-    return {};
-}
-#endif
-
 KCalendarCore::Journal::List AndroidCalendar::journalInstances(const KCalendarCore::Incidence::Ptr &journal, KCalendarCore::JournalSortField sortField, KCalendarCore::SortDirection sortDirection) const
 {
     Q_UNUSED(journal);
diff --git a/src/calendarextras/androidcalendar.h b/src/calendarextras/androidcalendar.h
index cbb51e11b..19136d36f 100644
--- a/src/calendarextras/androidcalendar.h
+++ b/src/calendarextras/androidcalendar.h
@@ -23,25 +23,15 @@ public:
     ~AndroidCalendar();
 
     // KCalendarCore::Calendar interface
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    void close() override;
-#endif
     bool deleteIncidenceInstances(const KCalendarCore::Incidence::Ptr &incidence) override;
 
     bool addEvent(const KCalendarCore::Event::Ptr &event) override;
     bool deleteEvent(const KCalendarCore::Event::Ptr &event) override;
     bool deleteEventInstances(const KCalendarCore::Event::Ptr &event) override;
     KCalendarCore::Event::List rawEvents(KCalendarCore::EventSortField sortField = KCalendarCore::EventSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    KCalendarCore::Event::List rawEventsForDate(const QDateTime &dt) const override;
-#endif
     KCalendarCore::Event::List rawEvents(const QDate &start, const QDate &end, const QTimeZone &timeZone = {}, bool inclusive = false) const override;
     KCalendarCore::Event::List rawEventsForDate(const QDate &date,  const QTimeZone &timeZone = {}, KCalendarCore::EventSortField sortField = KCalendarCore::EventSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
     KCalendarCore::Event::Ptr event(const QString &uid, const QDateTime &recurrenceId = {}) const override;
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    KCalendarCore::Event::Ptr deletedEvent(const QString &uid, const QDateTime &recurrenceId = {}) const override;
-    KCalendarCore::Event::List deletedEvents(KCalendarCore::EventSortField sortField = KCalendarCore::EventSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
-#endif
     KCalendarCore::Event::List eventInstances(const KCalendarCore::Incidence::Ptr &event, KCalendarCore::EventSortField sortField = KCalendarCore::EventSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
 
     bool addTodo(const KCalendarCore::Todo::Ptr &todo) override;
@@ -51,10 +41,6 @@ public:
     KCalendarCore::Todo::List rawTodosForDate(const QDate &date) const override;
     KCalendarCore::Todo::List rawTodos(const QDate &start, const QDate &end, const QTimeZone &timeZone = {}, bool inclusive = false) const override;
     KCalendarCore::Todo::Ptr todo(const QString &uid, const QDateTime &recurrenceId = {}) const override;
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    KCalendarCore::Todo::Ptr deletedTodo(const QString &uid, const QDateTime &recurrenceId = {}) const override;
-    KCalendarCore::Todo::List deletedTodos(KCalendarCore::TodoSortField sortField = KCalendarCore::TodoSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
-#endif
     KCalendarCore::Todo::List todoInstances(const KCalendarCore::Incidence::Ptr &todo, KCalendarCore::TodoSortField sortField = KCalendarCore::TodoSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
 
     bool addJournal(const KCalendarCore::Journal::Ptr &journal) override;
@@ -63,10 +49,6 @@ public:
     KCalendarCore::Journal::List rawJournals(KCalendarCore::JournalSortField sortField = KCalendarCore::JournalSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
     KCalendarCore::Journal::List rawJournalsForDate(const QDate &date) const override;
     KCalendarCore::Journal::Ptr journal(const QString &uid, const QDateTime &recurrenceId = {}) const override;
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    KCalendarCore::Journal::Ptr deletedJournal(const QString &uid, const QDateTime &recurrenceId = {}) const override;
-    KCalendarCore::Journal::List deletedJournals(KCalendarCore::JournalSortField sortField = KCalendarCore::JournalSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
-#endif
     KCalendarCore::Journal::List journalInstances(const KCalendarCore::Incidence::Ptr &journal, KCalendarCore::JournalSortField sortField = KCalendarCore::JournalSortUnsorted, KCalendarCore::SortDirection sortDirection = KCalendarCore::SortDirectionAscending) const override;
 
     KCalendarCore::Alarm::List alarms(const QDateTime &from, const QDateTime &to, bool excludeBlockedAlarms = false) const override;
diff --git a/src/calendarextras/androidcalendarplugin.cpp b/src/calendarextras/androidcalendarplugin.cpp
index 291813868..d002f67f7 100644
--- a/src/calendarextras/androidcalendarplugin.cpp
+++ b/src/calendarextras/androidcalendarplugin.cpp
@@ -13,20 +13,13 @@
 
 #include <QCoreApplication>
 #include <QDebug>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#endif
 
 using namespace KCalendarCore;
 using namespace KAndroidExtras;
 
 AndroidCalendarPlugin::AndroidCalendarPlugin(QObject *parent, const QVariantList &args)
     : CalendarPlugin(parent, args)
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    , m_jni(Jni::fromHandle<android::content::Context>(QtAndroid::androidContext()))
-#else
     , m_jni(Jni::fromHandle<android::content::Context>(QJniObject(QNativeInterface::QAndroidApplication::context())))
-#endif
 {
 }
 
diff --git a/src/kandroidextras/android/activity.cpp b/src/kandroidextras/android/activity.cpp
index 6304b2505..a9387d7b2 100644
--- a/src/kandroidextras/android/activity.cpp
+++ b/src/kandroidextras/android/activity.cpp
@@ -10,27 +10,15 @@
 #include <KAndroidExtras/Intent>
 #include <KAndroidExtras/JniSignature>
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#include <QAndroidJniEnvironment>
-#else
 #include <QCoreApplication>
 #include <QJniEnvironment>
-using QJniEnvironment = QAndroidJniEnvironment;
-
 #include <private/qandroidextras_p.h>
-#endif
 
 using namespace KAndroidExtras;
 
 Intent Activity::getIntent()
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto activity = QtAndroid::androidActivity();
-#else
     const QJniObject activity = QNativeInterface::QAndroidApplication::context();
-#endif
-
     if (!activity.isValid())
         return {};
 
@@ -40,12 +28,8 @@ Intent Activity::getIntent()
 
 bool Activity::startActivity(const Intent &intent, int receiverRequestCode)
 {
-    QAndroidJniEnvironment jniEnv;
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QtAndroid::startActivity(intent, receiverRequestCode);
-#else
+    QJniEnvironment jniEnv;
     QtAndroidPrivate::startActivity(intent, receiverRequestCode);
-#endif
     if (jniEnv->ExceptionCheck()) {
         jniEnv->ExceptionClear();
         return false;
diff --git a/src/kandroidextras/android/contentresolver.cpp b/src/kandroidextras/android/contentresolver.cpp
index e6e0049b8..3b40a6966 100644
--- a/src/kandroidextras/android/contentresolver.cpp
+++ b/src/kandroidextras/android/contentresolver.cpp
@@ -11,25 +11,15 @@
 #include <KAndroidExtras/AndroidTypes>
 #include <KAndroidExtras/JniSignature>
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#include <QAndroidJniObject>
-#else
 #include <QCoreApplication>
-#endif
-
 #include <QString>
 #include <QUrl>
 
 using namespace KAndroidExtras;
 
-QAndroidJniObject ContentResolver::get()
+QJniObject ContentResolver::get()
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto context = QtAndroid::androidContext();
-#else
     const QJniObject context = QNativeInterface::QAndroidApplication::context();
-#endif
     return context.callObjectMethod("getContentResolver", Jni::signature<android::content::ContentResolver()>());
 }
 
@@ -49,7 +39,7 @@ QString ContentResolver::fileName(const QUrl &url)
     // query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder)
     auto cursor = cs.callObjectMethod("query", Jni::signature<android::database::Cursor(android::net::Uri, java::lang::String[], java::lang::String, java::lang::String[], java::lang::String)>(), uri.object<jobject>(), 0, 0, 0, 0);
 
-    const QAndroidJniObject DISPLAY_NAME = OpenableColumns::DISPLAY_NAME;
+    const QJniObject DISPLAY_NAME = OpenableColumns::DISPLAY_NAME;
     const auto nameIndex = cursor.callMethod<jint>("getColumnIndex", (const char*)Jni::signature<int(java::lang::String)>(), DISPLAY_NAME.object());
     cursor.callMethod<jboolean>("moveToFirst", (const char*)Jni::signature<bool()>());
     return cursor.callObjectMethod("getString", Jni::signature<java::lang::String(int)>(), nameIndex).toString();
diff --git a/src/kandroidextras/android/contentresolver.h b/src/kandroidextras/android/contentresolver.h
index 3731b4409..5d36f3069 100644
--- a/src/kandroidextras/android/contentresolver.h
+++ b/src/kandroidextras/android/contentresolver.h
@@ -10,12 +10,7 @@
 #include "kandroidextras_export.h"
 
 #include <qglobal.h>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-class QAndroidJniObject;
-#else
 class QJniObject;
-using QAndroidJniObject = QJniObject;
-#endif
 class QString;
 class QUrl;
 
@@ -25,7 +20,7 @@ namespace KAndroidExtras {
 namespace ContentResolver
 {
     /** Get the JNI content resolver. */
-    KANDROIDEXTRAS_EXPORT QAndroidJniObject get();
+    KANDROIDEXTRAS_EXPORT QJniObject get();
 
     /** Returns the mime type of the given content: URL.
      * @see Android ContentResolver.getType
diff --git a/src/kandroidextras/android/context.cpp b/src/kandroidextras/android/context.cpp
index a91bbee49..c7d1db911 100644
--- a/src/kandroidextras/android/context.cpp
+++ b/src/kandroidextras/android/context.cpp
@@ -9,20 +9,12 @@
 #include <KAndroidExtras/JavaTypes>
 #include <KAndroidExtras/JniSignature>
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#else
 #include <QCoreApplication>
-#endif
 
 using namespace KAndroidExtras;
 
-QAndroidJniObject Context::getPackageName()
+QJniObject Context::getPackageName()
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto context = QtAndroid::androidContext();
-#else
     const QJniObject context = QNativeInterface::QAndroidApplication::context();
-#endif
     return context.callObjectMethod("getPackageName", Jni::signature<java::lang::String()>());
 }
diff --git a/src/kandroidextras/android/context.h b/src/kandroidextras/android/context.h
index 838a5a666..58ffcde5e 100644
--- a/src/kandroidextras/android/context.h
+++ b/src/kandroidextras/android/context.h
@@ -9,20 +9,14 @@
 
 #include "kandroidextras_export.h"
 
-#include <qglobal.h>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-class QAndroidJniObject;
-#else
 class QJniObject;
-using QAndroidJniObject = QJniObject;
-#endif
 
 namespace KAndroidExtras {
 
 /** Methods around android.content.Context. */
 namespace Context
 {
-    KANDROIDEXTRAS_EXPORT QAndroidJniObject getPackageName();
+    KANDROIDEXTRAS_EXPORT QJniObject getPackageName();
 }
 
 }
diff --git a/src/kandroidextras/android/intent.cpp b/src/kandroidextras/android/intent.cpp
index 57622a8cf..3e1c01d90 100644
--- a/src/kandroidextras/android/intent.cpp
+++ b/src/kandroidextras/android/intent.cpp
@@ -16,23 +16,23 @@ using namespace KAndroidExtras;
 
 Intent::~Intent() = default;
 
-Intent::operator QAndroidJniObject() const
+Intent::operator QJniObject() const
 {
     return jniHandle();
 }
 
 template <typename T>
-QAndroidJniObject Intent::getObjectExtra(const char *methodName, const QAndroidJniObject &name) const
+QJniObject Intent::getObjectExtra(const char *methodName, const QJniObject &name) const
 {
     return jniHandle().callObjectMethod(methodName, Jni::signature<T(java::lang::String)>(), name.object());
 }
 
-QString Intent::getStringExtra(const QAndroidJniObject &name) const
+QString Intent::getStringExtra(const QJniObject &name) const
 {
     return getObjectExtra<java::lang::String>("getStringExtra", name).toString();
 }
 
-QStringList Intent::getStringArrayExtra(const QAndroidJniObject &name) const
+QStringList Intent::getStringArrayExtra(const QJniObject &name) const
 {
     const auto extra = getObjectExtra<Jni::Array<java::lang::String>>("getStringArrayExtra", name);
     return Jni::fromArray<QStringList>(extra);
diff --git a/src/kandroidextras/android/intent.h b/src/kandroidextras/android/intent.h
index 5cc61d9e3..a55341e16 100644
--- a/src/kandroidextras/android/intent.h
+++ b/src/kandroidextras/android/intent.h
@@ -50,17 +50,17 @@ public:
     JNI_METHOD(android::content::Intent, setType, java::lang::String)
 
     /** Read extra intent data. */
-    QString getStringExtra(const QAndroidJniObject &name) const;
-    QStringList getStringArrayExtra(const QAndroidJniObject &name) const;
+    QString getStringExtra(const QJniObject &name) const;
+    QStringList getStringArrayExtra(const QJniObject &name) const;
     /** Add extra intent data of type @tparam T. */
     template <typename T>
-    inline void putExtra(const QAndroidJniObject &name, const QAndroidJniObject &value)
+    inline void putExtra(const QJniObject &name, const QJniObject &value)
     {
         jniHandle().callObjectMethod("putExtra", Jni::signature<android::content::Intent(java::lang::String, T)>(), name.object(), value.object());
     }
 
-    /** Implicit conversion to an QAndroidJniObject. */
-    operator QAndroidJniObject() const;
+    /** Implicit conversion to an QJniObject. */
+    operator QJniObject() const;
 
     /** Action constant for create document intents. */
     JNI_CONSTANT(java::lang::String, ACTION_CREATE_DOCUMENT)
@@ -90,7 +90,7 @@ public:
 
 private:
     template <typename T>
-    QAndroidJniObject getObjectExtra(const char* methodName, const QAndroidJniObject &name) const;
+    QJniObject getObjectExtra(const char* methodName, const QJniObject &name) const;
 };
 
 }
diff --git a/src/kandroidextras/android/uri.cpp b/src/kandroidextras/android/uri.cpp
index e80b266a7..e2e93a585 100644
--- a/src/kandroidextras/android/uri.cpp
+++ b/src/kandroidextras/android/uri.cpp
@@ -11,13 +11,13 @@
 
 using namespace KAndroidExtras;
 
-QAndroidJniObject Uri::fromUrl(const QUrl &url)
+QJniObject Uri::fromUrl(const QUrl &url)
 {
-    return QAndroidJniObject::callStaticObjectMethod(Jni::typeName<android::net::Uri>(), "parse", Jni::signature<android::net::Uri(java::lang::String)>(),
-        QAndroidJniObject::fromString(url.toString(QUrl::FullyEncoded)).object<jstring>());
+    return QJniObject::callStaticObjectMethod(Jni::typeName<android::net::Uri>(), "parse", Jni::signature<android::net::Uri(java::lang::String)>(),
+        QJniObject::fromString(url.toString(QUrl::FullyEncoded)).object<jstring>());
 }
 
-QUrl Uri::toUrl(const QAndroidJniObject &uri)
+QUrl Uri::toUrl(const QJniObject &uri)
 {
     if (!uri.isValid()) {
         return QUrl();
diff --git a/src/kandroidextras/android/uri.h b/src/kandroidextras/android/uri.h
index 5af99e173..808ceb9f1 100644
--- a/src/kandroidextras/android/uri.h
+++ b/src/kandroidextras/android/uri.h
@@ -20,10 +20,10 @@ namespace KAndroidExtras {
 namespace Uri
 {
     /** Create an android.net.Uri from a QUrl. */
-    KANDROIDEXTRAS_EXPORT QAndroidJniObject fromUrl(const QUrl &url);
+    KANDROIDEXTRAS_EXPORT QJniObject fromUrl(const QUrl &url);
 
     /** Convert a android.net.Uri to a QUrl. */
-    KANDROIDEXTRAS_EXPORT QUrl toUrl(const QAndroidJniObject &uri);
+    KANDROIDEXTRAS_EXPORT QUrl toUrl(const QJniObject &uri);
 }
 
 JNI_DECLARE_CONVERTER(android::net::Uri, QUrl, (Uri::toUrl(value)), (Uri::fromUrl(value)))
diff --git a/src/kandroidextras/fake/qt5/QAndroidJniEnvironment b/src/kandroidextras/fake/qt5/QAndroidJniEnvironment
deleted file mode 100644
index ab1faf505..000000000
--- a/src/kandroidextras/fake/qt5/QAndroidJniEnvironment
+++ /dev/null
@@ -1,18 +0,0 @@
-/*
-    SPDX-FileCopyrightText: 2020 Volker Krause <vkrause@kde.org>
-
-    SPDX-License-Identifier: LGPL-2.0-or-later
-*/
-
-#ifndef KANDROIDEXTRAS_MOCK_QANDROIDJNIENVIRONMENT_H
-#define KANDROIDEXTRAS_MOCK_QANDROIDJNIENVIRONMENT_H
-
-#include "mock_jnienvironment.h"
-
-class QAndroidJniEnvironment : public KAndroidExtras::MockJniEnvironment
-{
-public:
-    inline operator JNIEnv*() const { return &m_env; }
-};
-
-#endif
diff --git a/src/kandroidextras/fake/qt5/QAndroidJniObject b/src/kandroidextras/fake/qt5/QAndroidJniObject
deleted file mode 100644
index b8c1f4283..000000000
--- a/src/kandroidextras/fake/qt5/QAndroidJniObject
+++ /dev/null
@@ -1,6 +0,0 @@
-/*
-    SPDX-FileCopyrightText: 2020 Volker Krause <vkrause@kde.org>
-
-    SPDX-License-Identifier: LGPL-2.0-or-later
-*/
-#include "qandroidjniobject.h"
diff --git a/src/kandroidextras/fake/qt5/QtAndroid b/src/kandroidextras/fake/qt5/QtAndroid
deleted file mode 100644
index 3b0e243cb..000000000
--- a/src/kandroidextras/fake/qt5/QtAndroid
+++ /dev/null
@@ -1,31 +0,0 @@
-/*
-    SPDX-FileCopyrightText: 2020 Volker Krause <vkrause@kde.org>
-
-    SPDX-License-Identifier: LGPL-2.0-or-later
-*/
-
-#ifndef FAKE_QANDROID_H
-#define FAKE_QANDROID_H
-
-#include <QAndroidJniObject>
-
-/** Mock object for QtAndroid namespace. */
-namespace QtAndroid {
-    inline QAndroidJniObject androidContext()
-    {
-        QAndroidJniObject obj;
-        obj.addToProtocol(QStringLiteral("global androidContext()"));
-        return obj;
-    }
-
-    inline QAndroidJniObject androidActivity()
-    {
-        QAndroidJniObject obj;
-        obj.addToProtocol(QStringLiteral("global androidActivity()"));
-        return obj;
-    }
-
-    inline void startActivity(const QAndroidJniObject&, int) {}
-}
-
-#endif
diff --git a/src/kandroidextras/fake/qt5/qandroidjniobject.h b/src/kandroidextras/fake/qt5/qandroidjniobject.h
deleted file mode 100644
index 7d24c0568..000000000
--- a/src/kandroidextras/fake/qt5/qandroidjniobject.h
+++ /dev/null
@@ -1,19 +0,0 @@
-/*
-    SPDX-FileCopyrightText: 2020-2022 Volker Krause <vkrause@kde.org>
-    SPDX-License-Identifier: LGPL-2.0-or-later
-*/
-
-#ifndef KANDROIDEXTRAS_MOCK_QANDROIDJNIOBJECT_H
-#define KANDROIDEXTRAS_MOCK_QANDROIDJNIOBJECT_H
-
-#include "mock_jniobject.h"
-
-/** Mock object for QJniObject outside of Android, for automated testing. */
-class KANDROIDEXTRAS_EXPORT QAndroidJniObject : public KAndroidExtras::Internal::MockJniObject<QAndroidJniObject> {
-public:
-    using MockJniObject<QAndroidJniObject>::MockJniObject;
-};
-
-Q_DECLARE_METATYPE(QAndroidJniObject)
-
-#endif
diff --git a/src/kandroidextras/java/javalocale.cpp b/src/kandroidextras/java/javalocale.cpp
index 48e6ca801..ab23f4c58 100644
--- a/src/kandroidextras/java/javalocale.cpp
+++ b/src/kandroidextras/java/javalocale.cpp
@@ -13,17 +13,17 @@
 
 using namespace KAndroidExtras;
 
-QAndroidJniObject Locale::fromLocale(const QLocale &locale)
+QJniObject Locale::fromLocale(const QLocale &locale)
 {
-    auto lang = QAndroidJniObject::fromString(QLocale::languageToString(locale.language()));
-    auto country = QAndroidJniObject::fromString(QLocale::countryToString(locale.country()));
-    auto script = QAndroidJniObject::fromString(QLocale::scriptToString(locale.script()));
+    auto lang = QJniObject::fromString(QLocale::languageToString(locale.language()));
+    auto country = QJniObject::fromString(QLocale::countryToString(locale.country()));
+    auto script = QJniObject::fromString(QLocale::scriptToString(locale.script()));
 
-    return QAndroidJniObject(Jni::typeName<java::util::Locale>(), (const char*)Jni::signature<void(java::lang::String, java::lang::String, java::lang::String)>(),
+    return QJniObject(Jni::typeName<java::util::Locale>(), (const char*)Jni::signature<void(java::lang::String, java::lang::String, java::lang::String)>(),
         lang.object(), country.object(), script.object());
 }
 
-QAndroidJniObject Locale::current()
+QJniObject Locale::current()
 {
     return fromLocale(QLocale());
 }
diff --git a/src/kandroidextras/java/javalocale.h b/src/kandroidextras/java/javalocale.h
index a6ef2ed76..ced8e6fc6 100644
--- a/src/kandroidextras/java/javalocale.h
+++ b/src/kandroidextras/java/javalocale.h
@@ -9,13 +9,7 @@
 
 #include "kandroidextras_export.h"
 
-#include <qglobal.h>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-class QAndroidJniObject;
-#else
 class QJniObject;
-using QAndroidJniObject = QJniObject;
-#endif
 class QLocale;
 
 namespace KAndroidExtras {
@@ -27,10 +21,10 @@ namespace KAndroidExtras {
 namespace Locale
 {
     /** Create an java.util.Locale object from a QLocale. */
-    KANDROIDEXTRAS_EXPORT QAndroidJniObject fromLocale(const QLocale &locale);
+    KANDROIDEXTRAS_EXPORT QJniObject fromLocale(const QLocale &locale);
 
     /** Create an java.util.Locale object for the current QLocale. */
-    KANDROIDEXTRAS_EXPORT QAndroidJniObject current();
+    KANDROIDEXTRAS_EXPORT QJniObject current();
 }
 
 }
diff --git a/src/kandroidextras/java/javatypes.h b/src/kandroidextras/java/javatypes.h
index 260e6ff7c..36fd4be40 100644
--- a/src/kandroidextras/java/javatypes.h
+++ b/src/kandroidextras/java/javatypes.h
@@ -16,7 +16,7 @@ JNI_TYPE(java, io, File)
 JNI_TYPE(java, lang, String)
 JNI_TYPE(java, util, Locale)
 
-JNI_DECLARE_CONVERTER(java::lang::String, QString, (value.toString()), (QAndroidJniObject::fromString(value)))
+JNI_DECLARE_CONVERTER(java::lang::String, QString, (value.toString()), (QJniObject::fromString(value)))
 
 }
 
diff --git a/src/kandroidextras/jni/jniarray.h b/src/kandroidextras/jni/jniarray.h
index 84bd48a39..7464f1e3f 100644
--- a/src/kandroidextras/jni/jniarray.h
+++ b/src/kandroidextras/jni/jniarray.h
@@ -11,12 +11,7 @@
 #include "jnireturnvalue.h"
 #include "jnitypetraits.h"
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QAndroidJniEnvironment>
-#else
 #include <QJniEnvironment>
-using QAndroidJniEnvironment = QJniEnvironment;
-#endif
 
 namespace KAndroidExtras {
 
@@ -31,10 +26,10 @@ template <typename T> struct array_trait {
 #define MAKE_ARRAY_TRAIT(base_type, type_name) \
 template <> struct array_trait<base_type> { \
     typedef base_type ## Array type; \
-    static inline type newArray(QAndroidJniEnvironment &env, jsize size) { return env->New ## type_name ## Array(size); } \
-    static inline base_type* getArrayElements(QAndroidJniEnvironment &env, type array, jboolean *isCopy) { return env->Get ## type_name ## ArrayElements(array, isCopy); } \
-    static inline void releaseArrayElements(QAndroidJniEnvironment &env, type array, base_type *data, jint mode) { return env->Release ## type_name ## ArrayElements(array, data, mode); } \
-    static inline void setArrayRegion(QAndroidJniEnvironment &env, type array, jsize start, jsize length, const base_type *data) { env->Set ## type_name ## ArrayRegion(array, start, length, data); } \
+    static inline type newArray(QJniEnvironment &env, jsize size) { return env->New ## type_name ## Array(size); } \
+    static inline base_type* getArrayElements(QJniEnvironment &env, type array, jboolean *isCopy) { return env->Get ## type_name ## ArrayElements(array, isCopy); } \
+    static inline void releaseArrayElements(QJniEnvironment &env, type array, base_type *data, jint mode) { return env->Release ## type_name ## ArrayElements(array, data, mode); } \
+    static inline void setArrayRegion(QJniEnvironment &env, type array, jsize start, jsize length, const base_type *data) { env->Set ## type_name ## ArrayRegion(array, start, length, data); } \
 };
 
 MAKE_ARRAY_TRAIT(jboolean, Boolean)
@@ -52,20 +47,20 @@ MAKE_ARRAY_TRAIT(jdouble, Double)
 template <typename Container, typename Value, bool is_primitive> struct FromArray {};
 
 template <typename Container>
-struct FromArray<Container, QAndroidJniObject, false>
+struct FromArray<Container, QJniObject, false>
 {
-    inline auto operator()(const QAndroidJniObject &array) const
+    inline auto operator()(const QJniObject &array) const
     {
         if (!array.isValid()) {
             return Container{};
         }
         const auto a = static_cast<jobjectArray>(array.object());
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         const auto size = env->GetArrayLength(a);
         Container r;
         r.reserve(size);
         for (auto i = 0; i < size; ++i) {
-            r.push_back(QAndroidJniObject::fromLocalRef(env->GetObjectArrayElement(a, i)));
+            r.push_back(QJniObject::fromLocalRef(env->GetObjectArrayElement(a, i)));
         }
         return r;
     }
@@ -74,18 +69,18 @@ struct FromArray<Container, QAndroidJniObject, false>
 template <typename Container, typename Value>
 struct FromArray<Container, Value, false>
 {
-    inline auto operator()(const QAndroidJniObject &array) const
+    inline auto operator()(const QJniObject &array) const
     {
         if (!array.isValid()) {
             return Container{};
         }
         const auto a = static_cast<jobjectArray>(array.object());
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         const auto size = env->GetArrayLength(a);
         Container r;
         r.reserve(size);
         for (auto i = 0; i < size; ++i) {
-            r.push_back(Jni::reverse_converter<Value>::type::convert(QAndroidJniObject::fromLocalRef(env->GetObjectArrayElement(a, i))));
+            r.push_back(Jni::reverse_converter<Value>::type::convert(QJniObject::fromLocalRef(env->GetObjectArrayElement(a, i))));
         }
         return r;
     }
@@ -96,14 +91,14 @@ template <typename Container, typename Value>
 struct FromArray<Container, Value, true>
 {
     typedef array_trait<Value> _t;
-    inline auto operator()(const QAndroidJniObject &array) const
+    inline auto operator()(const QJniObject &array) const
     {
         if (!array.isValid()) {
             return Container{};
         }
 
         const auto a = static_cast<typename _t::type>(array.object());
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         const auto size = env->GetArrayLength(a);
         Container r;
         r.reserve(size);
@@ -125,7 +120,7 @@ public:
     typedef jsize difference_type;
 
     ArrayImplBase() = default;
-    inline ArrayImplBase(const QAndroidJniObject &array) : m_array(array) {}
+    inline ArrayImplBase(const QJniObject &array) : m_array(array) {}
     ArrayImplBase(const ArrayImplBase &) = default;
     ArrayImplBase(ArrayImplBase &&) = default;
 
@@ -135,21 +130,21 @@ public:
             return 0;
         }
         const auto a = static_cast<typename _t::type>(m_array.object());
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         return env->GetArrayLength(a);
     }
 
-    inline operator QAndroidJniObject() const {
+    inline operator QJniObject() const {
         return m_array;
     }
-    inline QAndroidJniObject jniHandle() const { return m_array; }
+    inline QJniObject jniHandle() const { return m_array; }
 
 protected:
     typedef array_trait<T> _t;
 
     typename _t::type handle() const { return static_cast<typename _t::type>(m_array.object()); }
 
-    QAndroidJniObject m_array;
+    QJniObject m_array;
 };
 
 template <typename T, bool is_primitive>
@@ -161,7 +156,7 @@ class ArrayImpl<T, true> : public ArrayImplBase<T>
 {
     static_assert(!Internal::is_invalid_primitive_type<T>::value, "Using an incompatible primitive type!");
 public:
-    inline ArrayImpl(const QAndroidJniObject &array)
+    inline ArrayImpl(const QJniObject &array)
         : ArrayImplBase<T>(array)
     {
         // ### do this on demand?
@@ -171,8 +166,8 @@ public:
     /** Create a new array with @p size elements. */
     inline explicit ArrayImpl(jsize size)
     {
-        QAndroidJniEnvironment env;
-        ArrayImplBase<T>::m_array = QAndroidJniObject::fromLocalRef(ArrayImplBase<T>::_t::newArray(env, size));
+        QJniEnvironment env;
+        ArrayImplBase<T>::m_array = QJniObject::fromLocalRef(ArrayImplBase<T>::_t::newArray(env, size));
         getArrayElements();
     }
 
@@ -181,7 +176,7 @@ public:
     ArrayImpl(ArrayImpl&&) = default;
     ~ArrayImpl()
     {
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         ArrayImplBase<T>::_t::releaseArrayElements(env, this->handle(), m_data, JNI_ABORT);
     }
 
@@ -199,7 +194,7 @@ private:
         if (!ArrayImplBase<T>::m_array.isValid()) {
             return;
         }
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         m_data = ArrayImplBase<T>::_t::getArrayElements(env, this->handle(), nullptr);
     }
 
@@ -216,17 +211,17 @@ public:
     /** Create a new array with @p size elements initialized with @p value. */
     explicit inline ArrayImpl(jsize size, typename Internal::argument<T>::type value)
     {
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         auto clazz = env.findClass(Jni::typeName<T>());
-        ArrayImplBase<T>::m_array = QAndroidJniObject::fromLocalRef(env->NewObjectArray(size, clazz, Internal::argument<T>::toCallArgument(value)));
+        ArrayImplBase<T>::m_array = QJniObject::fromLocalRef(env->NewObjectArray(size, clazz, Internal::argument<T>::toCallArgument(value)));
     }
 
     /** Create a new array with @p size null elements. */
     explicit inline ArrayImpl(jsize size, std::nullptr_t = nullptr)
     {
-        QAndroidJniEnvironment env;
+        QJniEnvironment env;
         auto clazz = env.findClass(Jni::typeName<T>());
-        ArrayImplBase<T>::m_array = QAndroidJniObject::fromLocalRef(env->NewObjectArray(size, clazz, nullptr));
+        ArrayImplBase<T>::m_array = QJniObject::fromLocalRef(env->NewObjectArray(size, clazz, nullptr));
     }
 
     ArrayImpl() = default;
@@ -235,8 +230,8 @@ public:
 
     auto operator[](jsize index) const
     {
-        QAndroidJniEnvironment env;
-        return Internal::return_wrapper<T>::toReturnValue(QAndroidJniObject::fromLocalRef(env->GetObjectArrayElement(this->handle(), index)));
+        QJniEnvironment env;
+        return Internal::return_wrapper<T>::toReturnValue(QJniObject::fromLocalRef(env->GetObjectArrayElement(this->handle(), index)));
     }
 
     class ref
@@ -244,12 +239,12 @@ public:
     public:
         inline operator auto()
         {
-            QAndroidJniEnvironment env;
-            return Internal::return_wrapper<T>::toReturnValue(QAndroidJniObject::fromLocalRef(env->GetObjectArrayElement(c.handle(), index)));
+            QJniEnvironment env;
+            return Internal::return_wrapper<T>::toReturnValue(QJniObject::fromLocalRef(env->GetObjectArrayElement(c.handle(), index)));
         }
         inline ref& operator=(typename Internal::argument<T>::type v)
         {
-            QAndroidJniEnvironment env;
+            QJniEnvironment env;
             env->SetObjectArrayElement(c.handle(), index, Internal::argument<T>::toCallArgument(v));
             return *this;
         }
@@ -303,7 +298,7 @@ namespace Jni {
 
 /** Convert a JNI array to a C++ container.
     *  Container value types can be any of
-    *  - QAndroidJniObject
+    *  - QJniObject
     *  - a primitive JNI type
     *  - a type with a conversion defined with @c JNI_DECLARE_CONVERTER
     */
diff --git a/src/kandroidextras/jni/jnimethod.h b/src/kandroidextras/jni/jnimethod.h
index 65dbf5b9e..5362879aa 100644
--- a/src/kandroidextras/jni/jnimethod.h
+++ b/src/kandroidextras/jni/jnimethod.h
@@ -43,7 +43,7 @@ namespace Internal {
     struct caller {
         static_assert(!is_invalid_primitive_type<RetT>::value, "Using an incompatible primitive type!");
         template <typename ...Args>
-        static auto call(const QAndroidJniObject &handle, const char *name, const char *signature, Args&&... args)
+        static auto call(const QJniObject &handle, const char *name, const char *signature, Args&&... args)
         {
             if constexpr (std::is_same_v<RetT, void>) {
                 handle.callMethod<RetT>(name, signature, std::forward<Args>(args)...);
@@ -54,7 +54,7 @@ namespace Internal {
             }
         }
 
-        static auto call(const QAndroidJniObject &handle, const char *name, const char *signature)
+        static auto call(const QJniObject &handle, const char *name, const char *signature)
         {
             if constexpr (std::is_same_v<RetT, void>) {
                 return handle.callMethod<RetT>(name, signature);
@@ -74,21 +74,21 @@ namespace Internal {
         static auto call(const char *className, const char *name, const char *signature, Args&&... args)
         {
             if constexpr (std::is_same_v<RetT, void>) {
-                return QAndroidJniObject::callStaticMethod<RetT>(className, name, signature, std::forward<Args>(args)...);
+                return QJniObject::callStaticMethod<RetT>(className, name, signature, std::forward<Args>(args)...);
             } else if constexpr (Jni::is_primitive_type<RetT>::value) {
-                return Internal::return_wrapper<RetT>::toReturnValue(QAndroidJniObject::callStaticMethod<typename primitive_value<RetT>::JniType>(className, name, signature, std::forward<Args>(args)...));
+                return Internal::return_wrapper<RetT>::toReturnValue(QJniObject::callStaticMethod<typename primitive_value<RetT>::JniType>(className, name, signature, std::forward<Args>(args)...));
             } else {
-                return Internal::return_wrapper<RetT>::toReturnValue(QAndroidJniObject::callStaticObjectMethod(className, name, signature, std::forward<Args>(args)...));
+                return Internal::return_wrapper<RetT>::toReturnValue(QJniObject::callStaticObjectMethod(className, name, signature, std::forward<Args>(args)...));
             }
         }
         static auto call(const char *className, const char *name, const char *signature)
         {
             if constexpr (std::is_same_v<RetT, void>) {
-                return QAndroidJniObject::callStaticMethod<RetT>(className, name, signature);
+                return QJniObject::callStaticMethod<RetT>(className, name, signature);
             } else if constexpr (Jni::is_primitive_type<RetT>::value) {
-                return Internal::return_wrapper<RetT>::toReturnValue(QAndroidJniObject::callStaticMethod<typename primitive_value<RetT>::JniType>(className, name, signature));
+                return Internal::return_wrapper<RetT>::toReturnValue(QJniObject::callStaticMethod<typename primitive_value<RetT>::JniType>(className, name, signature));
             } else {
-                return Internal::return_wrapper<RetT>::toReturnValue(QAndroidJniObject::callStaticObjectMethod(className, name, signature));
+                return Internal::return_wrapper<RetT>::toReturnValue(QJniObject::callStaticObjectMethod(className, name, signature));
             }
         }
     };
@@ -100,18 +100,18 @@ namespace Internal {
  * This will add a method named @p Name to the current class. Argument types are checked at compile time,
  * with the following inputs being accepted:
  * - primitive types have to match exactly
- * - non-primitive types can be either passed as @c QAndroidJniObject instance or with a type that has an
+ * - non-primitive types can be either passed as @c QJniObject instance or with a type that has an
  *   conversion registered with @c JNI_DECLARE_CONVERTER.
  *
  * The return type of the method is determined as follows:
  * - primitive types are returned directly
- * - non-primitive types without a registered type conversion are returned as @c QAndroidJniObject.
+ * - non-primitive types without a registered type conversion are returned as @c QJniObject.
  * - non-primitive types with a registered type conversion are returned in a wrapper class that can
- *   be implicitly converted either to the destination type of the conversion, or a @c QAndroidJniObject.
+ *   be implicitly converted either to the destination type of the conversion, or a @c QJniObject.
  *   This allows to avoid type conversion when chaining calls for example, it however needs additional
  *   care when used in combination with automatic type deduction.
  * - array return types also result in a wrapper class that can be implicitly converted to a sequential
- *   container or a @p QAndroidJniObject representing the JNI array.
+ *   container or a @p QJniObject representing the JNI array.
  *
  * Thie macro can only be placed in classes having the @c JNI_OBJECT macro.
  *
@@ -131,18 +131,18 @@ inline auto Name( JNI_PARAMS(__VA_ARGS__) ) const { \
  * This will add a static method named @p Name to the current class. Argument types are checked at compile time,
  * with the following inputs being accepted:
  * - primitive types have to match exactly
- * - non-primitive types can be either passed as @c QAndroidJniObject instance or with a type that has an
+ * - non-primitive types can be either passed as @c QJniObject instance or with a type that has an
  *   conversion registered with @c JNI_DECLARE_CONVERTER.
  *
  * The return type of the method is determined as follows:
  * - primitive types are returned directly
- * - non-primitive types without a registered type conversion are returned as @c QAndroidJniObject.
+ * - non-primitive types without a registered type conversion are returned as @c QJniObject.
  * - non-primitive types with a registered type conversion are returned in a wrapper class that can
- *   be implicitly converted either to the destination type of the conversion, or a @c QAndroidJniObject.
+ *   be implicitly converted either to the destination type of the conversion, or a @c QJniObject.
  *   This allows to avoid type conversion when chaining calls for example, it however needs additional
  *   care when used in combination with automatic type deduction.
  * - array return types also result in a wrapper class that can be implicitly converted to a sequential
- *   container or a @p QAndroidJniObject representing the JNI array.
+ *   container or a @p QJniObject representing the JNI array.
  *
  * Thie macro can only be placed in classes having the @c JNI_UNMANAGED_OBJECT or @c JNI_OBJECT macro.
  *
@@ -162,7 +162,7 @@ static inline auto Name( JNI_PARAMS(__VA_ARGS__) ) { \
  * This will add a constructor named @p Name to the current class. Argument types are checked at compile time,
  * with the following inputs being accepted:
  * - primitive types have to match exactly
- * - non-primitive types can be either passed as @c QAndroidJniObject instance or with a type that has an
+ * - non-primitive types can be either passed as @c QJniObject instance or with a type that has an
  *   conversion registered with @c JNI_DECLARE_CONVERTER.
  *
  * Thie macro can only be placed in classes having @c JNI_OBJECT macro.
@@ -174,7 +174,7 @@ static inline auto Name( JNI_PARAMS(__VA_ARGS__) ) { \
 #define JNI_CONSTRUCTOR(Name, ...) \
 inline Name( JNI_PARAMS(__VA_ARGS__) ) { \
     using namespace KAndroidExtras; \
-    setJniHandle(QAndroidJniObject(Jni::typeName<_jni_ThisType>(), (const char*)Jni::signature<void(__VA_ARGS__)>() __VA_OPT__(,) JNI_ARGS(__VA_ARGS__))); \
+    setJniHandle(QJniObject(Jni::typeName<_jni_ThisType>(), (const char*)Jni::signature<void(__VA_ARGS__)>() __VA_OPT__(,) JNI_ARGS(__VA_ARGS__))); \
 }
 
 }
diff --git a/src/kandroidextras/jni/jniobject.h b/src/kandroidextras/jni/jniobject.h
index 1c1c3fa19..aa6a90c43 100644
--- a/src/kandroidextras/jni/jniobject.h
+++ b/src/kandroidextras/jni/jniobject.h
@@ -20,7 +20,7 @@ namespace Jni {
 template <typename T> class Object;
 
 template <typename T>
-inline QAndroidJniObject handle(const T &wrapper)
+inline QJniObject handle(const T &wrapper)
 {
     return wrapper.jniHandle();
 }
@@ -31,7 +31,7 @@ inline QAndroidJniObject handle(const T &wrapper)
  *  things will horribly go wrong.
  */
 template <typename T>
-inline auto fromHandle(const QAndroidJniObject &handle)
+inline auto fromHandle(const QJniObject &handle)
 {
     if constexpr (Jni::is_object_wrapper<T>::value) {
         return T(handle, Internal::FromHandleTag());
@@ -43,7 +43,7 @@ inline auto fromHandle(const QAndroidJniObject &handle)
 template <typename T>
 inline auto fromHandle(jobject handle)
 {
-    return fromHandle<T>(QAndroidJniObject(handle));
+    return fromHandle<T>(QJniObject(handle));
 }
 
 /** Wrapper for JNI objects with a convertible C++ type.
@@ -55,7 +55,7 @@ class Object {
 private:
     template <typename DummyT> class _dummy_t {};
 public:
-    inline explicit Object(const QAndroidJniObject &v) : m_handle(v) {}
+    inline explicit Object(const QJniObject &v) : m_handle(v) {}
 
     // implicit conversion from a compatible C++ type
     inline Object(const std::conditional_t<std::is_same_v<typename Jni::converter<T>::type, void>,
@@ -73,7 +73,7 @@ public:
     // and thus can't be consumed by another implicit conversion step
     template <typename StrT = QString, typename = std::enable_if_t<std::is_same_v<T, java::lang::String>, StrT>>
     inline Object(const QString &s)
-        : m_handle(QAndroidJniObject::fromString(s))
+        : m_handle(QJniObject::fromString(s))
     {}
 
     // special case for null values
@@ -81,18 +81,18 @@ public:
         : m_handle((jobject)nullptr)
     {}
 
-    inline operator QAndroidJniObject() const {
+    inline operator QJniObject() const {
         return m_handle;
     }
     inline operator typename Jni::converter<T>::type() const {
         return Jni::converter<T>::convert(m_handle);
     }
 
-    inline QAndroidJniObject jniHandle() const {
+    inline QJniObject jniHandle() const {
         return m_handle;
     }
 
-    // forward basic QAndroidJniObject API
+    // forward basic QJniObject API
     inline bool isValid() const {
         return m_handle.isValid();
     }
@@ -101,14 +101,14 @@ public:
         return m_handle.toString();
     }
 private:
-    QAndroidJniObject m_handle;
+    QJniObject m_handle;
 };
 
 /** Annotates a class for holding JNI method or property wrappers.
  *
  *  Use this if the class only has static methods or constants. For methods
  *  and properties, you either need to use @c JNI_OBJECT instead, or make
- *  sure there is a @p jniHandle() method returning a @c QAndroidJniObject
+ *  sure there is a @p jniHandle() method returning a @c QJniObject
  *  representing the current instance.
  *
  *  @param Class the name of the class this is added to.
@@ -132,12 +132,12 @@ private: \
 #define JNI_OBJECT(Class, BaseType) \
     JNI_UNMANAGED_OBJECT(Class, BaseType) \
 private: \
-    QAndroidJniObject _m_jni_handle; \
-    inline QAndroidJniObject jniHandle() const { return _m_jni_handle; } \
-    inline void setJniHandle(const QAndroidJniObject &h) { _m_jni_handle = h; } \
-    friend QAndroidJniObject KAndroidExtras::Jni::handle<Class>(const Class&); \
-    friend auto KAndroidExtras::Jni::fromHandle<Class>(const QAndroidJniObject&); \
-    explicit inline Class(const QAndroidJniObject &handle, KAndroidExtras::Internal::FromHandleTag) : _m_jni_handle(handle) {}
+    QJniObject _m_jni_handle; \
+    inline QJniObject jniHandle() const { return _m_jni_handle; } \
+    inline void setJniHandle(const QJniObject &h) { _m_jni_handle = h; } \
+    friend QJniObject KAndroidExtras::Jni::handle<Class>(const Class&); \
+    friend auto KAndroidExtras::Jni::fromHandle<Class>(const QJniObject&); \
+    explicit inline Class(const QJniObject &handle, KAndroidExtras::Internal::FromHandleTag) : _m_jni_handle(handle) {}
 
 }
 }
diff --git a/src/kandroidextras/jni/jniproperty.h b/src/kandroidextras/jni/jniproperty.h
index 3b92565e1..4e754d5c4 100644
--- a/src/kandroidextras/jni/jniproperty.h
+++ b/src/kandroidextras/jni/jniproperty.h
@@ -29,11 +29,11 @@ template <typename PropType, typename ClassType, typename NameHolder, bool Primi
 template <typename PropType, typename ClassType, typename NameHolder>
 struct StaticProperty<PropType, ClassType, NameHolder, false> {
     static_assert(!is_invalid_primitive_type<PropType>::value, "Using an incompatible primitive type!");
-    inline QAndroidJniObject get() const
+    inline QJniObject get() const
     {
-        return QAndroidJniObject::getStaticObjectField(Jni::typeName<ClassType>(), Jni::typeName<NameHolder>(), Jni::signature<PropType>());
+        return QJniObject::getStaticObjectField(Jni::typeName<ClassType>(), Jni::typeName<NameHolder>(), Jni::signature<PropType>());
     }
-    inline operator QAndroidJniObject() const
+    inline operator QJniObject() const
     {
         return get();
     }
@@ -52,7 +52,7 @@ template <typename PropType, typename ClassType, typename NameHolder>
 struct StaticProperty<PropType, ClassType, NameHolder, true> {
     inline operator auto() const
     {
-        return primitive_value<PropType>::fromJni(QAndroidJniObject::getStaticField<typename primitive_value<PropType>::JniType>(Jni::typeName<ClassType>(), Jni::typeName<NameHolder>()));
+        return primitive_value<PropType>::fromJni(QJniObject::getStaticField<typename primitive_value<PropType>::JniType>(Jni::typeName<ClassType>(), Jni::typeName<NameHolder>()));
     }
 };
 
@@ -60,7 +60,7 @@ struct StaticProperty<PropType, ClassType, NameHolder, true> {
 template <typename ClassType, typename OffsetHolder>
 class PropertyBase {
 protected:
-    inline QAndroidJniObject handle() const {
+    inline QJniObject handle() const {
         const auto owner = reinterpret_cast<const ClassType*>(reinterpret_cast<const char*>(this) - OffsetHolder::offset());
         return owner->jniHandle();
     }
@@ -74,11 +74,11 @@ private:
     struct _jni_NoType {};
     static_assert(!is_invalid_primitive_type<PropType>::value, "Using an incompatible primitive type!");
 public:
-    inline QAndroidJniObject get() const
+    inline QJniObject get() const
     {
         return this->handle().getObjectField(Jni::typeName<NameHolder>(), Jni::signature<PropType>());
     }
-    inline operator QAndroidJniObject() const
+    inline operator QJniObject() const
     {
         return get();
     }
@@ -102,7 +102,7 @@ public:
         this->handle().setField(Jni::typeName<NameHolder>(), Jni::signature<PropType>(), Internal::argument<PropType>::toCallArgument(value));
         return *this;
     }
-    inline Property& operator=(const QAndroidJniObject &value)
+    inline Property& operator=(const QJniObject &value)
     {
         this->handle().setField(Jni::typeName<NameHolder>(), Jni::signature<PropType>(), value.object());
         return *this;
diff --git a/src/kandroidextras/jni/jnireturnvalue.h b/src/kandroidextras/jni/jnireturnvalue.h
index ccd7df61d..b0f68dfc6 100644
--- a/src/kandroidextras/jni/jnireturnvalue.h
+++ b/src/kandroidextras/jni/jnireturnvalue.h
@@ -23,7 +23,7 @@ namespace Internal {
         static inline constexpr bool is_primitive = Jni::is_primitive_type<RetT>::value;
         static inline constexpr bool is_convertible = !std::is_same_v<typename Jni::converter<RetT>::type, void>;
 
-        typedef std::conditional_t<is_primitive, RetT, QAndroidJniObject> JniReturnT;
+        typedef std::conditional_t<is_primitive, RetT, QJniObject> JniReturnT;
 
     public:
         static inline constexpr auto toReturnValue(JniReturnT value)
@@ -42,7 +42,7 @@ namespace Internal {
     template <typename RetT>
     class return_wrapper<RetT, std::void_t<typename RetT::_jni_ThisType>> {
     public:
-        static inline auto toReturnValue(const QAndroidJniObject &value)
+        static inline auto toReturnValue(const QJniObject &value)
         {
             return Jni::fromHandle<RetT>(value);
         }
@@ -50,7 +50,7 @@ namespace Internal {
     template <typename RetT>
     class return_wrapper<Jni::Array<RetT>> {
     public:
-        static inline auto toReturnValue(const QAndroidJniObject &value)
+        static inline auto toReturnValue(const QJniObject &value)
         {
             return Jni::Array<RetT>(value);
         }
diff --git a/src/kandroidextras/jni/jnitypes.h b/src/kandroidextras/jni/jnitypes.h
index 2f2f855c5..b121f446e 100644
--- a/src/kandroidextras/jni/jnitypes.h
+++ b/src/kandroidextras/jni/jnitypes.h
@@ -9,7 +9,7 @@
 
 #include "jnipp.h"
 
-/** C++/Android integration utilities built on top of @c QAndroidJniObject. */
+/** C++/Android integration utilities built on top of @c QJniObject. */
 namespace KAndroidExtras {
 
 ///@cond internal
diff --git a/src/kandroidextras/jni/jnitypetraits.h b/src/kandroidextras/jni/jnitypetraits.h
index 901e2d067..c2599db93 100644
--- a/src/kandroidextras/jni/jnitypetraits.h
+++ b/src/kandroidextras/jni/jnitypetraits.h
@@ -10,13 +10,7 @@
 #include "jniprimitivetypes.h"
 #include "jnitypes.h"
 
-#include <qglobal.h>
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QAndroidJniObject>
-#else
 #include <QJniObject>
-using QAndroidJniObject = QJniObject;
-#endif
 
 namespace KAndroidExtras {
 
@@ -52,18 +46,18 @@ template <typename T> struct is_generic_wrapper : std::conditional_t<
  * Declare a JNI type to be convertible to a native type.
  * @param JniType A type declared with @p JNI_TYPE.
  * @param NativeType A C++ type @p JniType can be converted to/from.
- * @param FromJniFn Code converting a @c QAndroidJniObject @c value to @p NativeType.
- * @param ToJniCode converting a @p NativeType @c value to a QAndroidJniObject.
+ * @param FromJniFn Code converting a @c QJniObject @c value to @p NativeType.
+ * @param ToJniCode converting a @p NativeType @c value to a QJniObject.
  */
 #define JNI_DECLARE_CONVERTER(JniType, NativeType, FromJniFn, ToJniFn) \
 namespace Jni { \
 template <> struct converter<NativeType> { \
     typedef JniType type; \
-    static inline QAndroidJniObject convert(const NativeType &value) { return (ToJniFn); } \
+    static inline QJniObject convert(const NativeType &value) { return (ToJniFn); } \
 }; \
 template <> struct converter<JniType> { \
     typedef NativeType type; \
-    static inline NativeType convert(const QAndroidJniObject &value) { return (FromJniFn); } \
+    static inline NativeType convert(const QJniObject &value) { return (FromJniFn); } \
 }; \
 }
 
diff --git a/src/solidextras/androidbrightnessbackend.cpp b/src/solidextras/androidbrightnessbackend.cpp
index f1a0bdc8d..81bdf674b 100644
--- a/src/solidextras/androidbrightnessbackend.cpp
+++ b/src/solidextras/androidbrightnessbackend.cpp
@@ -8,14 +8,8 @@
 
 #include <QDebug>
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#include <QAndroidJniObject>
-#else
 #include <QCoreApplication>
 #include <QJniObject>
-using QAndroidJniObject = QJniObject;
-#endif
 
 AndroidBrightnessBackend::AndroidBrightnessBackend(QObject *parent)
     : BrightnessBackend(parent)
@@ -28,22 +22,12 @@ AndroidBrightnessBackend::~AndroidBrightnessBackend()
 
 float AndroidBrightnessBackend::brightness() const
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto activity = QtAndroid::androidActivity();
-#else
-    const QJniObject activity = QNativeInterface::QAndroidApplication::context();
-#endif
-    return QAndroidJniObject::callStaticMethod<jfloat>("org.kde.solidextras.Solid", "getBrightness", "(Landroid/app/Activity;)F", activity.object());
+    return QJniObject::callStaticMethod<jfloat>("org.kde.solidextras.Solid", "getBrightness", "(Landroid/app/Activity;)F", QNativeInterface::QAndroidApplication::context());
 }
 
 void AndroidBrightnessBackend::setBrightness(float brightness)
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto activity = QtAndroid::androidActivity();
-#else
-    const QJniObject activity = QNativeInterface::QAndroidApplication::context();
-#endif
-    QAndroidJniObject::callStaticMethod<void>("org.kde.solidextras.Solid", "setBrightness", "(Landroid/app/Activity;F)V", activity.object(), brightness);
+    QJniObject::callStaticMethod<void>("org.kde.solidextras.Solid", "setBrightness", "(Landroid/app/Activity;F)V", QNativeInterface::QAndroidApplication::context(), brightness);
 }
 
 float AndroidBrightnessBackend::maxBrightness() const
diff --git a/src/solidextras/androidlockbackend.cpp b/src/solidextras/androidlockbackend.cpp
index 5351391aa..a793fd026 100644
--- a/src/solidextras/androidlockbackend.cpp
+++ b/src/solidextras/androidlockbackend.cpp
@@ -6,16 +6,8 @@
 
 #include "androidlockbackend.h"
 
-#include <QDebug>
-
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#include <QAndroidJniObject>
-#else
 #include <QCoreApplication>
 #include <QJniObject>
-using QAndroidJniObject = QJniObject;
-#endif
 
 AndroidLockBackend::AndroidLockBackend(QObject *parent)
     : LockBackend(parent)
@@ -28,21 +20,11 @@ AndroidLockBackend::~AndroidLockBackend()
 
 void AndroidLockBackend::setInhibitionOff()
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto activity = QtAndroid::androidActivity();
-#else
-    const QJniObject activity = QNativeInterface::QAndroidApplication::context();
-#endif
-    QAndroidJniObject::callStaticMethod<void>("org.kde.solidextras.Solid", "setLockInhibitionOff", "(Landroid/app/Activity;)V", activity.object());
+    QJniObject::callStaticMethod<void>("org.kde.solidextras.Solid", "setLockInhibitionOff", "(Landroid/app/Activity;)V", QNativeInterface::QAndroidApplication::context());
 }
 
 void AndroidLockBackend::setInhibitionOn(const QString &explanation)
 {
     Q_UNUSED(explanation)
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto activity = QtAndroid::androidActivity();
-#else
-    const QJniObject activity = QNativeInterface::QAndroidApplication::context();
-#endif
-    QAndroidJniObject::callStaticMethod<void>("org.kde.solidextras.Solid", "setLockInhibitionOn", "(Landroid/app/Activity;)V", activity.object());
+    QJniObject::callStaticMethod<void>("org.kde.solidextras.Solid", "setLockInhibitionOn", "(Landroid/app/Activity;)V", QNativeInterface::QAndroidApplication::context());
 }
diff --git a/src/solidextras/networkstatus_android.cpp b/src/solidextras/networkstatus_android.cpp
index 427ab7bd0..edb467eff 100644
--- a/src/solidextras/networkstatus_android.cpp
+++ b/src/solidextras/networkstatus_android.cpp
@@ -6,17 +6,9 @@
 
 #include "networkstatus.h"
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-#include <QtAndroid>
-#include <QAndroidJniEnvironment>
-#include <QAndroidJniObject>
-#else
 #include <QCoreApplication>
 #include <QJniEnvironment>
 #include <QJniObject>
-using QAndroidJniEnvironment = QJniEnvironment;
-using QAndroidJniObject = QJniObject;
-#endif
 
 using namespace SolidExtras;
 
@@ -34,7 +26,7 @@ Q_SIGNALS:
 private:
     explicit NetworkStatusBackend(QObject *parent = nullptr);
 
-    QAndroidJniObject m_obj;
+    QJniObject m_obj;
 };
 
 static void networkStatusChangedCallback()
@@ -45,17 +37,12 @@ static void networkStatusChangedCallback()
 NetworkStatusBackend::NetworkStatusBackend(QObject *parent)
     : QObject(parent)
 {
-    QAndroidJniEnvironment env;
+    QJniEnvironment env;
     jclass cls = env->FindClass("org/kde/solidextras/NetworkStatus");
     static JNINativeMethod methods = {"networkStatusChanged", "()V", reinterpret_cast<void *>(networkStatusChangedCallback)};
     env->RegisterNatives(cls, &methods, sizeof(methods) / sizeof(JNINativeMethod));
 
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto context = QtAndroid::androidContext();
-#else
-    const QJniObject context = QNativeInterface::QAndroidApplication::context();
-#endif
-    m_obj = QAndroidJniObject("org/kde/solidextras/NetworkStatus", "(Landroid/content/Context;)V", context.object());
+    m_obj = QJniObject("org/kde/solidextras/NetworkStatus", "(Landroid/content/Context;)V", QNativeInterface::QAndroidApplication::context());
 }
 
 NetworkStatusBackend* NetworkStatusBackend::instance()
@@ -66,22 +53,12 @@ NetworkStatusBackend* NetworkStatusBackend::instance()
 
 bool NetworkStatusBackend::connectivity() const
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto context = QtAndroid::androidContext();
-#else
-    const QJniObject context = QNativeInterface::QAndroidApplication::context();
-#endif
-    return m_obj.callMethod<jboolean>("connectivity", "(Landroid/content/Context;)Z", context.object());
+    return m_obj.callMethod<jboolean>("connectivity", "(Landroid/content/Context;)Z", QNativeInterface::QAndroidApplication::context());
 }
 
 bool NetworkStatusBackend::metered() const
 {
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    const auto context = QtAndroid::androidContext();
-#else
-    const QJniObject context = QNativeInterface::QAndroidApplication::context();
-#endif
-    return m_obj.callMethod<jboolean>("metered", "(Landroid/content/Context;)Z", context.object());
+    return m_obj.callMethod<jboolean>("metered", "(Landroid/content/Context;)Z", QNativeInterface::QAndroidApplication::context());
 }
 
 
diff --git a/tests/journeyquerytest.cpp b/tests/journeyquerytest.cpp
index 7bfd0cb5f..23316a0f8 100644
--- a/tests/journeyquerytest.cpp
+++ b/tests/journeyquerytest.cpp
@@ -27,11 +27,6 @@ int main(int argc, char **argv)
     QCoreApplication::setApplicationName(QStringLiteral("journeyquerytest"));
     QCoreApplication::setOrganizationName(QStringLiteral("KDE"));
     QCoreApplication::setOrganizationDomain(QStringLiteral("kde.org"));
-
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QGuiApplication::setAttribute(Qt::AA_EnableHighDpiScaling);
-    QGuiApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);
-#endif
     QGuiApplication app(argc, argv);
 
     QCommandLineParser parser;
diff --git a/tests/pkpassviewer.cpp b/tests/pkpassviewer.cpp
index 7f3d83062..66659fc4c 100644
--- a/tests/pkpassviewer.cpp
+++ b/tests/pkpassviewer.cpp
@@ -26,11 +26,6 @@ int main(int argc, char **argv)
     QCoreApplication::setApplicationName(QStringLiteral("pkpassviewer"));
     QCoreApplication::setOrganizationName(QStringLiteral("KDE"));
     QCoreApplication::setOrganizationDomain(QStringLiteral("kde.org"));
-
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QGuiApplication::setAttribute(Qt::AA_EnableHighDpiScaling);
-    QGuiApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);
-#endif
     QGuiApplication app(argc, argv);
 
     if (app.arguments().size() <= 1) {
diff --git a/tests/vehiclelayoutviewer.cpp b/tests/vehiclelayoutviewer.cpp
index 423d479d6..524662cdc 100644
--- a/tests/vehiclelayoutviewer.cpp
+++ b/tests/vehiclelayoutviewer.cpp
@@ -27,11 +27,6 @@ int main(int argc, char **argv)
     QCoreApplication::setApplicationName(QStringLiteral("vehiclelayoutviewer"));
     QCoreApplication::setOrganizationName(QStringLiteral("KDE"));
     QCoreApplication::setOrganizationDomain(QStringLiteral("kde.org"));
-
-#if QT_VERSION < QT_VERSION_CHECK(6, 0, 0)
-    QGuiApplication::setAttribute(Qt::AA_EnableHighDpiScaling);
-    QGuiApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);
-#endif
     QGuiApplication app(argc, argv);
 
     QCommandLineParser parser;
-- 
GitLab


From 39ef89667efbaf96e0ca678a797d28391a6158a7 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 18:18:27 +0100
Subject: [PATCH 29/36] Rework the rest of the transport icon uses

The way non-square SVG files are displayed changed, in a way not suitable
for us here. Use Image rather than Icon for the line logos instead, to
work around that. That fixes the sizes but still gives us a worse render
quality for SVGs than before (possibly due to rendering the SVG in its
original size and then downscaling rather than rendering in the needed
size to begin with). But at least we now have a central place to address
that going forward.
---
 src/app/JourneySectionDelegate.qml |  2 +-
 src/app/JourneySectionPage.qml     |  6 ++--
 src/app/JourneySummaryDelegate.qml |  5 ++-
 src/app/TimelineDelegate.qml       |  9 ++----
 src/app/TransportIcon.qml          | 46 +++++++++++++++++++++++++++
 src/app/qml.qrc                    |  1 +
 src/app/util.cpp                   | 50 ------------------------------
 src/app/util.h                     |  5 ---
 8 files changed, 55 insertions(+), 69 deletions(-)
 create mode 100644 src/app/TransportIcon.qml

diff --git a/src/app/JourneySectionDelegate.qml b/src/app/JourneySectionDelegate.qml
index 029c35615..2168087b7 100644
--- a/src/app/JourneySectionDelegate.qml
+++ b/src/app/JourneySectionDelegate.qml
@@ -132,7 +132,7 @@ FormCard.AbstractFormDelegate {
                 anchors.centerIn: parent
                 radius: Kirigami.Units.smallSpacing
 
-                Kirigami.Icon {
+                TransportIcon {
                     id: modeIcon
                     anchors.centerIn: parent
                     source: PublicTransport.journeySectionIcon(modelData)
diff --git a/src/app/JourneySectionPage.qml b/src/app/JourneySectionPage.qml
index 8b1b6d01b..b197ce655 100644
--- a/src/app/JourneySectionPage.qml
+++ b/src/app/JourneySectionPage.qml
@@ -30,14 +30,14 @@ Kirigami.ScrollablePage {
 
             Layout.margins: Kirigami.Units.gridUnit
 
-            Kirigami.Icon {
+            TransportIcon {
                 Layout.rowSpan: 4
                 Layout.alignment: Qt.AlignTop
                 Layout.rightMargin: Kirigami.Units.largeSpacing
                 id: icon
                 source: PublicTransport.lineIcon(journeySection.route.line)
-                width: height
-                height: Kirigami.Units.iconSizes.large
+                Layout.preferredWidth: height
+                Layout.preferredHeight: Kirigami.Units.iconSizes.large
                 isMask: !journeySection.route.line.hasLogo && !journeySection.route.line.hasModeLogo
             }
 
diff --git a/src/app/JourneySummaryDelegate.qml b/src/app/JourneySummaryDelegate.qml
index a13c8fb7f..8e2883dc5 100644
--- a/src/app/JourneySummaryDelegate.qml
+++ b/src/app/JourneySummaryDelegate.qml
@@ -44,12 +44,11 @@ FormCard.AbstractFormDelegate {
         RowLayout {
             Repeater {
                 model: root.journey.sections
-                delegate: Kirigami.Icon {
+                delegate: App.TransportIcon {
                     source: PublicTransport.journeySectionIcon(modelData)
                     color: PublicTransport.warnAboutSection(modelData) ? Kirigami.Theme.negativeTextColor : Kirigami.Theme.textColor
                     isMask: modelData.mode != JourneySection.PublicTransport || (!modelData.route.line.hasLogo && !modelData.route.line.hasModeLogo)
-                    Layout.preferredWidth: Kirigami.Units.iconSizes.small * Util.svgAspectRatio(source)
-                    Layout.preferredHeight: Kirigami.Units.iconSizes.small
+                    size: Kirigami.Units.iconSizes.small
                     Accessible.name: PublicTransport.journeySectionLabel(modelData)
                 }
             }
diff --git a/src/app/TimelineDelegate.qml b/src/app/TimelineDelegate.qml
index 13b0c3c6e..28fb82755 100644
--- a/src/app/TimelineDelegate.qml
+++ b/src/app/TimelineDelegate.qml
@@ -72,16 +72,11 @@ FormCard.FormCard {
         contentItem: RowLayout {
             id: headerLayout
 
-            Kirigami.Icon {
+            App.TransportIcon {
                 id: _headerIcon
-                Layout.preferredWidth: Layout.preferredHeight * aspectRatio
-                Layout.preferredHeight: Kirigami.Units.iconSizes.smallMedium
                 color: root.headerTextColor
                 isMask: true
-
-                // work around the fact that Kirigami.Icon always gives us an implicit size of 32x32 no
-                // matter the size of the input icon
-                property real aspectRatio: isMask ? 1.0 : Util.svgAspectRatio(source)
+                size: Kirigami.Units.iconSizes.smallMedium
             }
         }
     }
diff --git a/src/app/TransportIcon.qml b/src/app/TransportIcon.qml
new file mode 100644
index 000000000..298e18a89
--- /dev/null
+++ b/src/app/TransportIcon.qml
@@ -0,0 +1,46 @@
+/*
+    SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
+    SPDX-License-Identifier: LGPL-2.0-or-later
+*/
+
+import QtQuick
+import QtQuick.Layouts
+import org.kde.kirigami as Kirigami
+
+/** Displays a transport line or mode logo/icon.
+ *  Mainly to hide ugly implementation details of Icon not
+ *  handling non-square SVG assets in the way we need it here.
+ */
+Item {
+    id: root
+    // properties match those of Icon
+    property string source
+    property alias isMask: __icon.isMask
+    property alias color: __icon.color
+
+    // icon size (height for non-square ones)
+    property int size: Kirigami.Units.iconSizes.small
+
+    property bool __isIcon: !source.startsWith("file:")
+
+
+    implicitWidth: __isIcon ? root.size : Math.round(root.size * __image.implicitWidth / __image.implicitHeight)
+    implicitHeight: root.size
+
+    Layout.preferredWidth: root.implicitWidth
+    Layout.preferredHeight: root.implicitHeight
+
+    Kirigami.Icon {
+        id: __icon
+        source: root.__isIcon ? root.source : ""
+        visible: source !== ""
+        anchors.fill: parent
+    }
+    Image {
+        id: __image
+        source: root.__isIcon ? "" : root.source
+        visible: source !== ""
+        anchors.fill: parent
+        fillMode: Image.PreserveAspectFit
+    }
+}
diff --git a/src/app/qml.qrc b/src/app/qml.qrc
index 8ba9186db..8680ce9c8 100644
--- a/src/app/qml.qrc
+++ b/src/app/qml.qrc
@@ -113,6 +113,7 @@
         <file>TrainPage.qml</file>
         <file>TransferDelegate.qml</file>
         <file>TransferPage.qml</file>
+        <file>TransportIcon.qml</file>
         <file>TripGroupDelegate.qml</file>
         <file>VehicleLoadIndicator.qml</file>
         <file>VehicleLayoutPage.qml</file>
diff --git a/src/app/util.cpp b/src/app/util.cpp
index e2a543a5e..3dabccfb7 100644
--- a/src/app/util.cpp
+++ b/src/app/util.cpp
@@ -20,7 +20,6 @@
 #include <QFile>
 #include <QTimeZone>
 #include <QUrl>
-#include <QXmlStreamReader>
 
 #include <cmath>
 
@@ -93,55 +92,6 @@ void Util::sortModel(QObject *model, int column, Qt::SortOrder sortOrder)
     }
 }
 
-float Util::svgAspectRatio(const QString &svgFilePath)
-{
-    if (svgFilePath.isEmpty()) {
-        return 1.0f;
-    }
-
-    QString localFilePath(svgFilePath);
-    if (svgFilePath.startsWith(QLatin1String("qrc:"))) {
-        localFilePath = QLatin1Char(':') + QUrl(svgFilePath).path();
-    }
-    if (svgFilePath.startsWith(QLatin1String("file:"))) {
-        localFilePath = QUrl(svgFilePath).toLocalFile();
-    }
-    QFile file(localFilePath);
-    if (!file.open(QFile::ReadOnly)) {
-        qCWarning(Log) << file.errorString() << localFilePath;
-        return 1.0f;
-    }
-
-    QXmlStreamReader reader(&file);
-    while (!reader.atEnd()) {
-        if (reader.readNext() != QXmlStreamReader::StartElement) {
-            continue;
-        }
-        if (reader.name() != QLatin1String("svg")) {
-            qCDebug(Log) << svgFilePath << "not an svg file?";
-            return 1.0f;
-        }
-        const auto viewBox = reader.attributes().value(QLatin1String("viewBox"));
-        const auto parts = viewBox.split(QLatin1Char(' '), Qt::SkipEmptyParts);
-        if (parts.size() != 4) {
-            qCDebug(Log) << "invalid SVG viewBox:" << viewBox;
-            return 1.0f;
-        }
-
-        bool widthValid, heightValid;
-        const auto width = parts.at(2).toDouble(&widthValid);
-        const auto height = parts.at(3).toDouble(&heightValid);
-        if (!widthValid || !heightValid || height == 0.0f || width == 0.0f) {
-            qCDebug(Log) << "invalid SVG viewBox:" << viewBox;
-            return 1.0f;
-        }
-
-        return width / height;
-    }
-
-    return 1.0f;
-}
-
 bool Util::isValidColor(const QColor &color)
 {
     return color.isValid();
diff --git a/src/app/util.h b/src/app/util.h
index 46cb54966..03f831e59 100644
--- a/src/app/util.h
+++ b/src/app/util.h
@@ -39,11 +39,6 @@ public:
     /** Execute the non-exported sort() method on a QAbstractItemModel. */
     Q_INVOKABLE static void sortModel(QObject *model, int column, Qt::SortOrder sortOrder);
 
-    /** Determine the aspect ratio of an SVG file.
-     *  This is a dirty workaround for the problem that Kirigami.Icon has its implicit size hardcoded to 32x32...
-     */
-    Q_INVOKABLE static float svgAspectRatio(const QString &svgFilePath);
-
     /** QColor::isValid for QML. */
     Q_INVOKABLE static bool isValidColor(const QColor &color);
 
-- 
GitLab


From 6547b3e1aa1d6002a88aee75a3a3995de65cdddb Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 18:18:45 +0100
Subject: [PATCH 30/36] Rework RadioSelector layout/size logic

This fixes the height of the marker being wrong in mobile mode with the
Breeze style, as this wasn't considering a higher minimum size for buttons
as manually specified here.
---
 src/app/components/RadioSelector.qml | 256 +++++++++++++--------------
 1 file changed, 126 insertions(+), 130 deletions(-)

diff --git a/src/app/components/RadioSelector.qml b/src/app/components/RadioSelector.qml
index c8dc67d46..b897c85e2 100644
--- a/src/app/components/RadioSelector.qml
+++ b/src/app/components/RadioSelector.qml
@@ -6,182 +6,178 @@ import QtQuick.Controls as QQC2
 import QtQuick.Layouts
 import org.kde.kirigami as Kirigami
 
-RowLayout {
-    id: root
+Item{
+    id: container
 
     property list<Kirigami.Action> actions
     property bool consistentWidth: false
     property int defaultIndex: 0
     readonly property int selectedIndex: marker.selectedIndex
 
-    Item{
-        id: container
+    Layout.minimumWidth: consistentWidth ? 0 : switchLayout.implicitWidth
+    implicitHeight: switchLayout.implicitHeight
+    Layout.fillWidth: consistentWidth
 
-        Layout.minimumWidth: consistentWidth ? 0 : switchLayout.implicitWidth
-        height: Math.round(Kirigami.Units.gridUnit * 1.5)
-        Layout.fillHeight: true
-        Layout.fillWidth: consistentWidth
+    QQC2.ButtonGroup {
+        buttons: switchLayout.children
+    }
 
-        QQC2.ButtonGroup {
-            buttons: switchLayout.children
+    RowLayout {
+        id: switchLayout
+        anchors {
+            top: container.top
+            left: container.left
+            right: container.right
         }
+        Repeater{
+            id: repeater
+
+            model: actions
+            delegate: QQC2.ToolButton {
+                id: button
 
-        RowLayout {
-            id: switchLayout
+                required property var modelData
+                required property int index
 
-            anchors.fill: parent
-            Layout.fillWidth: true
-            Repeater{
-                id: repeater
+                Layout.fillWidth: true
+                Layout.preferredWidth: consistentWidth ? (container.width/repeater.count)-(switchLayout.spacing/repeater.count-1) : button.implicitWidth
+                Layout.minimumHeight: Math.round(Kirigami.Units.gridUnit * 1.5)
 
-                model: actions
-                delegate: QQC2.ToolButton {
-                    id: button
+                checkable: true
+                text: modelData.text
+                icon.name: modelData.icon.name
 
-                    required property var modelData
-                    required property int index
+                background: Rectangle{
+                    anchors.fill: button
 
-                    Layout.fillWidth: true
-                    Layout.preferredWidth: consistentWidth ? (root.width/repeater.count)-(switchLayout.spacing/repeater.count-1) : button.implicitWidth
+                    radius: height/2
+                    color: "transparent"
+                    border.color: Kirigami.Theme.disabledTextColor
+                    opacity: button.hovered ? 0.3 : 0
 
-                    checkable: true
-                    text: modelData.text
-                    icon.name: modelData.icon.name
+                    Behavior on opacity {
+                        PropertyAnimation {
+                            duration: Kirigami.Units.shortDuration
+                            easing.type: Easing.InOutCubic
+                        }
+                    }
+                }
+
+                contentItem: RowLayout{
+                    Item {
+                        Layout.leftMargin:  icon.visible ? Kirigami.Units.smallSpacing : Kirigami.Units.largeSpacing
+                        Layout.fillWidth: true
+                    }
 
-                    background: Rectangle{
-                        anchors.fill: button
+                    Kirigami.Icon {
+                        id: icon
 
-                        radius: height/2
-                        color: "transparent"
-                        border.color: Kirigami.Theme.disabledTextColor
-                        opacity: button.hovered ? 0.3 : 0
+                        Layout.alignment: Qt.AlignVCenter
 
-                        Behavior on opacity {
+                        color: button.checked ? Kirigami.Theme.hoverColor : Kirigami.Theme.textColor
+                        visible: button.icon.name
+                        source: button.icon.name
+                        implicitHeight: label.height
+                        implicitWidth: label.height
+                        Behavior on color {
                             PropertyAnimation {
-                                duration: Kirigami.Units.shortDuration
+                                duration: Kirigami.Units.longDuration
                                 easing.type: Easing.InOutCubic
                             }
                         }
                     }
+                    Item{
+                        Layout.alignment: Qt.AlignVCenter
 
-                    contentItem: RowLayout{
-                        Item {
-                            Layout.leftMargin:  icon.visible ? Kirigami.Units.smallSpacing : Kirigami.Units.largeSpacing
-                            Layout.fillWidth: true
-                        }
-
-                        Kirigami.Icon {
-                            id: icon
+                        implicitWidth: fakeLabel.implicitWidth
+                        implicitHeight: fakeLabel.implicitHeight
+                        QQC2.Label {
+                            id: fakeLabel
 
-                            Layout.topMargin: (container.height-label.height)/2
-                            Layout.bottomMargin: (container.height-label.height)/2
+                            anchors.centerIn: parent
+                            font.bold: true
+                            color: Kirigami.Theme.hoverColor
 
-                            color: button.checked ? Kirigami.Theme.hoverColor : Kirigami.Theme.textColor
-                            visible: button.icon.name
-                            source: button.icon.name
-                            implicitHeight: label.height
-                            implicitWidth: label.height
-                            Behavior on color {
+                            opacity: button.checked ? 1 : 0
+                            text: button.text
+                            Behavior on opacity {
                                 PropertyAnimation {
                                     duration: Kirigami.Units.longDuration
                                     easing.type: Easing.InOutCubic
                                 }
                             }
                         }
-                        Item{
-                            Layout.topMargin: (container.height-label.height)/2
-                            Layout.bottomMargin: (container.height-label.height)/2
-
-                            width: fakeLabel.width
-                            height: fakeLabel.height
-                            QQC2.Label {
-                                id: fakeLabel
-
-                                anchors.centerIn: parent
-                                font.bold: true
-                                color: Kirigami.Theme.hoverColor
-
-                                opacity: button.checked ? 1 : 0
-                                text: button.text
-                                Behavior on opacity {
-                                    PropertyAnimation {
-                                        duration: Kirigami.Units.longDuration
-                                        easing.type: Easing.InOutCubic
-                                    }
-                                }
-                            }
-                            QQC2.Label {
-                                id: label
-
-                                anchors.centerIn: parent
-                                color: Kirigami.Theme.textColor
-
-                                opacity: button.checked ? 0 : 1
-                                text: button.text
-                                Behavior on opacity {
-                                    PropertyAnimation {
-                                        duration: Kirigami.Units.longDuration
-                                        easing.type: Easing.InOutCubic
-                                    }
+                        QQC2.Label {
+                            id: label
+
+                            anchors.centerIn: parent
+                            color: Kirigami.Theme.textColor
+
+                            opacity: button.checked ? 0 : 1
+                            text: button.text
+                            Behavior on opacity {
+                                PropertyAnimation {
+                                    duration: Kirigami.Units.longDuration
+                                    easing.type: Easing.InOutCubic
                                 }
                             }
                         }
+                    }
 
-                        Item {
-                            Layout.fillWidth: true
-                            Layout.rightMargin: Kirigami.Units.largeSpacing
-                        }
+                    Item {
+                        Layout.fillWidth: true
+                        Layout.rightMargin: Kirigami.Units.largeSpacing
                     }
+                }
 
-                    onClicked: {
-                        marker.width = Qt.binding(function() { return width })
-                        marker.x = Qt.binding(function() { return x })
-                        modelData.triggered()
-                        marker.selectedIndex = index
+                onClicked: {
+                    marker.width = Qt.binding(function() { return width })
+                    marker.x = Qt.binding(function() { return x })
+                    modelData.triggered()
+                    marker.selectedIndex = index
 
-                    }
-                    Component.onCompleted: if (index === defaultIndex ) {
-                        marker.width = Qt.binding(function() { return width })
-                        marker.x = Qt.binding(function() { return x })
-                        button.checked = true
-                    }
+                }
+                Component.onCompleted: if (index === defaultIndex ) {
+                    marker.width = Qt.binding(function() { return width })
+                    marker.x = Qt.binding(function() { return x })
+                    button.checked = true
                 }
             }
         }
+    }
 
-        Rectangle {
-            id: marker
-
-            property int selectedIndex: root.defaultIndex
-
-            y: switchLayout.y
-            z: switchLayout.z - 1
-            height: container.height
-            radius: height/2
-            border.width: 1
-            border.color: Kirigami.ColorUtils.linearInterpolation(
-                              Kirigami.Theme.hoverColor,
-                              "transparent", 0.4)
-            color: Kirigami.ColorUtils.linearInterpolation(
-                       Kirigami.Theme.hoverColor,
-                       "transparent", 0.9)
-
-            Behavior on x {
-                PropertyAnimation {
-                    id: x_anim
-
-                    duration: Kirigami.Units.longDuration
-                    easing.type: Easing.InOutCubic
-                }
+    Rectangle {
+        id: marker
+
+        property int selectedIndex: container.defaultIndex
+
+        y: switchLayout.y
+        z: switchLayout.z - 1
+        height: switchLayout.implicitHeight
+        radius: height/2
+        border.width: 1
+        border.color: Kirigami.ColorUtils.linearInterpolation(
+                            Kirigami.Theme.hoverColor,
+                            "transparent", 0.4)
+        color: Kirigami.ColorUtils.linearInterpolation(
+                    Kirigami.Theme.hoverColor,
+                    "transparent", 0.9)
+
+        Behavior on x {
+            PropertyAnimation {
+                id: x_anim
+
+                duration: Kirigami.Units.longDuration
+                easing.type: Easing.InOutCubic
             }
+        }
 
-            Behavior on width {
-                PropertyAnimation {
-                    id: width_anim
+        Behavior on width {
+            PropertyAnimation {
+                id: width_anim
 
-                    duration: Kirigami.Units.longDuration
-                    easing.type: Easing.InOutCubic
-                }
+                duration: Kirigami.Units.longDuration
+                easing.type: Easing.InOutCubic
             }
         }
     }
-- 
GitLab


From 0ddd43cd2703426ae4bac1f96d5b9c298ddf152d Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 18:18:58 +0100
Subject: [PATCH 31/36] Remove long dead code

---
 src/app/TimelineDelegateHeaderBackground.qml | 41 --------------------
 src/app/qml.qrc                              |  1 -
 2 files changed, 42 deletions(-)
 delete mode 100644 src/app/TimelineDelegateHeaderBackground.qml

diff --git a/src/app/TimelineDelegateHeaderBackground.qml b/src/app/TimelineDelegateHeaderBackground.qml
deleted file mode 100644
index 5feb78818..000000000
--- a/src/app/TimelineDelegateHeaderBackground.qml
+++ /dev/null
@@ -1,41 +0,0 @@
-/*
-    SPDX-FileCopyrightText: 2023 Volker Krause <vkrause@kde.org>
-    SPDX-License-Identifier: LGPL-2.0-or-later
-*/
-
-import QtQuick
-import QtQuick.Layouts
-import QtQuick.Controls as QQC2
-import org.kde.kirigami as Kirigami
-
-Kirigami.ShadowedRectangle {
-    id: root
-
-    property var card
-
-    // see Kirigami.DefaultCardBackground
-    property color defaultColor: Kirigami.Theme.backgroundColor
-    property color pressedColor: Kirigami.ColorUtils.tintWithAlpha(defaultColor, Kirigami.Theme.highlightColor, 0.3)
-    property color hoverColor: Kirigami.ColorUtils.tintWithAlpha(defaultColor, Kirigami.Theme.highlightColor, 0.1)
-    property color borderColor: Kirigami.ColorUtils.tintWithAlpha(color, Kirigami.Theme.textColor, 0.2)
-
-    border {
-        width: 1
-        color: root.borderColor
-    }
-    corners {
-        topLeftRadius: Kirigami.Units.smallSpacing
-        topRightRadius: Kirigami.Units.smallSpacing
-    }
-    color: {
-        if (root.card.checked || (root.card.showClickFeedback && (root.card.down || root.card.highlighted)))
-            return root.pressedColor
-        else if (root.card.hoverEnabled && root.card.hovered)
-            return root.hoverColor
-        return root.defaultColor
-    }
-
-    anchors.leftMargin: -root.card.leftPadding
-    anchors.topMargin: -root.card.topPadding
-    anchors.rightMargin: -root.card.rightPadding
-}
diff --git a/src/app/qml.qrc b/src/app/qml.qrc
index 8680ce9c8..a9fbfe85c 100644
--- a/src/app/qml.qrc
+++ b/src/app/qml.qrc
@@ -103,7 +103,6 @@
         <file>TicketPage.qml</file>
         <file>TicketTokenDelegate.qml</file>
         <file>TimelineDelegate.qml</file>
-        <file>TimelineDelegateHeaderBackground.qml</file>
         <file>TimelinePage.qml</file>
         <file>TimelineSectionDelegate.qml</file>
         <file>TouristAttractionDelegate.qml</file>
-- 
GitLab


From c265eadea5c12beb5b85439badb712a4991e33c1 Mon Sep 17 00:00:00 2001
From: Jack Hill <jackhill3103@gmail.com>
Date: Tue, 12 Sep 2023 18:16:04 +0100
Subject: [PATCH 32/36] KF6: Port away from manually closing
 Kirigami.MenuDialog

This is now handled automatically by the dialog itself
---
 src/app/ActionsCard.qml  | 10 ++--------
 src/app/TimelinePage.qml |  7 +------
 2 files changed, 3 insertions(+), 14 deletions(-)

diff --git a/src/app/ActionsCard.qml b/src/app/ActionsCard.qml
index 779d9fcc8..32668ca26 100644
--- a/src/app/ActionsCard.qml
+++ b/src/app/ActionsCard.qml
@@ -136,10 +136,7 @@ ColumnLayout {
             Kirigami.Action {
                 text: i18n("As Itinerary file...")
                 icon.name: "export-symbolic"
-                onTriggered: {
-                    exportBatchDialog.close();
-                    batchFileExportDialog.open();
-                }
+                onTriggered: batchFileExportDialog.open()
             }
         ]
         actions: exportBatchDialog._actions
@@ -150,10 +147,7 @@ ColumnLayout {
             delegate: Kirigami.Action {
                 text: i18n("Send to %1", model.name)
                 icon.name: "kdeconnect-tray"
-                onTriggered: {
-                    exportBatchDialog.close();
-                    ApplicationController.exportBatchToKDEConnect(root.batchId, model.deviceId);
-                }
+                onTriggered: ApplicationController.exportBatchToKDEConnect(root.batchId, model.deviceId)
             }
             onObjectAdded: exportBatchDialog._actions.push(object)
         }
diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index c7b87eb5f..817a56218 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -182,7 +182,6 @@ Kirigami.ScrollablePage {
                 text: i18n("As Itinerary file...")
                 icon.name: "export-symbolic"
                 onTriggered: {
-                    exportTripGroupDialog.close();
                     tripGroupFileExportDialog.tripGroupId = exportTripGroupDialog.tripGroupId;
                     tripGroupFileExportDialog.open();
                 }
@@ -191,7 +190,6 @@ Kirigami.ScrollablePage {
                 text: i18n("As GPX file...")
                 icon.name: "map-globe"
                 onTriggered: {
-                    exportTripGroupDialog.close();
                     tripGroupGpxExportDialog.tripGroupId = exportTripGroupDialog.tripGroupId;
                     tripGroupGpxExportDialog.open();
                 }
@@ -205,10 +203,7 @@ Kirigami.ScrollablePage {
             delegate: Kirigami.Action {
                 text: i18n("Send to %1", model.name)
                 icon.name: "kdeconnect-tray"
-                onTriggered: {
-                    exportTripGroupDialog.close();
-                    ApplicationController.exportTripToKDEConnect(exportTripGroupDialog.tripGroupId, model.deviceId);
-                }
+                onTriggered: ApplicationController.exportTripToKDEConnect(exportTripGroupDialog.tripGroupId, model.deviceId)
             }
             onObjectAdded: exportTripGroupDialog._actions.push(object)
         }
-- 
GitLab


From 0f96c384c8735f4decfe059bbe85d1d03a7515ec Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 19:12:24 +0100
Subject: [PATCH 33/36] Temporary workaround for broken qtdeclarative Craft
 cache package

---
 .craft.ini | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/.craft.ini b/.craft.ini
index bd5e0a8f0..a50818e69 100644
--- a/.craft.ini
+++ b/.craft.ini
@@ -30,3 +30,6 @@ libs/freetype.patchLevel=1
 libs/libxml2.patchLevel=1
 qt-libs/poppler.patchLevel=1
 kde/frameworks/tier1/karchive.patchLevel=1
+
+; temporary workaround for corrupt qtdeclarative ARM64 cache package
+libs/qt6/qtdeclarative.patchLevel=1
-- 
GitLab


From 432fca198080c48f2f92e384deb18d82db3a506d Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 22:19:46 +0100
Subject: [PATCH 34/36] Use qmlcachegen

---
 CMakeLists.txt                                |   1 -
 src/app/AboutPage.qml                         |   1 -
 src/app/ActionsCard.qml                       |   7 +-
 src/app/AlternativeJourneyPage.qml            |   3 +-
 src/app/BarcodeContainer.qml                  |   1 -
 src/app/BarcodeScannerPage.qml                |   1 -
 src/app/BoardingPass.qml                      |   3 +-
 src/app/BoatDelegate.qml                      |   3 +-
 src/app/BoatEditor.qml                        |  15 +-
 src/app/BoatPage.qml                          |  17 ++-
 src/app/BookingCard.qml                       |   1 -
 src/app/BookingEditorCard.qml                 |   3 +-
 src/app/BusDelegate.qml                       |   3 +-
 src/app/BusEditor.qml                         |  11 +-
 src/app/BusPage.qml                           |  23 ++-
 src/app/CMakeLists.txt                        | 133 ++++++++++++++++--
 src/app/CalendarImportPage.qml                |   1 -
 src/app/CarRentalDelegate.qml                 |   3 +-
 src/app/CarRentalPage.qml                     |  15 +-
 src/app/ContactCard.qml                       |   1 -
 src/app/ContactEditorCard.qml                 |   1 -
 src/app/DepartureQueryPage.qml                |   1 -
 src/app/DetailsPage.qml                       |   1 -
 src/app/DocumentsCard.qml                     |   1 -
 src/app/EditorPage.qml                        |   1 -
 src/app/EventDelegate.qml                     |   3 +-
 src/app/EventEditor.qml                       |  13 +-
 src/app/EventPage.qml                         |  15 +-
 src/app/EventTicket.qml                       |   3 +-
 src/app/FavoriteLocationPage.qml              |   1 -
 src/app/FlightDelegate.qml                    |   3 +-
 src/app/FlightEditor.qml                      |  11 +-
 src/app/FlightPage.qml                        |  21 ++-
 src/app/FormDateTimeEditDelegate.qml          |   1 -
 src/app/FormPlaceDelegate.qml                 |   3 +-
 src/app/FormPlaceEditorDelegate.qml           |   3 +-
 src/app/FormPlatformDelegate.qml              |   1 -
 src/app/FormPriceDelegate.qml                 |   1 -
 src/app/FormPriceEditDelegate.qml             |   1 -
 src/app/GenericPass.qml                       |   3 +-
 src/app/GenericPkPassPage.qml                 |   1 -
 src/app/HealthCertificatePage.qml             |   9 +-
 src/app/HealthCertificateRecovery.qml         |   1 -
 src/app/HealthCertificateTest.qml             |   1 -
 src/app/HealthCertificateVaccination.qml      |   1 -
 src/app/HotelDelegate.qml                     |   3 +-
 src/app/HotelEditor.qml                       |  15 +-
 src/app/HotelPage.qml                         |  17 ++-
 src/app/IntermediateStopSelector.qml          |   1 -
 src/app/JourneyDelegateHeader.qml             |   1 -
 src/app/JourneyPathPage.qml                   |   1 -
 src/app/JourneyQueryPage.qml                  |   5 +-
 src/app/JourneyRequestPage.qml                |   1 -
 src/app/JourneySectionDelegate.qml            |   3 +-
 src/app/JourneySectionStopDelegate.qml        |   3 +-
 .../JourneySectionStopDelegateLineSegment.qml |   1 -
 src/app/JourneySummaryDelegate.qml            |   5 +-
 src/app/LocationInfoDelegate.qml              |   1 -
 src/app/LocationPicker.qml                    |   1 -
 src/app/MatrixRoomSelectionSheet.qml          |   1 -
 src/app/NavigationBar.qml                     |   5 +-
 src/app/OnlineImportPage.qml                  |   1 -
 src/app/PassPage.qml                          |   5 +-
 src/app/PkPassPage.qml                        |   7 +-
 src/app/ProgramMembershipEditor.qml           |   7 +-
 src/app/ProgramMembershipEditorCard.qml       |   1 -
 src/app/ProgramMembershipPage.qml             |   7 +-
 src/app/ReservationDocumentsCard.qml          |   3 +-
 src/app/RestaurantDelegate.qml                |   3 +-
 src/app/RestaurantEditor.qml                  |  15 +-
 src/app/RestaurantPage.qml                    |  15 +-
 src/app/SettingsPage.qml                      |   3 +-
 src/app/StatisticsDelegate.qml                |   1 -
 src/app/StatisticsPage.qml                    |   1 -
 src/app/StopPickerPage.qml                    |   3 +-
 src/app/TicketEditor.qml                      |   1 -
 src/app/TicketPage.qml                        |   9 +-
 src/app/TicketTokenDelegate.qml               |   1 -
 src/app/TimelineDelegate.qml                  |   3 +-
 src/app/TimelinePage.qml                      |  55 ++++----
 src/app/TimelineSectionDelegate.qml           |   1 -
 src/app/TouristAttractionDelegate.qml         |   3 +-
 src/app/TouristAttractionPage.qml             |   5 +-
 src/app/TrainDelegate.qml                     |   3 +-
 src/app/TrainEditor.qml                       |  11 +-
 src/app/TrainPage.qml                         |  29 ++--
 src/app/TransferDelegate.qml                  |   7 +-
 src/app/TransferPage.qml                      |   5 +-
 src/app/TripGroupDelegate.qml                 |   1 -
 src/app/WeatherForecastDelegate.qml           |   2 -
 src/app/WeatherForecastPage.qml               |   1 -
 src/app/WelcomePage.qml                       |   1 -
 src/app/main.cpp                              |   2 +-
 src/app/main.qml                              |  39 +++--
 src/app/qml.qrc                               | 122 ----------------
 95 files changed, 343 insertions(+), 441 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 164a8a7df..b2efda4df 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -48,7 +48,6 @@ set(QT_MIN_VERSION 6.5)
 
 # build-time dependencies
 find_package(Qt6 ${QT_MIN_VERSION} REQUIRED COMPONENTS Test Quick Positioning QuickControls2)
-find_package(Qt6 CONFIG QUIET OPTIONAL_COMPONENTS QuickCompiler)
 find_package(KF6 ${KF_MIN_VERSION} REQUIRED COMPONENTS I18n CoreAddons Contacts Notifications CalendarCore Holidays UnitConversion)
 find_package(KF6 ${KF_MIN_VERSION} OPTIONAL_COMPONENTS NetworkManagerQt)
 find_package(KF6KirigamiAddons 0.11.40 REQUIRED)
diff --git a/src/app/AboutPage.qml b/src/app/AboutPage.qml
index 71b50e813..bdb1dffc7 100644
--- a/src/app/AboutPage.qml
+++ b/src/app/AboutPage.qml
@@ -9,7 +9,6 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
 import org.kde.kirigamiaddons.formcard as FormCard
 
diff --git a/src/app/ActionsCard.qml b/src/app/ActionsCard.qml
index 32668ca26..5f122f8a0 100644
--- a/src/app/ActionsCard.qml
+++ b/src/app/ActionsCard.qml
@@ -13,7 +13,6 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitemmodels
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
@@ -83,7 +82,7 @@ ColumnLayout {
 
     Component {
         id: transferPage
-        App.TransferPage {}
+        TransferPage {}
     }
 
     Component {
@@ -96,7 +95,7 @@ ColumnLayout {
         filterRoleName: "accessMode"
         filterString: KCalendarCore.KCalendarCore.ReadWrite
     }
-    App.CalendarSelectionSheet {
+    CalendarSelectionSheet {
         id: calendarSelector
         model: writableCalendars
         onCalendarSelected: controller.addToCalendar(calendar);
@@ -104,7 +103,7 @@ ColumnLayout {
 
     Component {
         id: pkpassComponent
-        App.PkPassPage {
+        PkPassPage {
             pass: PkPassManager.pass(root.passId)
         }
     }
diff --git a/src/app/AlternativeJourneyPage.qml b/src/app/AlternativeJourneyPage.qml
index edc183261..2129cf27f 100644
--- a/src/app/AlternativeJourneyPage.qml
+++ b/src/app/AlternativeJourneyPage.qml
@@ -10,9 +10,8 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
-App.JourneyQueryPage {
+JourneyQueryPage {
     id: root
 
     required property QtObject controller
diff --git a/src/app/BarcodeContainer.qml b/src/app/BarcodeContainer.qml
index 387d46cc3..c557ab51d 100644
--- a/src/app/BarcodeContainer.qml
+++ b/src/app/BarcodeContainer.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.prison as Prison
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 Item {
     id: barcodeContainer
diff --git a/src/app/BarcodeScannerPage.qml b/src/app/BarcodeScannerPage.qml
index 2f27f15f7..d1ba1f664 100644
--- a/src/app/BarcodeScannerPage.qml
+++ b/src/app/BarcodeScannerPage.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.components
 import org.kde.prison.scanner as Prison
 import org.kde.itinerary
-import "." as App
 
 Kirigami.Page {
     id: root
diff --git a/src/app/BoardingPass.qml b/src/app/BoardingPass.qml
index 4ed9ec2f2..43eb13b55 100644
--- a/src/app/BoardingPass.qml
+++ b/src/app/BoardingPass.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.pkpass as KPkPass
 import org.kde.itinerary
-import "." as App
 
 Item {
     id: root
@@ -193,7 +192,7 @@ Item {
         }
 
         // barcode
-        App.PkPassBarcode {
+        PkPassBarcode {
             pass: root.pass
             TapHandler {
                 onDoubleTapped: root.scanModeToggled()
diff --git a/src/app/BoatDelegate.qml b/src/app/BoatDelegate.qml
index 5e1e2ae79..9e471620f 100644
--- a/src/app/BoatDelegate.qml
+++ b/src/app/BoatDelegate.qml
@@ -8,9 +8,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
     headerIconSource: "qrc:///images/ferry.svg"
     headerItem: RowLayout {
diff --git a/src/app/BoatEditor.qml b/src/app/BoatEditor.qml
index d75360120..fff67021e 100644
--- a/src/app/BoatEditor.qml
+++ b/src/app/BoatEditor.qml
@@ -11,9 +11,8 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.i18n.localeData
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
     title: i18n("Edit Boat Trip")
 
@@ -46,7 +45,7 @@ App.EditorPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🛳️"
             text: i18n("Boat")
         }
@@ -56,7 +55,7 @@ App.EditorPage {
         }
 
         FormCard.FormCard {
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: departureTimeEdit
                 text: i18nc("Boat departure", "Departure Time")
                 obj: reservation.reservationFor
@@ -73,7 +72,7 @@ App.EditorPage {
                 statusMessage: text === "" ? i18n("Departure terminal must not be empty.") : ""
             }
             FormCard.FormDelegateSeparator {}
-            App.FormPlaceEditorDelegate {
+            FormPlaceEditorDelegate {
                 id: departureAddress
                 place: {
                     if (root.batchId || !root.reservation.reservationFor.departureBoatTerminal.address.isEmpty || root.reservation.reservationFor.departureBoatTerminal.geo.isValid)
@@ -88,7 +87,7 @@ App.EditorPage {
         }
 
         FormCard.FormCard {
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: arrivalTimeEdit
                 text: i18nc("Boat arrival", "Arrival Time")
                 obj: reservation.reservationFor
@@ -114,7 +113,7 @@ App.EditorPage {
                 statusMessage: text === "" ? i18n("Arrival terminal must not be empty.") : ""
             }
             FormCard.FormDelegateSeparator {}
-            App.FormPlaceEditorDelegate {
+            FormPlaceEditorDelegate {
                 id: arrivalAddress
                 place: {
                     if (root.batchId || !root.reservation.reservationFor.arrivalBoatTerminal.address.isEmpty || root.reservation.reservationFor.arrivalBoatTerminal.geo.isValid)
@@ -129,7 +128,7 @@ App.EditorPage {
             }
         }
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: root.reservation
             defaultCurrency: Country.fromAlpha2(departureAddress.currentCountry).currencyCode
diff --git a/src/app/BoatPage.qml b/src/app/BoatPage.qml
index 1f6b0a00d..18523cb48 100644
--- a/src/app/BoatPage.qml
+++ b/src/app/BoatPage.qml
@@ -9,9 +9,8 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
 
     title: i18n("Boat Ticket")
@@ -24,7 +23,7 @@ App.DetailsPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🛳️"
             text: i18n("Boat")
 
@@ -37,7 +36,7 @@ App.DetailsPage {
             visible: ticketToken.ticketTokenCount > 0
 
             // ticket barcode
-            App.TicketTokenDelegate {
+            TicketTokenDelegate {
                 id: ticketToken
                 Layout.topMargin: Kirigami.Units.largeSpacing
                 resIds: ReservationManager.reservationsForBatch(root.batchId)
@@ -72,7 +71,7 @@ App.DetailsPage {
                 visible: departurePlace
             }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: departurePlace
                 place: reservationFor.departureBoatTerminal
                 controller: root.controller
@@ -102,7 +101,7 @@ App.DetailsPage {
                 visible: arrivalPlace
             }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: arrivalPlace
                 place: reservationFor.arrivalBoatTerminal
                 controller: root.controller
@@ -110,15 +109,15 @@ App.DetailsPage {
             }
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/BookingCard.qml b/src/app/BookingCard.qml
index 1b2edec84..c26d29d85 100644
--- a/src/app/BookingCard.qml
+++ b/src/app/BookingCard.qml
@@ -2,7 +2,6 @@
 // SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>
 // SPDX-License-Identifier: LGPL-2.0-or-later
 
-import "." as App
 import QtQuick
 import QtQuick.Layouts
 import QtQuick.Controls as QQC2
diff --git a/src/app/BookingEditorCard.qml b/src/app/BookingEditorCard.qml
index 0628430c1..7a5a3d697 100644
--- a/src/app/BookingEditorCard.qml
+++ b/src/app/BookingEditorCard.qml
@@ -8,7 +8,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
@@ -55,7 +54,7 @@ ColumnLayout {
 
         FormCard.FormDelegateSeparator { above: priceEdit }
 
-        App.FormPriceEditDelegate {
+        FormPriceEditDelegate {
             id: priceEdit
             item: root.item
         }
diff --git a/src/app/BusDelegate.qml b/src/app/BusDelegate.qml
index cbcc63e36..8f3ebc52d 100644
--- a/src/app/BusDelegate.qml
+++ b/src/app/BusDelegate.qml
@@ -10,9 +10,8 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
     property bool expanded: false
     property var journeySection: root.controller.journey
diff --git a/src/app/BusEditor.qml b/src/app/BusEditor.qml
index 34cca0bea..f1616082c 100644
--- a/src/app/BusEditor.qml
+++ b/src/app/BusEditor.qml
@@ -11,9 +11,8 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
     title: i18n("Edit Bus Reservation")
 
@@ -43,7 +42,7 @@ App.EditorPage {
         return newRes;
     }
 
-    App.IntermediateStopSelector {
+    IntermediateStopSelector {
         id: boardSheet
         title: i18n("Board Later")
         model: root.controller.journey.intermediateStops
@@ -56,7 +55,7 @@ App.EditorPage {
             }
         }
     }
-    App.IntermediateStopSelector {
+    IntermediateStopSelector {
         id: alightSheet
         title: i18n("Alight Earlier")
         model: root.controller.journey.intermediateStops
@@ -76,7 +75,7 @@ App.EditorPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🚌"
             text: if (reservationFor.busNumber || reservationFor.busName) {
                 return reservationFor.busName + " " + reservationFor.busNumber;
@@ -142,7 +141,7 @@ App.EditorPage {
             }
         }
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: root.reservation
         }
diff --git a/src/app/BusPage.qml b/src/app/BusPage.qml
index f51877930..ea7cfcd7f 100644
--- a/src/app/BusPage.qml
+++ b/src/app/BusPage.qml
@@ -11,14 +11,13 @@ import org.kde.kirigami as Kirigami
 import org.kde.kitinerary
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
 
     title: i18n("Bus Ticket")
 
-    editor: App.BusEditor {
+    editor: BusEditor {
         controller: root.controller
     }
 
@@ -30,7 +29,7 @@ App.DetailsPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🚌"
             text: reservationFor.busName + " " + reservationFor.busNumber
         }
@@ -38,7 +37,7 @@ App.DetailsPage {
         FormCard.FormCard {
             visible: ticketToken.ticketTokenCount > 0
             // ticket barcode
-            App.TicketTokenDelegate {
+            TicketTokenDelegate {
                 id: ticketToken
                 resIds: ReservationManager.reservationsForBatch(root.batchId)
                 onCurrentReservationIdChanged: {
@@ -109,7 +108,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: departureDelegate.visible }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: departureDelegate
                 place: reservationFor.departureBusStop
                 controller: root.controller
@@ -170,7 +169,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: arrivalDelegate.visible }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: arrivalDelegate
                 place: reservationFor.arrivalBusStop
                 controller: root.controller
@@ -192,19 +191,19 @@ App.DetailsPage {
             }
         }
 
-        App.ProgramMembershipCard {
+        ProgramMembershipCard {
             programMembership: root.reservation.programMembershipUsed
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
@@ -226,7 +225,7 @@ App.DetailsPage {
 
             Component {
                 id: alternativePage
-                App.AlternativeJourneyPage {
+                AlternativeJourneyPage {
                     controller: root.controller
                     publicTransportManager: LiveDataManager.publicTransportManager
                 }
diff --git a/src/app/CMakeLists.txt b/src/app/CMakeLists.txt
index a67c55ecf..61d146a63 100644
--- a/src/app/CMakeLists.txt
+++ b/src/app/CMakeLists.txt
@@ -89,12 +89,6 @@ if (TARGET KHealthCertificate)
     target_link_libraries(itinerary PRIVATE KHealthCertificate)
 endif()
 
-if (Qt5QuickCompiler_FOUND)
-    qtquick_compiler_add_resources(qml_srcs qml.qrc)
-else ()
-    set(qml_srcs qml.qrc)
-endif()
-
 add_executable(itinerary-app ${itinerary_app_srcs})
 target_sources(itinerary-app PRIVATE
     main.cpp
@@ -112,8 +106,131 @@ target_sources(itinerary-app PRIVATE
     transferdelegatecontroller.cpp
     unitconversion.cpp
     weatherforecastmodel.cpp
-    ${qml_srcs}
-    )
+    qml.qrc
+)
+qt_add_qml_module(itinerary-app URI org.kde.itinerary NO_PLUGIN QML_FILES
+    main.qml
+    AboutPage.qml
+    ActionsCard.qml
+    AlternativeJourneyPage.qml
+    BarcodeContainer.qml
+    BarcodeScanModeController.qml
+    BarcodeScanModeButton.qml
+    BarcodeScannerPage.qml
+    BoardingPass.qml
+    BoatDelegate.qml
+    BoatEditor.qml
+    BoatPage.qml
+    BookingCard.qml
+    BookingEditorCard.qml
+    BusDelegate.qml
+    BusEditor.qml
+    BusPage.qml
+    CardPageTitle.qml
+    CalendarImportPage.qml
+    CalendarSelectionSheet.qml
+    CarRentalDelegate.qml
+    CarRentalPage.qml
+    ContactCard.qml
+    ContactEditorCard.qml
+    CountryComboBox.qml
+    CountryComboBoxDelegate.qml
+    DepartureQueryPage.qml
+    DetailsPage.qml
+    DevelopmentModePage.qml
+    DocumentsCard.qml
+    EditorPage.qml
+    EventDelegate.qml
+    EventEditor.qml
+    EventPage.qml
+    EventTicket.qml
+    FavoriteLocationPage.qml
+    FlightDelegate.qml
+    FlightEditor.qml
+    FlightPage.qml
+    FormDateTimeEditDelegate.qml
+    FormPlaceDelegate.qml
+    FormPlaceEditorDelegate.qml
+    FormPlatformDelegate.qml
+    FormPriceDelegate.qml
+    FormPriceEditDelegate.qml
+    GenericPass.qml
+    GenericPkPassPage.qml
+    HealthCertificateBarcode.qml
+    HealthCertificateRecovery.qml
+    HealthCertificatePage.qml
+    HealthCertificateTest.qml
+    HealthCertificateVaccination.qml
+    HotelDelegate.qml
+    HotelEditor.qml
+    HotelPage.qml
+    IndoorMapAmenityDelegate.qml
+    IndoorMapAmenitySheet.qml
+    IndoorMapElevatorSheet.qml
+    IndoorMapGateSheet.qml
+    IndoorMapInfoSheet.qml
+    IndoorMapInfoSheetOpeningHoursDelegate.qml
+    IndoorMapPage.qml
+    IndoorMapPlatformSheet.qml
+    IntermediateStopSelector.qml
+    JourneyDelegateHeader.qml
+    JourneyPathPage.qml
+    JourneyRequestPage.qml
+    JourneyQueryPage.qml
+    JourneySectionDelegate.qml
+    JourneySectionPage.qml
+    JourneySectionStopDelegate.qml
+    JourneySectionStopDelegateLineSegment.qml
+    JourneySummaryDelegate.qml
+    LiveStatusPage.qml
+    LocationInfoDelegate.qml
+    LocationPicker.qml
+    MapView.qml
+    MatrixRoomSelectionSheet.qml
+    NavigationBar.qml
+    OnlineImportPage.qml
+    PassPage.qml
+    PkPassBarcode.qml
+    PkPassPage.qml
+    ProgramMembershipCard.qml
+    ProgramMembershipEditorCard.qml
+    ProgramMembershipEditor.qml
+    ProgramMembershipPage.qml
+    PublicTransportBackendPage.qml
+    ReservationDocumentsCard.qml
+    RestaurantDelegate.qml
+    RestaurantEditor.qml
+    RestaurantPage.qml
+    SettingsPage.qml
+    StatisticsDelegate.qml
+    StatisticsPage.qml
+    StopPickerPage.qml
+    TicketEditor.qml
+    TicketPage.qml
+    TicketTokenDelegate.qml
+    TimelineDelegate.qml
+    TimelinePage.qml
+    TimelineSectionDelegate.qml
+    TouristAttractionDelegate.qml
+    TouristAttractionPage.qml
+    TrainDelegate.qml
+    TrainEditor.qml
+    TrainPage.qml
+    TransferDelegate.qml
+    TransferPage.qml
+    TransportIcon.qml
+    TripGroupDelegate.qml
+    VehicleLoadIndicator.qml
+    VehicleLayoutPage.qml
+    VerticalNavigationButton.qml
+    WeatherForecastDelegate.qml
+    WeatherForecastPage.qml
+    WelcomePage.qml
+
+    components/RadioSelector.qml
+    onlineimport/db.qml
+    onlineimport/sncf.qml
+)
 target_include_directories(itinerary-app PRIVATE ${CMAKE_BINARY_DIR})
 target_link_libraries(itinerary-app PRIVATE
     itinerary
diff --git a/src/app/CalendarImportPage.qml b/src/app/CalendarImportPage.qml
index 62db84b54..04a8def32 100644
--- a/src/app/CalendarImportPage.qml
+++ b/src/app/CalendarImportPage.qml
@@ -10,7 +10,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.components
 import internal.org.kde.kcalendarcore as KCalendarCore
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/CarRentalDelegate.qml b/src/app/CarRentalDelegate.qml
index c8fde2fdd..a7d5ed1d0 100644
--- a/src/app/CarRentalDelegate.qml
+++ b/src/app/CarRentalDelegate.qml
@@ -9,9 +9,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
 
     headerIconSource: "qrc:///images/car.svg"
diff --git a/src/app/CarRentalPage.qml b/src/app/CarRentalPage.qml
index 9cb099390..55c89ff4a 100644
--- a/src/app/CarRentalPage.qml
+++ b/src/app/CarRentalPage.qml
@@ -9,16 +9,15 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
     title: i18n("Rental Car")
 
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🚗"
             text: i18n("Rental Car")
         }
@@ -43,7 +42,7 @@ App.DetailsPage {
                 description: reservation.pickupLocation.name
             }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservation.pickupLocation
                 controller: root.controller
                 isRangeBegin: true
@@ -70,7 +69,7 @@ App.DetailsPage {
                 description: reservation.dropoffLocation.name
             }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservation.dropoffLocation
                 controller: root.controller
                 isRangeEnd: true
@@ -113,15 +112,15 @@ App.DetailsPage {
             }
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/ContactCard.qml b/src/app/ContactCard.qml
index c684d0fa4..ffe171ec7 100644
--- a/src/app/ContactCard.qml
+++ b/src/app/ContactCard.qml
@@ -9,7 +9,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/ContactEditorCard.qml b/src/app/ContactEditorCard.qml
index 1dcd037fd..5b24f0a87 100644
--- a/src/app/ContactEditorCard.qml
+++ b/src/app/ContactEditorCard.qml
@@ -8,7 +8,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/DepartureQueryPage.qml b/src/app/DepartureQueryPage.qml
index f6c78dbf8..a3549438a 100644
--- a/src/app/DepartureQueryPage.qml
+++ b/src/app/DepartureQueryPage.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/DetailsPage.qml b/src/app/DetailsPage.qml
index 8b9decd6d..311611430 100644
--- a/src/app/DetailsPage.qml
+++ b/src/app/DetailsPage.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import internal.org.kde.kcalendarcore as KCalendarCore
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/DocumentsCard.qml b/src/app/DocumentsCard.qml
index 9dab5fb27..887f74a9a 100644
--- a/src/app/DocumentsCard.qml
+++ b/src/app/DocumentsCard.qml
@@ -13,7 +13,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kitinerary
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/EditorPage.qml b/src/app/EditorPage.qml
index 6e5fb3fd2..9de3da25f 100644
--- a/src/app/EditorPage.qml
+++ b/src/app/EditorPage.qml
@@ -12,7 +12,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.components
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/EventDelegate.qml b/src/app/EventDelegate.qml
index f4733374e..c1f8a5fcc 100644
--- a/src/app/EventDelegate.qml
+++ b/src/app/EventDelegate.qml
@@ -9,9 +9,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
 
     headerIconSource: "meeting-attending"
diff --git a/src/app/EventEditor.qml b/src/app/EventEditor.qml
index 68962c98e..f65bff57b 100644
--- a/src/app/EventEditor.qml
+++ b/src/app/EventEditor.qml
@@ -12,9 +12,8 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.i18n.localeData
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
 
     title: i18nc("event as in concert/conference/show, not as in appointment", "Edit Event")
@@ -58,7 +57,7 @@ App.EditorPage {
                 statusMessage: text === "" ? i18n("Name must not be empty.") : ""
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: entranceTimeEdit
                 text: i18nc("time of entrance", "Entrance")
                 obj: reservation.reservationFor
@@ -76,7 +75,7 @@ App.EditorPage {
                 }
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: startDateEdit
                 text: i18n("Start Time")
                 obj: reservation.reservationFor
@@ -85,7 +84,7 @@ App.EditorPage {
                 statusMessage: startDateEdit.hasValue ? '' : i18n("Start time has to be set.")
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: endDateEdit
                 text: i18n("End Time")
                 obj: reservation.reservationFor
@@ -122,7 +121,7 @@ App.EditorPage {
                 text: reservation.reservationFor.location ? reservation.reservationFor.location.name : ""
             }
             FormCard.FormDelegateSeparator {}
-            App.FormPlaceEditorDelegate {
+            FormPlaceEditorDelegate {
                 id: address
                 place: {
                     if (root.reservation.reservationFor.location)
@@ -134,7 +133,7 @@ App.EditorPage {
 
         // TODO seat
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: reservation
             defaultCurrency: Country.fromAlpha2(address.currentCountry).currencyCode
diff --git a/src/app/EventPage.qml b/src/app/EventPage.qml
index 85ef27109..1a1a6085e 100644
--- a/src/app/EventPage.qml
+++ b/src/app/EventPage.qml
@@ -9,9 +9,8 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
     title: i18nc("event as in concert/conference/show, not as in appointment", "Event")
 
@@ -23,7 +22,7 @@ App.DetailsPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🎤🎸🎶🏟"
             text: reservationFor.name
         }
@@ -31,7 +30,7 @@ App.DetailsPage {
         FormCard.FormCard {
             visible: ticketToken.ticketTokenCount > 0 || descriptionLabel.visible
             // ticket barcode
-            App.TicketTokenDelegate {
+            TicketTokenDelegate {
                 id: ticketToken
                 Layout.fillWidth: true
                 resIds: ReservationManager.reservationsForBatch(root.batchId)
@@ -55,7 +54,7 @@ App.DetailsPage {
         FormCard.FormCard {
             Layout.topMargin: Kirigami.Units.largeSpacing
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservationFor.location
                 controller: root.controller
                 showLocationName: true
@@ -139,15 +138,15 @@ App.DetailsPage {
             }
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/EventTicket.qml b/src/app/EventTicket.qml
index becaf2513..82fb38fb9 100644
--- a/src/app/EventTicket.qml
+++ b/src/app/EventTicket.qml
@@ -11,7 +11,6 @@ import QtQuick.Effects as Effects
 import org.kde.kirigami as Kirigami
 import org.kde.pkpass as KPkPass
 import org.kde.itinerary
-import "." as App
 
 Item {
     id: root
@@ -202,7 +201,7 @@ Item {
             }
 
             // barcode
-            App.PkPassBarcode {
+            PkPassBarcode {
                 pass: root.pass
                 TapHandler {
                     onDoubleTapped: scanModeToggled()
diff --git a/src/app/FavoriteLocationPage.qml b/src/app/FavoriteLocationPage.qml
index e295f4931..f20a574ba 100644
--- a/src/app/FavoriteLocationPage.qml
+++ b/src/app/FavoriteLocationPage.qml
@@ -14,7 +14,6 @@ import QtPositioning
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.components
 import org.kde.itinerary
-import "." as App
 
 Kirigami.Page {
     id: root
diff --git a/src/app/FlightDelegate.qml b/src/app/FlightDelegate.qml
index a4e1fd336..44539bc22 100644
--- a/src/app/FlightDelegate.qml
+++ b/src/app/FlightDelegate.qml
@@ -9,9 +9,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
 
     function airportDisplayString(airport)
diff --git a/src/app/FlightEditor.qml b/src/app/FlightEditor.qml
index 4d67811aa..765a8dc03 100644
--- a/src/app/FlightEditor.qml
+++ b/src/app/FlightEditor.qml
@@ -11,9 +11,8 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
     title: i18n("Edit Flight")
 
@@ -89,7 +88,7 @@ App.EditorPage {
                 label: i18nc("flight departure terminal", "Terminal")
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: departureTime
                 text: i18nc("flight departure time", "Time")
                 obj: reservation.reservationFor
@@ -105,7 +104,7 @@ App.EditorPage {
                 label: i18nc("flight departure gate", "Gate")
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: boardingTime
                 text: i18n("Boarding time")
                 obj: reservation.reservationFor
@@ -141,7 +140,7 @@ App.EditorPage {
                 label: i18nc("flight arrival terminal", "Terminal")
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: arrivalTime
                 text: i18nc("flight arrival time", "Time")
                 obj: reservation.reservationFor
@@ -173,7 +172,7 @@ App.EditorPage {
             }
         }
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: root.reservation
         }
diff --git a/src/app/FlightPage.qml b/src/app/FlightPage.qml
index 84755acd9..bddb46119 100644
--- a/src/app/FlightPage.qml
+++ b/src/app/FlightPage.qml
@@ -9,13 +9,12 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
     title: i18n("Flight")
     property var resIds: ReservationManager.reservationsForBatch(root.batchId)
-    editor: App.FlightEditor {}
+    editor: FlightEditor {}
 
     function airportDisplayString(airport) {
         if (airport.name && airport.iataCode) {
@@ -33,7 +32,7 @@ App.DetailsPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "✈️"
             text: reservationFor.airline.iataCode + " " + reservationFor.flightNumber
         }
@@ -42,7 +41,7 @@ App.DetailsPage {
             visible: ticketToken.ticketTokenCount > 0 || sequenceNumberDelegate.visible
 
             // ticket barcode
-            App.TicketTokenDelegate {
+            TicketTokenDelegate {
                 id: ticketToken
                 resIds: ReservationManager.reservationsForBatch(root.batchId)
                 onCurrentReservationIdChanged: {
@@ -153,7 +152,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: reservationFor.departureGate.length > 0 }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservationFor.departureAirport
                 controller: root.controller
                 isRangeBegin: true
@@ -191,26 +190,26 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: reservationFor.arrivalTerminal.length > 0 }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservationFor.arrivalAirport
                 controller: root.controller
                 isRangeEnd: true
             }
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ProgramMembershipCard {
+        ProgramMembershipCard {
             programMembership: root.reservation.programMembershipUsed
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/FormDateTimeEditDelegate.qml b/src/app/FormDateTimeEditDelegate.qml
index 6e21c4f62..53c62389b 100644
--- a/src/app/FormDateTimeEditDelegate.qml
+++ b/src/app/FormDateTimeEditDelegate.qml
@@ -10,7 +10,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormDateTimeDelegate {
     id: root
diff --git a/src/app/FormPlaceDelegate.qml b/src/app/FormPlaceDelegate.qml
index 0e78a12ec..e4016a85a 100644
--- a/src/app/FormPlaceDelegate.qml
+++ b/src/app/FormPlaceDelegate.qml
@@ -8,7 +8,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
 
 /** Display a location and corresponding navigation actions. */
 FormCard.AbstractFormDelegate {
@@ -32,7 +31,7 @@ FormCard.AbstractFormDelegate {
 
     Component {
         id: departuresPage
-        App.DepartureQueryPage {
+        DepartureQueryPage {
             stop: place
             dateTime: controller.effectiveEndTime
         }
diff --git a/src/app/FormPlaceEditorDelegate.qml b/src/app/FormPlaceEditorDelegate.qml
index ab52035bf..47055bc84 100644
--- a/src/app/FormPlaceEditorDelegate.qml
+++ b/src/app/FormPlaceEditorDelegate.qml
@@ -15,7 +15,6 @@ import org.kde.i18n.localeData
 import org.kde.contacts
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
@@ -125,7 +124,7 @@ ColumnLayout {
     }
     FormCard.FormDelegateSeparator { visible: addressRegion.visible }
 
-    App.CountryComboBoxDelegate {
+    CountryComboBoxDelegate {
         id: addressCountry
         text: i18n("Country")
         model: Country.allCountries.map(c => c.alpha2).sort((lhs, rhs) => {
diff --git a/src/app/FormPlatformDelegate.qml b/src/app/FormPlatformDelegate.qml
index fe6bc1a3f..4ae980759 100644
--- a/src/app/FormPlatformDelegate.qml
+++ b/src/app/FormPlatformDelegate.qml
@@ -8,7 +8,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
 
 FormCard.AbstractFormDelegate {
     id: root
diff --git a/src/app/FormPriceDelegate.qml b/src/app/FormPriceDelegate.qml
index 6a4c5bae0..4c0c8a271 100644
--- a/src/app/FormPriceDelegate.qml
+++ b/src/app/FormPriceDelegate.qml
@@ -9,7 +9,6 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.i18n.localeData
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormTextDelegate {
     id: root
diff --git a/src/app/FormPriceEditDelegate.qml b/src/app/FormPriceEditDelegate.qml
index 16ee0be3c..e0651a746 100644
--- a/src/app/FormPriceEditDelegate.qml
+++ b/src/app/FormPriceEditDelegate.qml
@@ -9,7 +9,6 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.i18n.localeData
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 FormCard.AbstractFormDelegate {
     id: root
diff --git a/src/app/GenericPass.qml b/src/app/GenericPass.qml
index 8c8456d5c..9432b5235 100644
--- a/src/app/GenericPass.qml
+++ b/src/app/GenericPass.qml
@@ -9,7 +9,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.pkpass as KPkPass
 import org.kde.itinerary
-import "." as App
 
 Rectangle {
     id: root
@@ -172,7 +171,7 @@ Rectangle {
         }
 
         // barcode
-        App.PkPassBarcode {
+        PkPassBarcode {
             pass: root.pass
             TapHandler {
                 onDoubleTapped: scanModeToggled()
diff --git a/src/app/GenericPkPassPage.qml b/src/app/GenericPkPassPage.qml
index d00d77994..718a2456f 100644
--- a/src/app/GenericPkPassPage.qml
+++ b/src/app/GenericPkPassPage.qml
@@ -8,7 +8,6 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
 PkPassPage {
     property string genericPassId
diff --git a/src/app/HealthCertificatePage.qml b/src/app/HealthCertificatePage.qml
index ecaef3b1f..c40b693e5 100644
--- a/src/app/HealthCertificatePage.qml
+++ b/src/app/HealthCertificatePage.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.khealthcertificate as KHC
 import org.kde.itinerary
-import "." as App
 
 Kirigami.Page {
     id: root
@@ -100,19 +99,19 @@ Kirigami.Page {
 
     Component {
         id: vaccinationDetails
-        App.HealthCertificateVaccination {
+        HealthCertificateVaccination {
             certificate: certSelector.currentValue
         }
     }
     Component {
         id: testDetails
-        App.HealthCertificateTest {
+        HealthCertificateTest {
             certificate: certSelector.currentValue
         }
     }
     Component {
         id: recoveryDetails
-        App.HealthCertificateRecovery {
+        HealthCertificateRecovery {
             certificate: certSelector.currentValue
         }
     }
@@ -164,7 +163,7 @@ Kirigami.Page {
         visible: hasValidCertificate
         anchors.fill: parent
 
-        App.HealthCertificateBarcode {
+        HealthCertificateBarcode {
             certificate: certSelector.currentValue
             TapHandler {
                 onDoubleTapped: scanModeController.toggle()
diff --git a/src/app/HealthCertificateRecovery.qml b/src/app/HealthCertificateRecovery.qml
index 19ca77b5c..57ce6899f 100644
--- a/src/app/HealthCertificateRecovery.qml
+++ b/src/app/HealthCertificateRecovery.qml
@@ -10,7 +10,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.prison as Prison
 import org.kde.khealthcertificate as KHC
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/HealthCertificateTest.qml b/src/app/HealthCertificateTest.qml
index ec24c3db9..ad1c0ac0b 100644
--- a/src/app/HealthCertificateTest.qml
+++ b/src/app/HealthCertificateTest.qml
@@ -11,7 +11,6 @@ import org.kde.i18n.localeData
 import org.kde.prison as Prison
 import org.kde.khealthcertificate as KHC
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/HealthCertificateVaccination.qml b/src/app/HealthCertificateVaccination.qml
index cbef2cb1c..1712c05bc 100644
--- a/src/app/HealthCertificateVaccination.qml
+++ b/src/app/HealthCertificateVaccination.qml
@@ -11,7 +11,6 @@ import org.kde.i18n.localeData
 import org.kde.prison as Prison
 import org.kde.khealthcertificate as KHC
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/HotelDelegate.qml b/src/app/HotelDelegate.qml
index 177f0c695..85b1ae3ae 100644
--- a/src/app/HotelDelegate.qml
+++ b/src/app/HotelDelegate.qml
@@ -9,9 +9,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
 
     headerIconSource: "go-home-symbolic"
diff --git a/src/app/HotelEditor.qml b/src/app/HotelEditor.qml
index 665a4f1ac..3578804e7 100644
--- a/src/app/HotelEditor.qml
+++ b/src/app/HotelEditor.qml
@@ -12,9 +12,8 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.i18n.localeData
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
 
     title: i18n("Edit Hotel Reservation")
@@ -42,7 +41,7 @@ App.EditorPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🏨"
             text: i18n("Hotel")
         }
@@ -62,7 +61,7 @@ App.EditorPage {
 
             FormCard.FormDelegateSeparator {}
 
-            App.FormPlaceEditorDelegate {
+            FormPlaceEditorDelegate {
                 id: address
                 place: {
                     if (root.batchId || !root.reservation.reservationFor.address.isEmpty || root.reservation.reservationFor.geo.isValid)
@@ -80,7 +79,7 @@ App.EditorPage {
         FormCard.FormCard {
             Layout.topMargin: Kirigami.Units.largeSpacing
 
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: checkinEdit
                 text: i18nc("hotel checkin", "Check-in")
                 obj: reservation
@@ -89,7 +88,7 @@ App.EditorPage {
                 statusMessage: checkinEdit.hasValue ? '' : i18n("Check-in time has to be set.")
             }
             FormCard.FormDelegateSeparator {}
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: checkoutEdit
                 text: i18nc("hotel checkout", "Check-out")
                 obj: reservation
@@ -111,12 +110,12 @@ App.EditorPage {
             }
         }
 
-        App.ContactEditorCard {
+        ContactEditorCard {
             id: contactEdit
             contact: reservation.reservationFor
         }
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: reservation
             defaultCurrency: Country.fromAlpha2(address.currentCountry).currencyCode
diff --git a/src/app/HotelPage.qml b/src/app/HotelPage.qml
index 83e5e4d15..464899d1b 100644
--- a/src/app/HotelPage.qml
+++ b/src/app/HotelPage.qml
@@ -9,15 +9,14 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
 
     title: i18n("Hotel Reservation")
 
     ColumnLayout {
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🏨"
             text: reservationFor.name
         }
@@ -27,13 +26,13 @@ App.DetailsPage {
         }
 
         FormCard.FormCard {
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservationFor
                 controller: root.controller
             }
         }
 
-        App.ContactCard {
+        ContactCard {
             contact: root.reservationFor
         }
 
@@ -52,19 +51,19 @@ App.DetailsPage {
             }
         }
 
-        App.ProgramMembershipCard {
+        ProgramMembershipCard {
             programMembership: root.reservation.programMembershipUsed
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/IntermediateStopSelector.qml b/src/app/IntermediateStopSelector.qml
index a0f53e60f..fdc4ddd2a 100644
--- a/src/app/IntermediateStopSelector.qml
+++ b/src/app/IntermediateStopSelector.qml
@@ -10,7 +10,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kitinerary
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 Kirigami.OverlaySheet {
     id: boardSheet
diff --git a/src/app/JourneyDelegateHeader.qml b/src/app/JourneyDelegateHeader.qml
index b2471f980..58172a25c 100644
--- a/src/app/JourneyDelegateHeader.qml
+++ b/src/app/JourneyDelegateHeader.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/JourneyPathPage.qml b/src/app/JourneyPathPage.qml
index cfe866bb2..c630973f8 100644
--- a/src/app/JourneyPathPage.qml
+++ b/src/app/JourneyPathPage.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     property alias path: pathModel.path
diff --git a/src/app/JourneyQueryPage.qml b/src/app/JourneyQueryPage.qml
index 1cb94b7e0..3a3850cb1 100644
--- a/src/app/JourneyQueryPage.qml
+++ b/src/app/JourneyQueryPage.qml
@@ -13,7 +13,6 @@ import org.kde.kitemmodels
 import org.kde.kpublictransport
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
@@ -58,14 +57,14 @@ Kirigami.ScrollablePage {
 
             Repeater {
                 id: journeyRepeater
-                delegate: App.JourneySectionDelegate {
+                delegate: JourneySectionDelegate {
                     Layout.fillWidth: true
                     modelLength: journeyRepeater.count - 1
                 }
                 model: journeyView.currentIndex === top.index ? top.journey.sections : 0
             }
 
-            App.JourneySummaryDelegate {
+            JourneySummaryDelegate {
                 id: summaryButton
 
                 journey: top.journey
diff --git a/src/app/JourneyRequestPage.qml b/src/app/JourneyRequestPage.qml
index ff81740f4..c88bf944f 100644
--- a/src/app/JourneyRequestPage.qml
+++ b/src/app/JourneyRequestPage.qml
@@ -11,7 +11,6 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kirigamiaddons.dateandtime as Addon
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 import "./components" as Components
 
 FormCard.FormCardPage {
diff --git a/src/app/JourneySectionDelegate.qml b/src/app/JourneySectionDelegate.qml
index 2168087b7..224f0bff2 100644
--- a/src/app/JourneySectionDelegate.qml
+++ b/src/app/JourneySectionDelegate.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 FormCard.AbstractFormDelegate {
     id: root
@@ -184,7 +183,7 @@ FormCard.AbstractFormDelegate {
                 color: PublicTransport.warnAboutSection(modelData) ? Kirigami.Theme.negativeTextColor : Kirigami.Theme.textColor
                 elide: Text.ElideMiddle
             }
-            App.VehicleLoadIndicator {
+            VehicleLoadIndicator {
                 loadInformation: modelData.loadInformation
             }
         }
diff --git a/src/app/JourneySectionStopDelegate.qml b/src/app/JourneySectionStopDelegate.qml
index 882f967d3..19bc645cd 100644
--- a/src/app/JourneySectionStopDelegate.qml
+++ b/src/app/JourneySectionStopDelegate.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 Item {
     id: root
@@ -108,7 +107,7 @@ Item {
             visible: departureTime.visible && stop.hasExpectedDepartureTime && stop.disruptionEffect !== Disruption.NoService
         }
 
-        App.VehicleLoadIndicator {
+        VehicleLoadIndicator {
             Layout.column: 3
             Layout.row: 1
             Layout.rowSpan: 1
diff --git a/src/app/JourneySectionStopDelegateLineSegment.qml b/src/app/JourneySectionStopDelegateLineSegment.qml
index 19608b88f..feb28c3af 100644
--- a/src/app/JourneySectionStopDelegateLineSegment.qml
+++ b/src/app/JourneySectionStopDelegateLineSegment.qml
@@ -9,7 +9,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 /** Line segment drawn on the left in the journey section view.
  *  Can be used in a fully drawn form, or partially drawn as a progress
diff --git a/src/app/JourneySummaryDelegate.qml b/src/app/JourneySummaryDelegate.qml
index 8e2883dc5..64d1a1cba 100644
--- a/src/app/JourneySummaryDelegate.qml
+++ b/src/app/JourneySummaryDelegate.qml
@@ -12,7 +12,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 FormCard.AbstractFormDelegate {
     id: root
@@ -44,7 +43,7 @@ FormCard.AbstractFormDelegate {
         RowLayout {
             Repeater {
                 model: root.journey.sections
-                delegate: App.TransportIcon {
+                delegate: TransportIcon {
                     source: PublicTransport.journeySectionIcon(modelData)
                     color: PublicTransport.warnAboutSection(modelData) ? Kirigami.Theme.negativeTextColor : Kirigami.Theme.textColor
                     isMask: modelData.mode != JourneySection.PublicTransport || (!modelData.route.line.hasLogo && !modelData.route.line.hasModeLogo)
@@ -58,7 +57,7 @@ FormCard.AbstractFormDelegate {
                 Accessible.ignored: !parent.visible
             }
 
-            App.VehicleLoadIndicator {
+            VehicleLoadIndicator {
                 loadInformation: sectionWithMaxLoad < 0 ? undefined : root.journey.sections[sectionWithMaxLoad].loadInformation
             }
         }
diff --git a/src/app/LocationInfoDelegate.qml b/src/app/LocationInfoDelegate.qml
index 77cd635ee..7c52c6583 100644
--- a/src/app/LocationInfoDelegate.qml
+++ b/src/app/LocationInfoDelegate.qml
@@ -12,7 +12,6 @@ import org.kde.i18n.localeData
 import org.kde.kitinerary as KItinerary
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCard {
     id: root
diff --git a/src/app/LocationPicker.qml b/src/app/LocationPicker.qml
index 3b12172c8..7b2ea6cb7 100644
--- a/src/app/LocationPicker.qml
+++ b/src/app/LocationPicker.qml
@@ -12,7 +12,6 @@ import QtPositioning
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.components
 import org.kde.itinerary
-import "." as App
 
 Kirigami.Page {
     id: root
diff --git a/src/app/MatrixRoomSelectionSheet.qml b/src/app/MatrixRoomSelectionSheet.qml
index 57d648c57..bcf467247 100644
--- a/src/app/MatrixRoomSelectionSheet.qml
+++ b/src/app/MatrixRoomSelectionSheet.qml
@@ -8,7 +8,6 @@ import org.kde.kitemmodels
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.components as AddonComponents
 import org.kde.itinerary
-import "." as App
 
 // TODO sort room list in activity order
 // TODO remember last selected room
diff --git a/src/app/NavigationBar.qml b/src/app/NavigationBar.qml
index f6b6e7ef9..3fe00b7e7 100644
--- a/src/app/NavigationBar.qml
+++ b/src/app/NavigationBar.qml
@@ -7,7 +7,6 @@
 import QtQuick
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
 Kirigami.NavigationTabBar {
     id: root
@@ -25,7 +24,7 @@ Kirigami.NavigationTabBar {
             text: i18n("Plan Trip")
             onTriggered: {
                 if (pageStack.currentItem.objectName !== "JourneyRequestPage") {
-                    pagepool.loadPage("TimelinePage.qml").addTrainTrip()
+                    pagepool.loadPage(Qt.resolvedUrl("TimelinePage.qml")).addTrainTrip()
                 }
             }
         },
@@ -39,7 +38,7 @@ Kirigami.NavigationTabBar {
             text: i18n("Current Ticket")
             icon.name: "view-barcode-qr"
             visible: TimelineModel.currentBatchId !== ""
-            onTriggered: pagepool.loadPage("TimelinePage.qml").showDetailsPageForReservation(TimelineModel.currentBatchId)
+            onTriggered: pagepool.loadPage(Qt.resolvedUrl("TimelinePage.qml")).showDetailsPageForReservation(TimelineModel.currentBatchId)
         }
     ]
 }
diff --git a/src/app/OnlineImportPage.qml b/src/app/OnlineImportPage.qml
index 28a3301a6..fc361527d 100644
--- a/src/app/OnlineImportPage.qml
+++ b/src/app/OnlineImportPage.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCardPage {
     id: root
diff --git a/src/app/PassPage.qml b/src/app/PassPage.qml
index 080568829..55a1ab971 100644
--- a/src/app/PassPage.qml
+++ b/src/app/PassPage.qml
@@ -10,7 +10,6 @@ import Qt.labs.qmlmodels as Models
 import org.kde.kitemmodels
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
@@ -18,11 +17,11 @@ Kirigami.ScrollablePage {
 
     Component {
         id: pkpassComponent
-        App.GenericPkPassPage {}
+        GenericPkPassPage {}
     }
     Component {
         id: ticketComponent
-        App.TicketPage {}
+        TicketPage {}
     }
 
     actions: [
diff --git a/src/app/PkPassPage.qml b/src/app/PkPassPage.qml
index 7cd3d33e4..a10dd6215 100644
--- a/src/app/PkPassPage.qml
+++ b/src/app/PkPassPage.qml
@@ -7,7 +7,6 @@
 import QtQuick
 import org.kde.kirigami as Kirigami
 import org.kde.pkpass as KPkPass
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
@@ -28,7 +27,7 @@ Kirigami.ScrollablePage {
 
     Component {
         id: boardingPass
-        App.BoardingPass {
+        BoardingPass {
             passId: root.passId
             pass: root.pass
         }
@@ -36,7 +35,7 @@ Kirigami.ScrollablePage {
 
     Component {
         id: eventTicket
-        App.EventTicket {
+        EventTicket {
             passId: root.passId
             pass: root.pass
         }
@@ -44,7 +43,7 @@ Kirigami.ScrollablePage {
 
     Component {
         id: genericPass
-        App.GenericPass {
+        GenericPass {
             passId: root.passId
             pass: root.pass
         }
diff --git a/src/app/ProgramMembershipEditor.qml b/src/app/ProgramMembershipEditor.qml
index b7dd480ba..f7552922c 100644
--- a/src/app/ProgramMembershipEditor.qml
+++ b/src/app/ProgramMembershipEditor.qml
@@ -11,7 +11,6 @@ import org.kde.kirigamiaddons.components
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCardPage {
     id: root
@@ -56,7 +55,7 @@ FormCard.FormCardPage {
         }
     }
 
-    App.CardPageTitle {
+    CardPageTitle {
         emojiIcon: "🎫"
         text: i18n("Program")
 
@@ -91,14 +90,14 @@ FormCard.FormCardPage {
         }
         FormCard.FormDelegateSeparator {}
         // TODO date-only edit delegates
-        App.FormDateTimeEditDelegate {
+        FormDateTimeEditDelegate {
             id: validFromEdit
             text: i18n("Valid from")
             obj: root.programMembership
             propertyName: "validFrom"
         }
         FormCard.FormDelegateSeparator {}
-        App.FormDateTimeEditDelegate {
+        FormDateTimeEditDelegate {
             id: validUntilEdit
             text: i18n("Valid until")
             obj: root.programMembership
diff --git a/src/app/ProgramMembershipEditorCard.qml b/src/app/ProgramMembershipEditorCard.qml
index 5050027b9..f0b5a2e25 100644
--- a/src/app/ProgramMembershipEditorCard.qml
+++ b/src/app/ProgramMembershipEditorCard.qml
@@ -9,7 +9,6 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitemmodels
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/ProgramMembershipPage.qml b/src/app/ProgramMembershipPage.qml
index 04b964504..6b1e1d053 100644
--- a/src/app/ProgramMembershipPage.qml
+++ b/src/app/ProgramMembershipPage.qml
@@ -10,7 +10,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCardPage {
     id: root
@@ -57,7 +56,7 @@ FormCard.FormCardPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🎫"
             text: programMembership.programName
             Layout.topMargin: Kirigami.Units.smallSpacing
@@ -65,7 +64,7 @@ FormCard.FormCardPage {
 
         FormCard.FormCard {
             visible: programMembership.token.length > 0
-            App.BarcodeContainer {
+            BarcodeContainer {
                 id: barcodeContainer
                 Layout.alignment: Qt.AlignCenter
                 Layout.fillWidth: true
@@ -123,7 +122,7 @@ FormCard.FormCardPage {
             }
         }
 
-        App.DocumentsCard {
+        DocumentsCard {
             documentIds: PassManager.documentIds(programMembership)
             onAddDocument: (file) => {
                 ApplicationController.addDocumentToPass(root.passId, file);
diff --git a/src/app/ReservationDocumentsCard.qml b/src/app/ReservationDocumentsCard.qml
index 0c6edd441..572e41b53 100644
--- a/src/app/ReservationDocumentsCard.qml
+++ b/src/app/ReservationDocumentsCard.qml
@@ -10,9 +10,8 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DocumentsCard {
+DocumentsCard {
     /// TimelineDelegateController
     property QtObject controller: null
 
diff --git a/src/app/RestaurantDelegate.qml b/src/app/RestaurantDelegate.qml
index a8fba1505..5f7a952bc 100644
--- a/src/app/RestaurantDelegate.qml
+++ b/src/app/RestaurantDelegate.qml
@@ -9,9 +9,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
 
     headerIconSource: "qrc:///images/foodestablishment.svg"
diff --git a/src/app/RestaurantEditor.qml b/src/app/RestaurantEditor.qml
index fa33de567..bf20faabe 100644
--- a/src/app/RestaurantEditor.qml
+++ b/src/app/RestaurantEditor.qml
@@ -11,9 +11,8 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
 
     title: i18nc("@title", "Edit Restaurant")
@@ -41,7 +40,7 @@ App.EditorPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🍽️"
             text: i18n("Restaurant")
 
@@ -59,7 +58,7 @@ App.EditorPage {
 
             FormCard.FormDelegateSeparator {}
 
-            App.FormPlaceEditorDelegate {
+            FormPlaceEditorDelegate {
                 id: address
                 place: {
                     if (root.batchId || !root.reservation.reservationFor.address.isEmpty || root.reservation.reservationFor.geo.isValid)
@@ -74,7 +73,7 @@ App.EditorPage {
         }
 
         FormCard.FormCard {
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: startTimeEdit
                 text: i18n("Start Time")
                 obj: reservation
@@ -85,7 +84,7 @@ App.EditorPage {
 
             FormCard.FormDelegateSeparator {}
 
-            App.FormDateTimeEditDelegate {
+            FormDateTimeEditDelegate {
                 id: endTimeEdit
                 text: i18n("End Time")
                 obj: reservation
@@ -104,12 +103,12 @@ App.EditorPage {
             }
         }
 
-        App.ContactEditorCard {
+        ContactEditorCard {
             id: contactEdit
             contact: reservation.reservationFor
         }
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: reservation
         }
diff --git a/src/app/RestaurantPage.qml b/src/app/RestaurantPage.qml
index 82aca78a1..584b73a05 100644
--- a/src/app/RestaurantPage.qml
+++ b/src/app/RestaurantPage.qml
@@ -9,9 +9,8 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
 
     title: i18n("Restaurant Reservation")
@@ -19,7 +18,7 @@ App.DetailsPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🍽️"
             text: reservationFor.name
 
@@ -31,7 +30,7 @@ App.DetailsPage {
         }
 
         FormCard.FormCard {
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 place: reservationFor
                 controller: root.controller
             }
@@ -61,19 +60,19 @@ App.DetailsPage {
             }
         }
 
-        App.ContactCard {
+        ContactCard {
             contact: root.reservationFor
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/SettingsPage.qml b/src/app/SettingsPage.qml
index 2ee8f4462..878e4eb05 100644
--- a/src/app/SettingsPage.qml
+++ b/src/app/SettingsPage.qml
@@ -11,7 +11,6 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.i18n.localeData
 import org.kde.kpublictransport.onboard
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCardPage {
     id: root
@@ -35,7 +34,7 @@ FormCard.FormCardPage {
         title: i18n("Home")
     }
     FormCard.FormCard {
-        App.CountryComboBoxDelegate {
+        CountryComboBoxDelegate {
             text: i18n("Home Country")
             model: Country.allCountries.map(c => c.alpha2).sort((lhs, rhs) => {
                 return Country.fromAlpha2(lhs).name.localeCompare(Country.fromAlpha2(rhs).name);
diff --git a/src/app/StatisticsDelegate.qml b/src/app/StatisticsDelegate.qml
index 1b9874975..00e313748 100644
--- a/src/app/StatisticsDelegate.qml
+++ b/src/app/StatisticsDelegate.qml
@@ -8,7 +8,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 FormCard.FormTextDelegate {
     id: root
diff --git a/src/app/StatisticsPage.qml b/src/app/StatisticsPage.qml
index 532a8534d..5473e9e55 100644
--- a/src/app/StatisticsPage.qml
+++ b/src/app/StatisticsPage.qml
@@ -9,7 +9,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.i18n.localeData
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 FormCard.FormCardPage {
     id: root
diff --git a/src/app/StopPickerPage.qml b/src/app/StopPickerPage.qml
index e2b956c15..df0e37a15 100644
--- a/src/app/StopPickerPage.qml
+++ b/src/app/StopPickerPage.qml
@@ -11,7 +11,6 @@ import org.kde.kitemmodels
 import org.kde.i18n.localeData
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
@@ -56,7 +55,7 @@ Kirigami.ScrollablePage {
     ]
     header: ColumnLayout {
         spacing: Kirigami.Units.smallSpacing
-        App.CountryComboBox {
+        CountryComboBox {
             id: countryCombo
             Layout.topMargin: Kirigami.Units.smallSpacing
             Layout.leftMargin: Kirigami.Units.smallSpacing
diff --git a/src/app/TicketEditor.qml b/src/app/TicketEditor.qml
index 5a91ae3a2..6f52e0910 100644
--- a/src/app/TicketEditor.qml
+++ b/src/app/TicketEditor.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/TicketPage.qml b/src/app/TicketPage.qml
index 96a8d8997..6bc1965d4 100644
--- a/src/app/TicketPage.qml
+++ b/src/app/TicketPage.qml
@@ -10,7 +10,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCardPage {
     id: root
@@ -59,13 +58,13 @@ FormCard.FormCardPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🎫"
             text: root.ticket.name
         }
 
         FormCard.FormCard {
-            App.BarcodeContainer {
+            BarcodeContainer {
                 id: barcodeContainer
                 Layout.alignment: Qt.AlignCenter
                 Layout.fillWidth: true
@@ -118,7 +117,7 @@ FormCard.FormCardPage {
             }
         }
 
-        App.DocumentsCard {
+        DocumentsCard {
             documentIds: PassManager.documentIds(ticket)
             onAddDocument: (file) => {
                 ApplicationController.addDocumentToPass(root.passId, file);
@@ -139,7 +138,7 @@ FormCard.FormCardPage {
 
                 Component {
                     id: editor
-                    App.TicketEditor {}
+                    TicketEditor {}
                 }
             }
 
diff --git a/src/app/TicketTokenDelegate.qml b/src/app/TicketTokenDelegate.qml
index f1a946a95..acb058b85 100644
--- a/src/app/TicketTokenDelegate.qml
+++ b/src/app/TicketTokenDelegate.qml
@@ -12,7 +12,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.prison as Prison
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 ColumnLayout {
     id: root
diff --git a/src/app/TimelineDelegate.qml b/src/app/TimelineDelegate.qml
index 28fb82755..6a60c1dcb 100644
--- a/src/app/TimelineDelegate.qml
+++ b/src/app/TimelineDelegate.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCard {
     id: root
@@ -72,7 +71,7 @@ FormCard.FormCard {
         contentItem: RowLayout {
             id: headerLayout
 
-            App.TransportIcon {
+            TransportIcon {
                 id: _headerIcon
                 color: root.headerTextColor
                 isMask: true
diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index 817a56218..cb4d1759d 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -12,7 +12,6 @@ import Qt.labs.qmlmodels as Models
 import QtQuick.Dialogs
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
@@ -233,60 +232,60 @@ Kirigami.ScrollablePage {
 
     Component {
         id: flightDetailsPage
-        App.FlightPage {}
+        FlightPage {}
     }
     Component {
         id: trainDetailsPage
-        App.TrainPage {}
+        TrainPage {}
     }
     Component {
         id: busDetailsPage
-        App.BusPage {}
+        BusPage {}
     }
     Component {
         id: hotelDetailsPage
-        App.HotelPage { editor: hotelEditorPage }
+        HotelPage { editor: hotelEditorPage }
     }
     Component {
         id: eventDetailsPage
-        App.EventPage { editor: eventEditorPage }
+        EventPage { editor: eventEditorPage }
     }
     Component {
         id: restaurantDetailsPage
-        App.RestaurantPage { editor: restaurantEditorPage }
+        RestaurantPage { editor: restaurantEditorPage }
     }
     Component {
         id: carRentalDetailsPage
-        App.CarRentalPage {}
+        CarRentalPage {}
     }
     Component {
         id: boatDetailsPage
-        App.BoatPage { editor: boatEditorPage }
+        BoatPage { editor: boatEditorPage }
     }
     Component {
         id: touristAttractionDetailsPage
-        App.TouristAttractionPage {}
+        TouristAttractionPage {}
     }
     Component {
         id: weatherForecastPage
-        App.WeatherForecastPage {}
+        WeatherForecastPage {}
     }
 
     Component {
         id: boatEditorPage
-        App.BoatEditor {}
+        BoatEditor {}
     }
     Component {
         id: hotelEditorPage
-        App.HotelEditor {}
+        HotelEditor {}
     }
     Component {
         id: eventEditorPage
-        App.EventEditor {}
+        EventEditor {}
     }
     Component {
         id: restaurantEditorPage
-        App.RestaurantEditor {}
+        RestaurantEditor {}
     }
 
     function detailsComponent(batchId) {
@@ -327,63 +326,63 @@ Kirigami.ScrollablePage {
         role: "type"
         Models.DelegateChoice {
             roleValue: TimelineElement.Flight
-            App.FlightDelegate {
+            FlightDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.Hotel
-            App.HotelDelegate {
+            HotelDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.TrainTrip
-            App.TrainDelegate {
+            TrainDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.BusTrip
-            App.BusDelegate {
+            BusDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.Restaurant
-            App.RestaurantDelegate {
+            RestaurantDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.TouristAttraction
-            App.TouristAttractionDelegate {
+            TouristAttractionDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.Event
-            App.EventDelegate {
+            EventDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.CarRental
-            App.CarRentalDelegate {
+            CarRentalDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.BoatTrip
-            App.BoatDelegate {
+            BoatDelegate {
                 batchId: model.batchId
                 rangeType: model.rangeType
             }
@@ -407,17 +406,17 @@ Kirigami.ScrollablePage {
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.LocationInfo
-            App.LocationInfoDelegate {
+            LocationInfoDelegate {
                 locationInfo: model.locationInformation
             }
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.WeatherForecast
-            App.WeatherForecastDelegate {}
+            WeatherForecastDelegate {}
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.TripGroup
-            App.TripGroupDelegate {
+            TripGroupDelegate {
                 onRemoveTrip: (tripGroupId) => {
                     deleteTripGroupWarningDialog.tripGroupId = tripGroupId;
                     deleteTripGroupWarningDialog.open();
@@ -426,7 +425,7 @@ Kirigami.ScrollablePage {
         }
         Models.DelegateChoice {
             roleValue: TimelineElement.Transfer
-            App.TransferDelegate {}
+            TransferDelegate {}
         }
     }
 
diff --git a/src/app/TimelineSectionDelegate.qml b/src/app/TimelineSectionDelegate.qml
index a5f19aee7..81b20fc12 100644
--- a/src/app/TimelineSectionDelegate.qml
+++ b/src/app/TimelineSectionDelegate.qml
@@ -8,7 +8,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigamiaddons.formcard as FormCard
 import QtQuick.Layouts
 import org.kde.itinerary
-import "." as App
 
 QQC2.Pane {
     property alias day: _controller.date
diff --git a/src/app/TouristAttractionDelegate.qml b/src/app/TouristAttractionDelegate.qml
index 51831b550..19e115b08 100644
--- a/src/app/TouristAttractionDelegate.qml
+++ b/src/app/TouristAttractionDelegate.qml
@@ -9,9 +9,8 @@ import QtQuick.Layouts
 import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
     readonly property var touristAttraction: ReservationManager.reservation(root.batchId).touristAttraction
 
diff --git a/src/app/TouristAttractionPage.qml b/src/app/TouristAttractionPage.qml
index 2a6d19bff..eace00bc2 100644
--- a/src/app/TouristAttractionPage.qml
+++ b/src/app/TouristAttractionPage.qml
@@ -9,9 +9,8 @@ import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
 
     readonly property var touristAttraction: ReservationManager.reservation(root.batchId).touristAttraction
@@ -26,7 +25,7 @@ App.DetailsPage {
         }
 
         FormCard.FormCard {
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: departureDelegate
                 place: touristAttraction
                 controller: root.controller
diff --git a/src/app/TrainDelegate.qml b/src/app/TrainDelegate.qml
index 9e153ada0..3019ae5f6 100644
--- a/src/app/TrainDelegate.qml
+++ b/src/app/TrainDelegate.qml
@@ -8,9 +8,8 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
-App.TimelineDelegate {
+TimelineDelegate {
     id: root
     property bool expanded: false
     property var journeySection: root.controller.journey
diff --git a/src/app/TrainEditor.qml b/src/app/TrainEditor.qml
index 853b1f0eb..bcd15bc7b 100644
--- a/src/app/TrainEditor.qml
+++ b/src/app/TrainEditor.qml
@@ -12,9 +12,8 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kitinerary
 import org.kde.kpublictransport
 import org.kde.itinerary
-import "." as App
 
-App.EditorPage {
+EditorPage {
     id: root
     title: i18n("Edit Train Reservation")
 
@@ -47,7 +46,7 @@ App.EditorPage {
         return newRes;
     }
 
-    App.IntermediateStopSelector {
+    IntermediateStopSelector {
         id: boardSheet
         title: i18n("Board Later")
         model: root.controller.journey.intermediateStops
@@ -60,7 +59,7 @@ App.EditorPage {
             }
         }
     }
-    App.IntermediateStopSelector {
+    IntermediateStopSelector {
         id: alightSheet
         title: i18n("Alight Earlier")
         model: root.controller.journey.intermediateStops
@@ -80,7 +79,7 @@ App.EditorPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🚅"
             text: if (reservationFor.trainNumber || reservationFor.trainName) {
                 return reservationFor.trainName + " " + reservationFor.trainNumber;
@@ -171,7 +170,7 @@ App.EditorPage {
             item: root.reservation
         }
 
-        App.BookingEditorCard {
+        BookingEditorCard {
             id: bookingEdit
             item: root.reservation
         }
diff --git a/src/app/TrainPage.qml b/src/app/TrainPage.qml
index d6623743b..85d5c2939 100644
--- a/src/app/TrainPage.qml
+++ b/src/app/TrainPage.qml
@@ -10,13 +10,12 @@ import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.kpublictransport as KPublicTransport
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
-App.DetailsPage {
+DetailsPage {
     id: root
 
     title: i18n("Train Ticket")
-    editor: App.TrainEditor {
+    editor: TrainEditor {
         controller: root.controller
     }
 
@@ -27,7 +26,7 @@ App.DetailsPage {
 
     Component {
         id: alternativePage
-        App.AlternativeJourneyPage {
+        AlternativeJourneyPage {
             controller: root.controller
             publicTransportManager: LiveDataManager.publicTransportManager
         }
@@ -35,7 +34,7 @@ App.DetailsPage {
 
     Component {
         id: vehicleLayoutPage
-        App.VehicleLayoutPage {
+        VehicleLayoutPage {
             publicTransportManager: root.controller.liveDataManager.publicTransportManager
             selectedVehicleSection: root.reservation.reservedTicket.ticketedSeat.seatSection
             selectedClasses: root.reservation.reservedTicket.ticketedSeat.seatingType
@@ -50,7 +49,7 @@ App.DetailsPage {
     ColumnLayout {
         spacing: 0
 
-        App.CardPageTitle {
+        CardPageTitle {
             emojiIcon: "🚅"
             text: {
                 if (reservationFor.trainName || reservationFor.trainNumber) {
@@ -63,7 +62,7 @@ App.DetailsPage {
         FormCard.FormCard {
             visible: ticketToken.ticketTokenCount > 0
             // ticket barcode
-            App.TicketTokenDelegate {
+            TicketTokenDelegate {
                 id: ticketToken
                 Layout.fillWidth: true
                 resIds: ReservationManager.reservationsForBatch(root.batchId)
@@ -128,7 +127,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: reservationFor.departureStation.name }
 
-            App.FormPlatformDelegate {
+            FormPlatformDelegate {
                 id: departurePlatformDelegate
                 stopover: departure
                 sections: root.controller.departurePlatformSections
@@ -137,7 +136,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: departurePlatformDelegate.visible }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: departureDelegate
                 place: reservationFor.departureStation
                 controller: root.controller
@@ -206,7 +205,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: reservationFor.arrivalStation.name }
 
-            App.FormPlatformDelegate {
+            FormPlatformDelegate {
                 id: arrivalPlatformDelegate
                 stopover: arrival
                 sections: root.controller.arrivalPlatformSections
@@ -215,7 +214,7 @@ App.DetailsPage {
 
             FormCard.FormDelegateSeparator { visible: arrivalPlatformDelegate.visible }
 
-            App.FormPlaceDelegate {
+            FormPlaceDelegate {
                 id: arrivalDelegate
                 place: reservationFor.arrivalStation
                 controller: root.controller
@@ -287,19 +286,19 @@ App.DetailsPage {
             }
         }
 
-        App.ProgramMembershipCard {
+        ProgramMembershipCard {
             programMembership: root.reservation.programMembershipUsed
         }
 
-        App.BookingCard {
+        BookingCard {
             reservation: root.reservation
         }
 
-        App.ReservationDocumentsCard {
+        ReservationDocumentsCard {
             controller: root.controller
         }
 
-        App.ActionsCard {
+        ActionsCard {
             batchId: root.batchId
             editor: root.editor
             reservation: root.reservation
diff --git a/src/app/TransferDelegate.qml b/src/app/TransferDelegate.qml
index 99374dc70..a3fae48ae 100644
--- a/src/app/TransferDelegate.qml
+++ b/src/app/TransferDelegate.qml
@@ -11,7 +11,6 @@ import org.kde.kirigami as Kirigami
 import org.kde.kpublictransport
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 FormCard.FormCard {
     id: root
@@ -90,7 +89,7 @@ FormCard.FormCard {
 
     Repeater {
         id: journeyRepeater
-        delegate: App.JourneySectionDelegate{
+        delegate: JourneySectionDelegate{
             Layout.fillWidth: true
             modelLength: journeyRepeater.count - 1
 
@@ -98,7 +97,7 @@ FormCard.FormCard {
         model: (transfer.state == Transfer.Selected && journeyDetailsExpanded) ? transfer.journey.sections : 0
     }
 
-    App.JourneySummaryDelegate {
+    JourneySummaryDelegate {
         journey: transfer.journey
         visible: transfer.state == Transfer.Selected && !journeyDetailsExpanded
         Layout.fillWidth: true
@@ -129,7 +128,7 @@ FormCard.FormCard {
     Item{
         Component {
             id: detailsComponent
-            App.TransferPage {
+            TransferPage {
                 transfer: root.transfer
             }
         }
diff --git a/src/app/TransferPage.qml b/src/app/TransferPage.qml
index fea63a283..37db51a5c 100644
--- a/src/app/TransferPage.qml
+++ b/src/app/TransferPage.qml
@@ -12,7 +12,6 @@ import org.kde.kitemmodels
 import org.kde.kpublictransport
 import org.kde.itinerary
 import org.kde.kirigamiaddons.formcard as FormCard
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
@@ -220,7 +219,7 @@ Kirigami.ScrollablePage {
 
             Repeater {
                 id: journeyRepeater
-                delegate: App.JourneySectionDelegate{
+                delegate: JourneySectionDelegate{
                     Layout.fillWidth: true
                     modelLength: journeyRepeater.count - 1
 
@@ -228,7 +227,7 @@ Kirigami.ScrollablePage {
                 model: journeyView.currentIndex === top.index ? top.journey.sections : 0
             }
 
-            App.JourneySummaryDelegate {
+            JourneySummaryDelegate {
                 id: summaryButton
 
                 journey: top.journey
diff --git a/src/app/TripGroupDelegate.qml b/src/app/TripGroupDelegate.qml
index 9b9320e47..cbb792159 100644
--- a/src/app/TripGroupDelegate.qml
+++ b/src/app/TripGroupDelegate.qml
@@ -11,7 +11,6 @@ import org.kde.i18n.localeData
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
 
 FormCard.FormCard {
     id: root
diff --git a/src/app/WeatherForecastDelegate.qml b/src/app/WeatherForecastDelegate.qml
index 61c087693..95d3b395c 100644
--- a/src/app/WeatherForecastDelegate.qml
+++ b/src/app/WeatherForecastDelegate.qml
@@ -10,8 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kirigamiaddons.formcard as FormCard
 import org.kde.itinerary
-import "." as App
-
 
 FormCard.FormCard {
     id: root
diff --git a/src/app/WeatherForecastPage.qml b/src/app/WeatherForecastPage.qml
index 0b7ae92dc..1c794f07c 100644
--- a/src/app/WeatherForecastPage.qml
+++ b/src/app/WeatherForecastPage.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import org.kde.kirigami as Kirigami
 import org.kde.kitinerary
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/WelcomePage.qml b/src/app/WelcomePage.qml
index 54c4f5cd2..9aaa8bb60 100644
--- a/src/app/WelcomePage.qml
+++ b/src/app/WelcomePage.qml
@@ -10,7 +10,6 @@ import QtQuick.Controls as QQC2
 import QtPositioning
 import org.kde.kirigami as Kirigami
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ScrollablePage {
     id: root
diff --git a/src/app/main.cpp b/src/app/main.cpp
index ae85963ce..8787c5e54 100644
--- a/src/app/main.cpp
+++ b/src/app/main.cpp
@@ -468,7 +468,7 @@ int main(int argc, char **argv)
     auto l10nContext = new KLocalizedContext(&engine);
     l10nContext->setTranslationDomain(QStringLiteral(TRANSLATION_DOMAIN));
     engine.rootContext()->setContextObject(l10nContext);
-    engine.load(QStringLiteral("qrc:/main.qml"));
+    engine.load(QStringLiteral("qrc:/qt/qml/org/kde/itinerary/main.qml"));
 
     // Exit on QML load error.
     if (engine.rootObjects().isEmpty()) {
diff --git a/src/app/main.qml b/src/app/main.qml
index bb0697efb..cef68a949 100644
--- a/src/app/main.qml
+++ b/src/app/main.qml
@@ -15,7 +15,6 @@ import org.kde.solidextras as Solid
 import org.kde.kpublictransport.onboard
 import internal.org.kde.kcalendarcore as KCalendarCore
 import org.kde.itinerary
-import "." as App
 
 Kirigami.ApplicationWindow {
     id: root
@@ -138,12 +137,12 @@ Kirigami.ApplicationWindow {
     }
     Component {
         id: calendarImportPage
-        App.CalendarImportPage {}
+        CalendarImportPage {}
     }
-    footer: App.NavigationBar {
+    footer: NavigationBar {
         id: navigationbar
     }
-    App.CalendarSelectionSheet {
+    CalendarSelectionSheet {
         id: calendarSelector
         // parent: root.Overlay.overlay
         onCalendarSelected: pageStack.push(calendarImportPage, { calendar: calendar });
@@ -191,7 +190,7 @@ Kirigami.ApplicationWindow {
                 text: i18n("Health Certificates")
                 icon.name: "cross-shape"
                 onTriggered: {
-                    healtCertificateComponent.source = "HealthCertificatePage.qml"
+                    healtCertificateComponent.source = Qt.resolvedUrl("HealthCertificatePage.qml")
                     pageStack.layers.push(healtCertificateComponent.item)
                 }
                 enabled: pageStack.layers.depth < 2
@@ -229,7 +228,7 @@ Kirigami.ApplicationWindow {
                 text: i18n("About")
                 icon.name: "help-about-symbolic"
                 enabled: pageStack.layers.depth < 2
-                onTriggered: pageStack.pushDialogLayer('qrc:/AboutPage.qml')
+                onTriggered: pageStack.pushDialogLayer(Qt.resolvedUrl("AboutPage.qml"))
             },
             Kirigami.Action {
                 id: devModeAction
@@ -305,34 +304,34 @@ Kirigami.ApplicationWindow {
 
     Component {
         id: mainPageComponent
-        App.TimelinePage {}
+        TimelinePage {}
     }
     Component {
         id: scanBarcodeComponent
-        App.BarcodeScannerPage {}
+        BarcodeScannerPage {}
     }
     Component {
         id: settingsComponent
-        App.SettingsPage {}
+        SettingsPage {}
     }
     Component {
         id: statisticsComponent
-        App.StatisticsPage {
+        StatisticsPage {
             reservationManager: ReservationManager
             tripGroupManager: TripGroupManager
         }
     }
     Component {
         id: programMembershipPage
-        App.ProgramMembershipPage {}
+        ProgramMembershipPage {}
     }
     Component {
         id: programMembershipEditor
-        App.ProgramMembershipEditor {}
+        ProgramMembershipEditor {}
     }
     Component {
         id: passComponent
-        App.PassPage {}
+        PassPage {}
     }
     // replace loader with component once we depend on KHealthCertificate unconditionally
     Loader {
@@ -340,32 +339,32 @@ Kirigami.ApplicationWindow {
     }
     Component {
         id: welcomeComponent
-        App.WelcomePage {}
+        WelcomePage {}
     }
     Component {
         id: journeySectionPage
-        App.JourneySectionPage {}
+        JourneySectionPage {}
     }
     Component {
         id: journeyPathPage
-        App.JourneyPathPage {}
+        JourneyPathPage {}
     }
     Component {
         id: indoorMapPage
-        App.IndoorMapPage {}
+        IndoorMapPage {}
     }
     Component {
         id: liveStatusPage
-        App.LiveStatusPage {}
+        LiveStatusPage {}
     }
     Component {
         id: onlineImportPage
-        App.OnlineImportPage {}
+        OnlineImportPage {}
     }
 
     Component {
         id: devModePageComponent
-        App.DevelopmentModePage {}
+        DevelopmentModePage {}
     }
 
     // "singleton" OSM QtLocation plugin
diff --git a/src/app/qml.qrc b/src/app/qml.qrc
index a9fbfe85c..50b343c82 100644
--- a/src/app/qml.qrc
+++ b/src/app/qml.qrc
@@ -4,126 +4,6 @@
 -->
 <RCC>
     <qresource prefix="/">
-        <file>main.qml</file>
-        <file>AboutPage.qml</file>
-        <file>ActionsCard.qml</file>
-        <file>AlternativeJourneyPage.qml</file>
-        <file>BarcodeContainer.qml</file>
-        <file>BarcodeScanModeController.qml</file>
-        <file>BarcodeScanModeButton.qml</file>
-        <file>BarcodeScannerPage.qml</file>
-        <file>BoardingPass.qml</file>
-        <file>BoatDelegate.qml</file>
-        <file>BoatEditor.qml</file>
-        <file>BoatPage.qml</file>
-        <file>BookingCard.qml</file>
-        <file>BookingEditorCard.qml</file>
-        <file>BusDelegate.qml</file>
-        <file>BusEditor.qml</file>
-        <file>BusPage.qml</file>
-        <file>CardPageTitle.qml</file>
-        <file>CalendarImportPage.qml</file>
-        <file>CalendarSelectionSheet.qml</file>
-        <file>CarRentalDelegate.qml</file>
-        <file>CarRentalPage.qml</file>
-        <file>ContactCard.qml</file>
-        <file>ContactEditorCard.qml</file>
-        <file>CountryComboBox.qml</file>
-        <file>CountryComboBoxDelegate.qml</file>
-        <file>DepartureQueryPage.qml</file>
-        <file>DetailsPage.qml</file>
-        <file>DevelopmentModePage.qml</file>
-        <file>DocumentsCard.qml</file>
-        <file>EditorPage.qml</file>
-        <file>EventDelegate.qml</file>
-        <file>EventEditor.qml</file>
-        <file>EventPage.qml</file>
-        <file>EventTicket.qml</file>
-        <file>FavoriteLocationPage.qml</file>
-        <file>FlightDelegate.qml</file>
-        <file>FlightEditor.qml</file>
-        <file>FlightPage.qml</file>
-        <file>FormDateTimeEditDelegate.qml</file>
-        <file>FormPlaceDelegate.qml</file>
-        <file>FormPlaceEditorDelegate.qml</file>
-        <file>FormPlatformDelegate.qml</file>
-        <file>FormPriceDelegate.qml</file>
-        <file>FormPriceEditDelegate.qml</file>
-        <file>GenericPass.qml</file>
-        <file>GenericPkPassPage.qml</file>
-        <file>HealthCertificateBarcode.qml</file>
-        <file>HealthCertificateRecovery.qml</file>
-        <file>HealthCertificatePage.qml</file>
-        <file>HealthCertificateTest.qml</file>
-        <file>HealthCertificateVaccination.qml</file>
-        <file>HotelDelegate.qml</file>
-        <file>HotelEditor.qml</file>
-        <file>HotelPage.qml</file>
-        <file>IndoorMapAmenityDelegate.qml</file>
-        <file>IndoorMapAmenitySheet.qml</file>
-        <file>IndoorMapElevatorSheet.qml</file>
-        <file>IndoorMapGateSheet.qml</file>
-        <file>IndoorMapInfoSheet.qml</file>
-        <file>IndoorMapInfoSheetOpeningHoursDelegate.qml</file>
-        <file>IndoorMapPage.qml</file>
-        <file>IndoorMapPlatformSheet.qml</file>
-        <file>IntermediateStopSelector.qml</file>
-        <file>JourneyDelegateHeader.qml</file>
-        <file>JourneyPathPage.qml</file>
-        <file>JourneyRequestPage.qml</file>
-        <file>JourneyQueryPage.qml</file>
-        <file>JourneySectionDelegate.qml</file>
-        <file>JourneySectionPage.qml</file>
-        <file>JourneySectionStopDelegate.qml</file>
-        <file>JourneySectionStopDelegateLineSegment.qml</file>
-        <file>JourneySummaryDelegate.qml</file>
-        <file>LiveStatusPage.qml</file>
-        <file>LocationInfoDelegate.qml</file>
-        <file>LocationPicker.qml</file>
-        <file>MapView.qml</file>
-        <file>MatrixRoomSelectionSheet.qml</file>
-        <file>OnlineImportPage.qml</file>
-        <file>PassPage.qml</file>
-        <file>PkPassBarcode.qml</file>
-        <file>PkPassPage.qml</file>
-        <file>ProgramMembershipCard.qml</file>
-        <file>ProgramMembershipEditorCard.qml</file>
-        <file>ProgramMembershipEditor.qml</file>
-        <file>ProgramMembershipPage.qml</file>
-        <file>PublicTransportBackendPage.qml</file>
-        <file>ReservationDocumentsCard.qml</file>
-        <file>RestaurantDelegate.qml</file>
-        <file>RestaurantEditor.qml</file>
-        <file>RestaurantPage.qml</file>
-        <file>SettingsPage.qml</file>
-        <file>StatisticsDelegate.qml</file>
-        <file>StatisticsPage.qml</file>
-        <file>StopPickerPage.qml</file>
-        <file>TicketEditor.qml</file>
-        <file>TicketPage.qml</file>
-        <file>TicketTokenDelegate.qml</file>
-        <file>TimelineDelegate.qml</file>
-        <file>TimelinePage.qml</file>
-        <file>TimelineSectionDelegate.qml</file>
-        <file>TouristAttractionDelegate.qml</file>
-        <file>TouristAttractionPage.qml</file>
-        <file>TrainDelegate.qml</file>
-        <file>TrainEditor.qml</file>
-        <file>TrainPage.qml</file>
-        <file>TransferDelegate.qml</file>
-        <file>TransferPage.qml</file>
-        <file>TransportIcon.qml</file>
-        <file>TripGroupDelegate.qml</file>
-        <file>VehicleLoadIndicator.qml</file>
-        <file>VehicleLayoutPage.qml</file>
-        <file>VerticalNavigationButton.qml</file>
-        <file>WeatherForecastDelegate.qml</file>
-        <file>WeatherForecastPage.qml</file>
-        <file>WelcomePage.qml</file>
-
-        <file>onlineimport/db.qml</file>
-        <file>onlineimport/sncf.qml</file>
-
         <file>images/bike.svg</file>
         <file>images/bus.svg</file>
         <file>images/cablecar.svg</file>
@@ -149,7 +29,5 @@
         <file>images/transfer.svg</file>
         <file>images/wait.svg</file>
         <file>images/walk.svg</file>
-        <file>NavigationBar.qml</file>
-        <file>components/RadioSelector.qml</file>
     </qresource>
 </RCC>
-- 
GitLab


From d300d1a3408cef84835ee905bad7a2b7cea3d0fd Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 22:39:27 +0100
Subject: [PATCH 35/36] Fix Add restaurant action icon not showing up in the
 menu

---
 src/app/TimelinePage.qml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/app/TimelinePage.qml b/src/app/TimelinePage.qml
index cb4d1759d..dc0c3740a 100644
--- a/src/app/TimelinePage.qml
+++ b/src/app/TimelinePage.qml
@@ -139,7 +139,7 @@ Kirigami.ScrollablePage {
         },
         Kirigami.Action {
             text: i18n("Add restaurant...")
-            icon.source: "qrc:///images/foodestablishment.svg"
+            icon.name: "qrc:///images/foodestablishment.svg"
             onTriggered: {
                 const dt = dateTimeAtIndex(currentIndex());
                 let res =  Factory.makeFoodEstablishmentReservation();
-- 
GitLab


From a96d80d263b53e5ccc9376cf92b4f069c2882925 Mon Sep 17 00:00:00 2001
From: Volker Krause <vkrause@kde.org>
Date: Tue, 19 Dec 2023 23:48:10 +0100
Subject: [PATCH 36/36] Fix statistics trend icon coloring on Android

---
 src/app/StatisticsDelegate.qml | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/app/StatisticsDelegate.qml b/src/app/StatisticsDelegate.qml
index 00e313748..3771a3a03 100644
--- a/src/app/StatisticsDelegate.qml
+++ b/src/app/StatisticsDelegate.qml
@@ -20,6 +20,7 @@ FormCard.FormTextDelegate {
     trailing: Kirigami.Icon {
         source: root.statItem.trend == StatisticsItem.TrendUp ? "go-up-symbolic" : root.statItem.trend == StatisticsItem.TrendDown ? "go-down-symbolic" : "go-next-symbolic"
         color: root.statItem.trend == StatisticsItem.TrendUp ? Kirigami.Theme.negativeTextColor : root.statItem.trend == StatisticsItem.TrendDown ? Kirigami.Theme.positiveTextColor : Kirigami.Theme.textColor
+        isMask: true
         Layout.preferredWidth: Kirigami.Units.gridUnit
         Layout.preferredHeight: Kirigami.Units.gridUnit
         visible: root.statItem.trend != StatisticsItem.TrendUnknown
-- 
GitLab

